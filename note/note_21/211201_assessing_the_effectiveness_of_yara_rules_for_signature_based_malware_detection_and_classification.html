<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小张笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-141019448-1"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
      
          gtag('config', 'UA-141019448-1');
      </script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2468672938537807" crossorigin="anonymous"></script>
    <meta name="description" content="Little Zhang's Note">
    <meta name="baidu-site-verification" content="code-HRrK6kdBX1">
    
    <link rel="preload" href="/assets/css/0.styles.9b71556a.css" as="style"><link rel="preload" href="/assets/js/app.c67dc84b.js" as="script"><link rel="preload" href="/assets/js/2.39a7464a.js" as="script"><link rel="preload" href="/assets/js/160.434ab6c8.js" as="script"><link rel="prefetch" href="/assets/js/10.bf63d664.js"><link rel="prefetch" href="/assets/js/100.3c47ceb4.js"><link rel="prefetch" href="/assets/js/101.8098f088.js"><link rel="prefetch" href="/assets/js/102.fd8be566.js"><link rel="prefetch" href="/assets/js/103.5dd4f5ae.js"><link rel="prefetch" href="/assets/js/104.a098550b.js"><link rel="prefetch" href="/assets/js/105.4d2da361.js"><link rel="prefetch" href="/assets/js/106.cae577f9.js"><link rel="prefetch" href="/assets/js/107.3f95e212.js"><link rel="prefetch" href="/assets/js/108.afc6efa7.js"><link rel="prefetch" href="/assets/js/109.30bffdcb.js"><link rel="prefetch" href="/assets/js/11.f141e032.js"><link rel="prefetch" href="/assets/js/110.a65a33ee.js"><link rel="prefetch" href="/assets/js/111.e2d59692.js"><link rel="prefetch" href="/assets/js/112.7466820f.js"><link rel="prefetch" href="/assets/js/113.7ece5e39.js"><link rel="prefetch" href="/assets/js/114.ada0aa1a.js"><link rel="prefetch" href="/assets/js/115.a4044d9a.js"><link rel="prefetch" href="/assets/js/116.6b5eb6c2.js"><link rel="prefetch" href="/assets/js/117.3b47502a.js"><link rel="prefetch" href="/assets/js/118.3f83232e.js"><link rel="prefetch" href="/assets/js/119.4675a68f.js"><link rel="prefetch" href="/assets/js/12.a8bf4981.js"><link rel="prefetch" href="/assets/js/120.93ee4b2f.js"><link rel="prefetch" href="/assets/js/121.6d3f6bc8.js"><link rel="prefetch" href="/assets/js/122.15728202.js"><link rel="prefetch" href="/assets/js/123.e45f6aa6.js"><link rel="prefetch" href="/assets/js/124.36568944.js"><link rel="prefetch" href="/assets/js/125.0ba4fef5.js"><link rel="prefetch" href="/assets/js/126.167213e1.js"><link rel="prefetch" href="/assets/js/127.ae1dc8d7.js"><link rel="prefetch" href="/assets/js/128.f76b6b12.js"><link rel="prefetch" href="/assets/js/129.b932c06b.js"><link rel="prefetch" href="/assets/js/13.fe996891.js"><link rel="prefetch" href="/assets/js/130.c019f492.js"><link rel="prefetch" href="/assets/js/131.891ad3cd.js"><link rel="prefetch" href="/assets/js/132.320ffcae.js"><link rel="prefetch" href="/assets/js/133.95554ce5.js"><link rel="prefetch" href="/assets/js/134.afed0273.js"><link rel="prefetch" href="/assets/js/135.053d1b3a.js"><link rel="prefetch" href="/assets/js/136.141ecb0f.js"><link rel="prefetch" href="/assets/js/137.34ca4e5b.js"><link rel="prefetch" href="/assets/js/138.f6d6c08e.js"><link rel="prefetch" href="/assets/js/139.cf86b3b2.js"><link rel="prefetch" href="/assets/js/14.b02eb3f5.js"><link rel="prefetch" href="/assets/js/140.e76bfbdf.js"><link rel="prefetch" href="/assets/js/141.fc923f93.js"><link rel="prefetch" href="/assets/js/142.e3f3ba36.js"><link rel="prefetch" href="/assets/js/143.bbc4d7cf.js"><link rel="prefetch" href="/assets/js/144.6fec3466.js"><link rel="prefetch" href="/assets/js/145.8b43423c.js"><link rel="prefetch" href="/assets/js/146.7b26dba6.js"><link rel="prefetch" href="/assets/js/147.415d406c.js"><link rel="prefetch" href="/assets/js/148.b9dfa7fe.js"><link rel="prefetch" href="/assets/js/149.b535518d.js"><link rel="prefetch" href="/assets/js/15.ea316444.js"><link rel="prefetch" href="/assets/js/150.67be9714.js"><link rel="prefetch" href="/assets/js/151.9857d670.js"><link rel="prefetch" href="/assets/js/152.b0a6e9ae.js"><link rel="prefetch" href="/assets/js/153.0632d85f.js"><link rel="prefetch" href="/assets/js/154.c409362b.js"><link rel="prefetch" href="/assets/js/155.abc6ce02.js"><link rel="prefetch" href="/assets/js/156.b75c415b.js"><link rel="prefetch" href="/assets/js/157.4b18488d.js"><link rel="prefetch" href="/assets/js/158.752a353d.js"><link rel="prefetch" href="/assets/js/159.19088625.js"><link rel="prefetch" href="/assets/js/16.f6fc3a79.js"><link rel="prefetch" href="/assets/js/161.8c1dc44e.js"><link rel="prefetch" href="/assets/js/162.dad67639.js"><link rel="prefetch" href="/assets/js/163.79e4850d.js"><link rel="prefetch" href="/assets/js/164.6876d9f1.js"><link rel="prefetch" href="/assets/js/165.b1192bf7.js"><link rel="prefetch" href="/assets/js/166.6ac16072.js"><link rel="prefetch" href="/assets/js/167.048f4185.js"><link rel="prefetch" href="/assets/js/168.1235373b.js"><link rel="prefetch" href="/assets/js/169.ce944805.js"><link rel="prefetch" href="/assets/js/17.0c814d3e.js"><link rel="prefetch" href="/assets/js/170.dba8e11c.js"><link rel="prefetch" href="/assets/js/171.260b9459.js"><link rel="prefetch" href="/assets/js/172.9a583e03.js"><link rel="prefetch" href="/assets/js/173.f762d29c.js"><link rel="prefetch" href="/assets/js/18.fe15def2.js"><link rel="prefetch" href="/assets/js/19.26a2e975.js"><link rel="prefetch" href="/assets/js/20.1613e41f.js"><link rel="prefetch" href="/assets/js/21.0065ca7f.js"><link rel="prefetch" href="/assets/js/22.dde8e810.js"><link rel="prefetch" href="/assets/js/23.f639be99.js"><link rel="prefetch" href="/assets/js/24.7ec0584f.js"><link rel="prefetch" href="/assets/js/25.ca5c3b3e.js"><link rel="prefetch" href="/assets/js/26.d5a8efd0.js"><link rel="prefetch" href="/assets/js/27.be3c7096.js"><link rel="prefetch" href="/assets/js/28.664aa88d.js"><link rel="prefetch" href="/assets/js/29.bdf5dec6.js"><link rel="prefetch" href="/assets/js/3.582414ce.js"><link rel="prefetch" href="/assets/js/30.62599c8a.js"><link rel="prefetch" href="/assets/js/31.8f28455c.js"><link rel="prefetch" href="/assets/js/32.3cb17159.js"><link rel="prefetch" href="/assets/js/33.71efbd35.js"><link rel="prefetch" href="/assets/js/34.c8d3757e.js"><link rel="prefetch" href="/assets/js/35.6d5c738c.js"><link rel="prefetch" href="/assets/js/36.a837b71b.js"><link rel="prefetch" href="/assets/js/37.ae77fc5f.js"><link rel="prefetch" href="/assets/js/38.28755b35.js"><link rel="prefetch" href="/assets/js/39.55edb3a7.js"><link rel="prefetch" href="/assets/js/4.ef205920.js"><link rel="prefetch" href="/assets/js/40.cd5530ab.js"><link rel="prefetch" href="/assets/js/41.a24e4cfe.js"><link rel="prefetch" href="/assets/js/42.26dae2e8.js"><link rel="prefetch" href="/assets/js/43.05206337.js"><link rel="prefetch" href="/assets/js/44.48fa3a68.js"><link rel="prefetch" href="/assets/js/45.90c7216d.js"><link rel="prefetch" href="/assets/js/46.1571750c.js"><link rel="prefetch" href="/assets/js/47.fb7798e4.js"><link rel="prefetch" href="/assets/js/48.353f5fbf.js"><link rel="prefetch" href="/assets/js/49.36261cc9.js"><link rel="prefetch" href="/assets/js/5.6c7f4d05.js"><link rel="prefetch" href="/assets/js/50.a6cf6d59.js"><link rel="prefetch" href="/assets/js/51.43bc5a7a.js"><link rel="prefetch" href="/assets/js/52.56fa0d73.js"><link rel="prefetch" href="/assets/js/53.704a046e.js"><link rel="prefetch" href="/assets/js/54.67ae9165.js"><link rel="prefetch" href="/assets/js/55.97f3eeff.js"><link rel="prefetch" href="/assets/js/56.f98acd6b.js"><link rel="prefetch" href="/assets/js/57.a80c4ce6.js"><link rel="prefetch" href="/assets/js/58.51bc0f95.js"><link rel="prefetch" href="/assets/js/59.a49644e1.js"><link rel="prefetch" href="/assets/js/6.bb33fed3.js"><link rel="prefetch" href="/assets/js/60.94c5cde6.js"><link rel="prefetch" href="/assets/js/61.8c7cc9ce.js"><link rel="prefetch" href="/assets/js/62.f8f97b1d.js"><link rel="prefetch" href="/assets/js/63.40df2cf8.js"><link rel="prefetch" href="/assets/js/64.8979fd95.js"><link rel="prefetch" href="/assets/js/65.43aa12c5.js"><link rel="prefetch" href="/assets/js/66.4cce055e.js"><link rel="prefetch" href="/assets/js/67.6ccaeff8.js"><link rel="prefetch" href="/assets/js/68.717109cc.js"><link rel="prefetch" href="/assets/js/69.7d13f83f.js"><link rel="prefetch" href="/assets/js/7.03daa1b7.js"><link rel="prefetch" href="/assets/js/70.45c3e66a.js"><link rel="prefetch" href="/assets/js/71.237beb61.js"><link rel="prefetch" href="/assets/js/72.66176b3f.js"><link rel="prefetch" href="/assets/js/73.b37da1a6.js"><link rel="prefetch" href="/assets/js/74.470b1f15.js"><link rel="prefetch" href="/assets/js/75.4bef7b4d.js"><link rel="prefetch" href="/assets/js/76.eb1e2c4b.js"><link rel="prefetch" href="/assets/js/77.cc2401ce.js"><link rel="prefetch" href="/assets/js/78.2b265394.js"><link rel="prefetch" href="/assets/js/79.cd3ba5b0.js"><link rel="prefetch" href="/assets/js/8.01e8181d.js"><link rel="prefetch" href="/assets/js/80.1a710702.js"><link rel="prefetch" href="/assets/js/81.84dcea42.js"><link rel="prefetch" href="/assets/js/82.fbc130b3.js"><link rel="prefetch" href="/assets/js/83.911bd621.js"><link rel="prefetch" href="/assets/js/84.c6b787fc.js"><link rel="prefetch" href="/assets/js/85.d5f3f002.js"><link rel="prefetch" href="/assets/js/86.63804700.js"><link rel="prefetch" href="/assets/js/87.6ec00fd9.js"><link rel="prefetch" href="/assets/js/88.aba03ab4.js"><link rel="prefetch" href="/assets/js/89.f64db66a.js"><link rel="prefetch" href="/assets/js/9.6a581cd3.js"><link rel="prefetch" href="/assets/js/90.05985ef4.js"><link rel="prefetch" href="/assets/js/91.5486ba4c.js"><link rel="prefetch" href="/assets/js/92.0817da0e.js"><link rel="prefetch" href="/assets/js/93.b3bf1947.js"><link rel="prefetch" href="/assets/js/94.40b89e32.js"><link rel="prefetch" href="/assets/js/95.44f0f34d.js"><link rel="prefetch" href="/assets/js/96.1e2f5ddd.js"><link rel="prefetch" href="/assets/js/97.604dbc59.js"><link rel="prefetch" href="/assets/js/98.da5bc1b2.js"><link rel="prefetch" href="/assets/js/99.240a023f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9b71556a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小张笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/note/note_21/211201_assessing_the_effectiveness_of_yara_rules_for_signature_based_malware_detection_and_classification.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/note/note_21/211201_assessing_the_effectiveness_of_yara_rules_for_signature_based_malware_detection_and_classification.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav>  <!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Assessing the Effectiveness of YARA Rules for Signature-Based Malware Detection and Classification</p> <p>assessing_the_effectiveness_of_yara_rules_for_signature_based_malware_detection_and_classification</p> <p>评估YARA规则对基于签名的恶意软件检测和分类的有效性</p> <h1 id="摘要"><a href="#摘要" class="header-anchor">#</a> 摘要</h1> <p><strong>恶意软件</strong>经常<strong>使用混淆技术</strong>或稍作修改，以<strong>躲避反病毒软件</strong>和恶意软件分析工具的签名检测。传统上，为了确定一个文件是否是恶意的，并确定样本是什么类型的恶意软件，需要计算文件的加密哈希值。YARA是一个较新的、灵活的恶意软件检测解决方案，它可以根据文件的二进制模式创建规则来识别和分类恶意软件。在本文中，作者将批判性地评估YARA规则对基于签名的恶意软件检测和分类的有效性，并与其他方法（包括加密和模糊散列）进行比较。</p> <h1 id="_1-简介"><a href="#_1-简介" class="header-anchor">#</a> 1 简介</h1> <p>基于签名的检测被杀毒软件和恶意软件分析软件使用，通过比较已知恶意软件的文件签名库和存储在计算机上的文件签名来检测恶意软件[1]。在撰写本报告时，大多数现代恶意软件使用混淆和规避技术来逃避检测[2]。这降低了使用加密散列的传统基于签名的检测方法的有效性，因为恶意软件已经被修改，使其文件签名与已知的恶意软件签名不匹配。此外，新开发的恶意软件将不会被检测到，因为它的签名不会被列入恶意软件签名数据库，直到它被网络安全专家识别。因此，需要为基于签名的检测提供替代和更灵活的方法，以便能够检测到经过修改或混淆的恶意软件。</p> <p>基于签名的检测的替代方法包括<strong>模糊散列</strong>和<strong>YARA规则</strong>。在下一节中，作者将定义和解决这些较新的检测和分类恶意软件的方法的优势和局限性，以及传统的加密散列。在第三节中，将通过比较不同方法的恶意软件检测和分类结果来评估不同方法的有效性。第四节将提供改进YARA规则的建议。最后，第五节将提供关于YARA规则对基于签名的恶意软件检测的有效性的结论，此外还有未来的工作。</p> <h1 id="_2-基于签名的恶意软件的分类和检测"><a href="#_2-基于签名的恶意软件的分类和检测" class="header-anchor">#</a> 2 基于签名的恶意软件的分类和检测</h1> <p><em>A. Cryptographic Hashing</em></p> <p>基于签名的检测被杀毒软件和加密散列是一种传统的方法，通过为文件生成一个独特的十六进制字符字符串（或散列）来检测和分类恶意软件[3]。这使得已知的恶意软件能够在计算机上被检测和分类，因为生成的文件哈希值与恶意软件签名数据库进行比较，其中包括签名所涉及的恶意软件类型的信息。</p> <p>尽管加密散列法可以验证一个文件是否与已知的恶意软件相同，但它<strong>只能检测到完全匹配的文件</strong>。如果文件中的一个比特被修改，文件的哈希值将是不同的。因此，这意味着文件之间的相似性将不会被检测到[4]。因此，加密散列法容易受到已被修改或混淆的恶意软件以及新型恶意软件的影响。此外，这意味着恶意软件的签名库需要不断更新'。</p> <p><em>B. Fuzzy Hashing</em></p> <p>模糊散列涉及将<strong>一个文件分为多个块，每个块都计算出一个散列值，然后将其串联起来形成最终的散列值</strong>。当文件的模糊哈希值被比较时，会<strong>计算出相似度百分比</strong>[5]。对一个文件的多个块进行散列，可以检测不同文件之间的相似性，因为两个不同文件中相同的块会有相同的块散列值。</p> <p>模糊散列技术也利用距离算法来衡量不同文件块的相似程度。一种模糊散列技术，SSDEEP，使用Damerau-Levenshteindistance函数来确定不同文件块匹配所需的字符或比特的插入、替换、删除和转置的数量[6][7]。</p> <p>使用模糊散列技术进行基于签名的恶意软件检测为检测恶意软件提供了更大的灵活性，因为经过混淆或修改的恶意软件菌株很可能与恶意软件的原始菌株相似。这导致高相似度百分比，这表明一个文件是恶意的。相反，模糊散列的一个问题是，它需要一个恶意软件模糊散列库来确定一个文件是否与恶意软件有相似之处。</p> <p>与加密散列相比，模糊散列确定了一个文件与其他恶意软件的相似程度。因此，它不太容易受到恶意软件混淆技术的影响，而加密散列法只能检测到精确匹配。</p> <p><em>C. YARA rules</em></p> <p>YARA能够创建规则，根据二进制和文本数据的模式对恶意软件进行识别和分类[8]，其中规则可以利用通配符和正则表达式来检测这些模式[9]。此外，YARA规则提供了更深入的恶意软件信息，因为恶意软件描述和元数据可以被添加到规则中。此外，YARA提供可编程性，因为任何人都可以创建或调整规则。即便如此，创建有效的YARA规则需要恶意软件分析方面的专业知识，因为薄弱的YARA规则会导致恶意软件逃避检测[10]。</p> <p>YARA规则在检测混淆的恶意软件方面也很有效，因为许多规则是为了检测不同的混淆能力，如包装[11]。此外，除了识别文件结构的规则外，还创建了检测反调试功能的规则。</p> <p>总的来说，YARA规则提供了更多的可定制性，与模糊散列相比，可以提供更多的恶意软件类别信息。然而，模糊散列法更灵活，因为它提供了一个文件与恶意软件相似程度的百分比得分。与加密散列法相比，YARA规则和模糊散列法都提供了更多的灵活性，更有可能检测到新的恶意软件菌株，或使用混淆技术的恶意软件。</p> <h1 id="_3-各种方式的评估"><a href="#_3-各种方式的评估" class="header-anchor">#</a> 3 各种方式的评估</h1> <p><strong>A.Methodology</strong></p> <p>为了评估YARA规则在检测和分类恶意软件方面的有效性，我们进行了一个对照实验。这涉及到将YARA规则应用于恶意软件样本，以确定一个规则是否与样本相匹配，以及如果匹配的规则给出了正确的恶意软件分类。对相同的恶意软件样本生成模糊和加密哈希值，并得出恶意软件检测和分类结果。</p> <p>加密和模糊散列都有许多不同的散列算法。在实验中，SHA-256是选择用于加密散列的算法，因为它是识别恶意软件的常见散列算法。SSDEEP是一种快速、行业标准的算法，被选择用于模糊散列[12]。</p> <p>15个恶意软件样本从GitHub上的恶意软件库[13]下载到一个虚拟机上，YARA规则库[11]也是如此。从GitHub下载的恶意软件样本是众所周知的，并且都使用了某种形式的混淆。我们从VirusTotal恶意软件库下载了另外15个恶意软件样本，用于企业客户和学生。这些样本相对较新，是在2021年11月上传到存储库的。<strong>使用两组不同的样本，一组是较早的样本，另一组是最近的样本，目的是评估不同方法对不知名的新恶意软件进行检测和分类的有效性。</strong></p> <p>实验中使用了来自MalwareBazaar的超过410,000个SSDEEP恶意软件签名，与恶意软件样本进行比较。在实验中，任何相似度为50%或以上的匹配都被标记为 &quot;检测为恶意&quot;。</p> <p>VirusTotal被用来确定从GitHub恶意软件样本生成的加密哈希是否是恶意的，以及它们是否被正确分类，而MalwareBazaar则被用于VirusTotal的样本。之所以使用MalwareBazaar，是因为这些恶意软件样本已经被VirusTotal打上了指纹。</p> <p><strong>B.Result</strong></p> <p>从表一中显示的实验定量结果可以看出，加密散列法可以正确检测和分类GitHub存储库中的所有恶意软件样本。然而，这是因为SHA-256哈希值已经为这些恶意软件样本生成，因为它们是已知的，并且已经被威胁猎手分析过。</p> <p><img src="211201_.assets/image-20211202102109752.png" alt="image-20211202102109752"></p> <p>相反，在MalwareBazaar中没有发现为VirusTotal恶意软件样本生成的加密哈希值。这是因为VirusTotal最近才对这些恶意软件样本进行了分析和上传（2021年11月），并正确识别和分类了这些恶意软件。这表明，加密散列法能有效地检测已知的恶意软件，但不能检测新的或未知的恶意软件。</p> <p>其他研究也评估了加密散列的有效性。Sarantinos等人的研究结果是对已知恶意软件样本生成的加密散列的检测率为99.88%[4]。这进一步表明，加密散列对检测已知的恶意软件非常有效，但它不会检测到不知道的恶意软件。因此，加密散列法的恶意软件检测结果不应该与其他方法进行比较，除非使用未知的恶意软件样本[4]。然而，使用加密散列法的已知恶意软件的分析结果仍然包括在内，以确定恶意软件是否被正确分类。</p> <p>虽然使用SSDEEP的模糊散列方法检测到的恶意软件样本和分类比加密散列少，但它确实为许多恶意软件样本提供了与其他已知恶意软件的多种相似性匹配。除此之外，另一个恶意软件样本有10个匹配项，相似度为33%。这验证了恶意软件使用混淆和修改技术来躲避检测，因此模糊散列方法对于检测混淆的或恶意软件家族的新菌株是有用的，而加密散列不能检测文件之间的相似性，除非它们是相同的。</p> <p>与模糊散列结果相比，YARA规则的结果相当相似，尽管结果表明模糊散列在分类恶意软件方面更有效，而YARA规则在检测恶意软件和恶意能力方面更有效。然而，YARA规则在分类恶意软件方面仍然有效，因为规则匹配可以提供关于恶意软件能力和结构的丰富信息，这可以从图1中恶意软件样本的YARA规则匹配中看出。</p> <p><img src="211201_.assets/image-20211202102127989.png" alt="image-20211202102127989"></p> <p>图1显示了Keilhosmalware的YARA规则匹配。许多规则，如 &quot;键盘记录器&quot;，&quot;maldoc_find_kernel32_base_method_1 &quot;和 &quot;IsPacked &quot;表明恶意活动，同时也提供了一些关于它如何工作的分类和背景。在这种情况下，我们可能会认为，恶意软件样本是一个恶意文件格式的键盘记录器，它使用包装技术来混淆自己。</p> <p>虽然一些规则，如 &quot;SEH_Save &quot;可能只给恶意软件分析师提供背景，但一旦YARA规则在互联网上被搜索到，通常会有更多关于规则目的的信息。例如，&quot;SEH_Save &quot;表明该恶意软件样本具有反调试功能[14]。这意味着YARA规则能够有效地提供分类信息以及恶意软件的潜在战术、技术和程序（TTP）。</p> <p>下表显示了至少与一个YARA规则相匹配或具有1%或更高的SSDEEP相似性分数的恶意软件样本的数量。这些结果被包括在内，以显示模糊散列和YARA规则可以为恶意软件样本提供的背景，即使它没有被分类或检测为恶意。</p> <p><img src="211201_.assets/image-20211202102142102.png" alt="image-20211202102142102"></p> <p>从表二中的结果来看，SSDEEP哈希值和YARA规则都有恶意软件或规则匹配，但没有提供足够的证据来检测恶意软件样本。YARA规则的匹配率最高，达到73%，**这表明YARA规则在为混淆的和新的恶意软件提供某种程度的分类方面是有效的。**相反，SSDEEP散列法只有33%的匹配率。</p> <h1 id="_4-对于改进yara规则的建议"><a href="#_4-对于改进yara规则的建议" class="header-anchor">#</a> 4 对于改进YARA规则的建议</h1> <p>评估结果表明，YARA规则在检测恶意软件方面是有效的，但它们没有像SSDEEP模糊散列方法那样正确分类恶意软件样本。因此，为了提高YARA规则在检测和分类恶意软件方面的灵活性，可以进行的改进是在YARA规则中使用模糊散列的功能。这一改进已经由Naik等人提出，将使YARA规则能够根据恶意软件的结构相似性来检测恶意能力，而标准的YARA规则无法做到这一点[15]。</p> <p>另一个可以对YARA规则进行改进的是更多的文档，特别是对检测和分类恶意软件的流行规则的描述。这是因为描述并不总是写在用于评估的规则上，这有助于对恶意软件样本进行分类并提供背景信息'。</p> <h1 id="_5-结论"><a href="#_5-结论" class="header-anchor">#</a> 5 结论</h1> <p><strong>A.Overall Conlusion</strong></p> <p>综上所述，从实验结果和二次研究中可以看出，与加密和模糊散列相比，YARA规则对基于签名的混淆和新恶意软件的检测和分类是有效的。虽然加密散列在检测和分类已知恶意软件方面很有效，但YARA规则可以识别未被指纹化的混淆恶意软件和新的恶意软件菌株的恶意能力，而加密散列只能检测已知恶意软件。</p> <p>虽然模糊散列技术可以找到文件中的相似性来检测被混淆的恶意软件，但它需要一个恶意软件模糊散列的存储库。因此，它可能无法识别全新类型的恶意软件。相比之下，YARA规则可以在没有恶意软件签名数据库的情况下检测恶意能力。</p> <p>从表一的结果来看，YARA规则检测到的恶意软件样本最多。这意味着YARA规则是检测恶意软件的最有效的基于签名的技术，但它仍然只检测到57%的恶意软件样本。这强调了除了基于签名的检测之外，还需要基于行为的恶意软件检测。然而，考虑到恶意软件样本是混淆的或新的毒株，YARA规则仍然是一个有效的方法。</p> <p>总的来说，密码学和模糊散列在检测和分类恶意软件方面都很有效。然而，YARA规则对于基于签名的恶意软件检测是最有效的，因为它们可以检测到被混淆的和未知的恶意软件，同时为其提供足够的背景，以给出某种程度的分类。</p> <p><strong>B.Future Work</strong></p> <p>'在本文中，我们评估了YARA规则对基于签名的恶意软件检测的有效性，与加密和模糊散列相比较。虽然这些方法是众所周知的，但还有其他替代方法用于基于签名的检测。其中一种方法是导入散列，根据文件导入的库函数及其顺序计算散列值，可用于检测和分类恶意软件[16]。在未来，本文所涉及的评估可以扩展到包括和评估基于签名的恶意软件检测和分类的导入散列法'。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022/2/23 下午5:42:42</span></div></footer> <!----> </main> <div class="footer-wrapper footer"><span><a href="https://beian.miit.gov.cn/">豫ICP备20003255号</a></span> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c67dc84b.js" defer></script><script src="/assets/js/2.39a7464a.js" defer></script><script src="/assets/js/160.434ab6c8.js" defer></script>
  </body>
</html>
