<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小张笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-141019448-1"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
      
          gtag('config', 'UA-141019448-1');
      </script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2468672938537807" crossorigin="anonymous"></script>
    <meta name="description" content="Little Zhang's Note">
    <meta name="baidu-site-verification" content="code-HRrK6kdBX1">
    
    <link rel="preload" href="/assets/css/0.styles.9b71556a.css" as="style"><link rel="preload" href="/assets/js/app.05d38243.js" as="script"><link rel="preload" href="/assets/js/2.a6173bc2.js" as="script"><link rel="preload" href="/assets/js/103.2717b6ca.js" as="script"><link rel="prefetch" href="/assets/js/10.bf63d664.js"><link rel="prefetch" href="/assets/js/100.693a312c.js"><link rel="prefetch" href="/assets/js/101.a893326d.js"><link rel="prefetch" href="/assets/js/102.7595455c.js"><link rel="prefetch" href="/assets/js/104.e6247331.js"><link rel="prefetch" href="/assets/js/105.9beaef90.js"><link rel="prefetch" href="/assets/js/106.6a48bf56.js"><link rel="prefetch" href="/assets/js/107.49a2484f.js"><link rel="prefetch" href="/assets/js/108.5141baf2.js"><link rel="prefetch" href="/assets/js/109.d4b9b021.js"><link rel="prefetch" href="/assets/js/11.2996c063.js"><link rel="prefetch" href="/assets/js/110.01ada224.js"><link rel="prefetch" href="/assets/js/111.9c0cf3f3.js"><link rel="prefetch" href="/assets/js/112.6bdbded4.js"><link rel="prefetch" href="/assets/js/113.6c4cb71e.js"><link rel="prefetch" href="/assets/js/114.8d6e510e.js"><link rel="prefetch" href="/assets/js/115.ec608b64.js"><link rel="prefetch" href="/assets/js/116.bd72681b.js"><link rel="prefetch" href="/assets/js/117.7a9d6ae8.js"><link rel="prefetch" href="/assets/js/118.eb65079d.js"><link rel="prefetch" href="/assets/js/119.8e84c7db.js"><link rel="prefetch" href="/assets/js/12.316aac3b.js"><link rel="prefetch" href="/assets/js/120.0e4a9746.js"><link rel="prefetch" href="/assets/js/121.797a43ad.js"><link rel="prefetch" href="/assets/js/122.62e66240.js"><link rel="prefetch" href="/assets/js/123.21b38e10.js"><link rel="prefetch" href="/assets/js/124.114ee50a.js"><link rel="prefetch" href="/assets/js/125.30e6e8b7.js"><link rel="prefetch" href="/assets/js/126.a1df8178.js"><link rel="prefetch" href="/assets/js/127.c9a89b73.js"><link rel="prefetch" href="/assets/js/128.7fcadff3.js"><link rel="prefetch" href="/assets/js/129.6a5efe13.js"><link rel="prefetch" href="/assets/js/13.e7ff1b14.js"><link rel="prefetch" href="/assets/js/130.8764c94c.js"><link rel="prefetch" href="/assets/js/131.d7e65b56.js"><link rel="prefetch" href="/assets/js/132.e703a334.js"><link rel="prefetch" href="/assets/js/133.b83b2c00.js"><link rel="prefetch" href="/assets/js/134.36bb3142.js"><link rel="prefetch" href="/assets/js/135.c98acf9a.js"><link rel="prefetch" href="/assets/js/136.e4e39ef7.js"><link rel="prefetch" href="/assets/js/137.99354c22.js"><link rel="prefetch" href="/assets/js/138.3ad88192.js"><link rel="prefetch" href="/assets/js/139.afc4b2b7.js"><link rel="prefetch" href="/assets/js/14.96cae973.js"><link rel="prefetch" href="/assets/js/140.af31ba25.js"><link rel="prefetch" href="/assets/js/15.b59d47ee.js"><link rel="prefetch" href="/assets/js/16.63ef0330.js"><link rel="prefetch" href="/assets/js/17.ab2f2dac.js"><link rel="prefetch" href="/assets/js/18.286c31f9.js"><link rel="prefetch" href="/assets/js/19.d17c3a00.js"><link rel="prefetch" href="/assets/js/20.dc7b487c.js"><link rel="prefetch" href="/assets/js/21.6b476e98.js"><link rel="prefetch" href="/assets/js/22.f9bfbad9.js"><link rel="prefetch" href="/assets/js/23.76b7cdec.js"><link rel="prefetch" href="/assets/js/24.c7e3e56c.js"><link rel="prefetch" href="/assets/js/25.c9f17ec9.js"><link rel="prefetch" href="/assets/js/26.ceeb895c.js"><link rel="prefetch" href="/assets/js/27.353cf9c7.js"><link rel="prefetch" href="/assets/js/28.b429ec7c.js"><link rel="prefetch" href="/assets/js/29.218d6a39.js"><link rel="prefetch" href="/assets/js/3.582414ce.js"><link rel="prefetch" href="/assets/js/30.e60063bd.js"><link rel="prefetch" href="/assets/js/31.31ea968a.js"><link rel="prefetch" href="/assets/js/32.b7359ea6.js"><link rel="prefetch" href="/assets/js/33.97561ec6.js"><link rel="prefetch" href="/assets/js/34.29ce886d.js"><link rel="prefetch" href="/assets/js/35.4f666517.js"><link rel="prefetch" href="/assets/js/36.6b954788.js"><link rel="prefetch" href="/assets/js/37.23afd5f5.js"><link rel="prefetch" href="/assets/js/38.b909d32b.js"><link rel="prefetch" href="/assets/js/39.a0462821.js"><link rel="prefetch" href="/assets/js/4.87848c26.js"><link rel="prefetch" href="/assets/js/40.4470e8cb.js"><link rel="prefetch" href="/assets/js/41.87c56094.js"><link rel="prefetch" href="/assets/js/42.3543fa98.js"><link rel="prefetch" href="/assets/js/43.6038e8e4.js"><link rel="prefetch" href="/assets/js/44.77c00904.js"><link rel="prefetch" href="/assets/js/45.05e89f7b.js"><link rel="prefetch" href="/assets/js/46.2fe0507a.js"><link rel="prefetch" href="/assets/js/47.3b724023.js"><link rel="prefetch" href="/assets/js/48.a7d02b7a.js"><link rel="prefetch" href="/assets/js/49.6c92af07.js"><link rel="prefetch" href="/assets/js/5.6c7f4d05.js"><link rel="prefetch" href="/assets/js/50.a736b76c.js"><link rel="prefetch" href="/assets/js/51.fdf07d65.js"><link rel="prefetch" href="/assets/js/52.6958d162.js"><link rel="prefetch" href="/assets/js/53.6598a087.js"><link rel="prefetch" href="/assets/js/54.4af2026b.js"><link rel="prefetch" href="/assets/js/55.034822e3.js"><link rel="prefetch" href="/assets/js/56.5a5f26b9.js"><link rel="prefetch" href="/assets/js/57.aff3a665.js"><link rel="prefetch" href="/assets/js/58.304ef9d0.js"><link rel="prefetch" href="/assets/js/59.6468404c.js"><link rel="prefetch" href="/assets/js/6.bb33fed3.js"><link rel="prefetch" href="/assets/js/60.fa65e7a8.js"><link rel="prefetch" href="/assets/js/61.8a2b4207.js"><link rel="prefetch" href="/assets/js/62.eed5a54f.js"><link rel="prefetch" href="/assets/js/63.5cfcbcb3.js"><link rel="prefetch" href="/assets/js/64.8c72f137.js"><link rel="prefetch" href="/assets/js/65.f2f736aa.js"><link rel="prefetch" href="/assets/js/66.f4fde240.js"><link rel="prefetch" href="/assets/js/67.2163bf62.js"><link rel="prefetch" href="/assets/js/68.362215f6.js"><link rel="prefetch" href="/assets/js/69.8cc82c96.js"><link rel="prefetch" href="/assets/js/7.432747bc.js"><link rel="prefetch" href="/assets/js/70.4c7a468d.js"><link rel="prefetch" href="/assets/js/71.a6328169.js"><link rel="prefetch" href="/assets/js/72.a231600f.js"><link rel="prefetch" href="/assets/js/73.096b496f.js"><link rel="prefetch" href="/assets/js/74.70983a16.js"><link rel="prefetch" href="/assets/js/75.9391bbcc.js"><link rel="prefetch" href="/assets/js/76.72cdaeb3.js"><link rel="prefetch" href="/assets/js/77.7c7b532f.js"><link rel="prefetch" href="/assets/js/78.c54e5e93.js"><link rel="prefetch" href="/assets/js/79.55c0179b.js"><link rel="prefetch" href="/assets/js/8.df898268.js"><link rel="prefetch" href="/assets/js/80.58526f91.js"><link rel="prefetch" href="/assets/js/81.966d6ad8.js"><link rel="prefetch" href="/assets/js/82.345bc9f4.js"><link rel="prefetch" href="/assets/js/83.a61a8d5a.js"><link rel="prefetch" href="/assets/js/84.c4d8e817.js"><link rel="prefetch" href="/assets/js/85.e5a4eba7.js"><link rel="prefetch" href="/assets/js/86.e2a8ef40.js"><link rel="prefetch" href="/assets/js/87.bed41bdd.js"><link rel="prefetch" href="/assets/js/88.3e18d2aa.js"><link rel="prefetch" href="/assets/js/89.925246c7.js"><link rel="prefetch" href="/assets/js/9.6a581cd3.js"><link rel="prefetch" href="/assets/js/90.2e31b64b.js"><link rel="prefetch" href="/assets/js/91.2cce8e2f.js"><link rel="prefetch" href="/assets/js/92.577bf3ad.js"><link rel="prefetch" href="/assets/js/93.2a10b95c.js"><link rel="prefetch" href="/assets/js/94.4c5453f1.js"><link rel="prefetch" href="/assets/js/95.e576205a.js"><link rel="prefetch" href="/assets/js/96.27ac01a2.js"><link rel="prefetch" href="/assets/js/97.cd67cb86.js"><link rel="prefetch" href="/assets/js/98.87fe1f79.js"><link rel="prefetch" href="/assets/js/99.e5a41af7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9b71556a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小张笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/211028_国内最大的c++软件项目之一_wps 的“自守”之道.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/211028_国内最大的c++软件项目之一_wps 的“自守”之道.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/file/211028_%E5%9B%BD%E5%86%85%E6%9C%80%E5%A4%A7%E7%9A%84c++%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%B8%80_wps%20%E7%9A%84%E2%80%9C%E8%87%AA%E5%AE%88%E2%80%9D%E4%B9%8B%E9%81%93.html#重新演绎-wps" class="sidebar-link">重新演绎 WPS</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/211028_%E5%9B%BD%E5%86%85%E6%9C%80%E5%A4%A7%E7%9A%84c++%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%B8%80_wps%20%E7%9A%84%E2%80%9C%E8%87%AA%E5%AE%88%E2%80%9D%E4%B9%8B%E9%81%93.html#四大引擎的演进" class="sidebar-link">四大引擎的演进</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/211028_%E5%9B%BD%E5%86%85%E6%9C%80%E5%A4%A7%E7%9A%84c++%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%B8%80_wps%20%E7%9A%84%E2%80%9C%E8%87%AA%E5%AE%88%E2%80%9D%E4%B9%8B%E9%81%93.html#新的不稳定状态" class="sidebar-link">新的不稳定状态</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/211028_%E5%9B%BD%E5%86%85%E6%9C%80%E5%A4%A7%E7%9A%84c++%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%B8%80_wps%20%E7%9A%84%E2%80%9C%E8%87%AA%E5%AE%88%E2%80%9D%E4%B9%8B%E9%81%93.html#linux-版-wps-从-用爱发电-开始" class="sidebar-link">Linux 版 WPS：从 “用爱发电” 开始</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/211028_%E5%9B%BD%E5%86%85%E6%9C%80%E5%A4%A7%E7%9A%84c++%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%B8%80_wps%20%E7%9A%84%E2%80%9C%E8%87%AA%E5%AE%88%E2%80%9D%E4%B9%8B%E9%81%93.html#程序员文化的传承" class="sidebar-link">程序员文化的传承</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>一个历经了三十多年发展的软件，这话听起来就让人感到沉甸甸的。但这款产品经历无数风雨后不仅活得好好的，至今还在不断焕发新的生机。</p> <p>本期<a href="https://www.infoq.cn/minibook/LxX7bFUwKH17bzxQkSKt" target="_blank" rel="noopener noreferrer">《中国卓越技术团队访谈录》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>封面故事的主角是金山办公旗下的 WPS 研发团队。WPS 是通用型国产办公软件的代表，可能是目前国内最大的 C++ 单体项目。有人用这样一种比喻去形容 WPS 的源代码：“就像翻动沉积岩，一层一层，这层是框架、往下是更老的核心框架、再翻则是更底层的数据处理等等，和考古一样（有趣）。” 虽然底层的东西一直都处于比较稳定的状态，不过在底层之上，也有另一番热闹景象。</p> <p><strong>采访嘉宾：</strong></p> <p>**庄湧，**金山办公高级副总裁、研发中台事业部总经理</p> <p><strong>晁云瞳（Yeppy）</strong>，金山办公助理总裁、金山文档事业部副总经理，兼 WebOffice 负责人</p> <p><strong>柳杨</strong>，金山办公总监，负责 Linux 方向研发</p> <h2 id="重新演绎-wps"><a href="#重新演绎-wps" class="header-anchor">#</a> 重新演绎 WPS</h2> <p>1989 年，WPS 1.0 问世后，在中文文字处理软件市场上获得了消费者的广泛追捧。一时间，风头无两。</p> <p>上个世纪 90 年代末，微软公司的办公软件跟随着操作系统进入中国市场，装载在中国消费者电脑上，MS Office 成为 “事实标准” 的时候，也是 WPS 推翻重来之时。这是一段不得不提的历史。当时 WPS 不是要改写，不是重构，而是需要一次彻底的重写。</p> <p>“我们要让用户能够在 Windows 端重新使用 WPS，首先就得承认微软 Office 的市场地位以及事实，而且要想让用户能够无缝切换过来，就必须得做到兼容。”2003 年进入 WPS 的庄湧表示，<strong>当时 V6 的主要目标是 “三大兼容”，包括：文件格式兼容、操作习惯兼容、二次开发接口兼容。</strong></p> <p>2002 年～2005 年，历经三年时间，一个涵盖了数百万行代码，内部研发代号为 “V6” 的 WPS 2005 版本，<strong>在一个全新的架构下 “重生” 了，并且能很好地兼容微软办公软件文件格式。</strong></p> <p>对于当时的 WPS 来说，只有这三大兼容做好了，才能让 WPS 有机会跟微软 Office 同台竞技。但也因为 “完美兼容”，一些质疑抄袭的声音开始出现。</p> <p>同样在 2003 年加入 WPS 的 Yeppy 还记得，当时有一些用户认为 WPS 推翻重写的决策是错误的，“说我们‘放弃了传统’。重写之后，WPS 原先很多心思巧妙的设计和功能来不及做，所以都砍掉了。我们是为了重新回到同台竞技的状态，但有些用户不理解，为什么不做自己的特色而是跟着人家跑了。”</p> <p>当时 WPS 2002 的产品在政企客户中的口碑并不好。Yeppy 表示，问题主要体现在几个方面：首先微软 Office 的文档格式逐渐成为主流，WPS 在打开微软文档的时候，容易出现各种错误和异常。其次产品交互和处于市场领先地位的竞品有很大不同，站在客户的角度，其实是给他们带来了不小的学习成本。</p> <p>第三，还是兼容问题，微软 Office 不再兼容 WPS。客户的系统（比如 ERP、OA 系统）都已经跟 Office 打通，需要导出、导入 Office 文件并在这些系统里处理，但这些系统接入 WPS 后发现功能都失效，不能用了。</p> <p>“其实说来说去就是一个问题，企业已经有的这些文件是 IT 资产，员工生产力也是资产，各种系统是 IT 基础建设的资产，从做 B 端市场的角度来说，我们至少要把这些资产给保护好，人家才愿意用我们的产品。”Yeppy 说道。</p> <p>于是，兼容成了 WPS 突围的唯一出路。文档格式兼容，保证不管用户从哪个端打开，文档都不会跑版、数据表现一致；操作习惯兼容，则要让用户在使用的过程中每个动作都不受影响，不另外产生新的学习成本；二次开发接口兼容主要是面向政府企业客户，这些客户更多是跟系统对接，很多时候需要用到丰富的二次开发接口，所以这个接口也要跟微软的保持一致。</p> <p>那时候，像庄湧和 Yeppy 这批新人进 WPS 后就投入到了做兼容这件事上。</p> <h2 id="四大引擎的演进"><a href="#四大引擎的演进" class="header-anchor">#</a> 四大引擎的演进</h2> <p>以文件格式兼容、操作习惯兼容、二次开发接口兼容为目标，WPS 2005 版本构建了全新的四大引擎，分别是文字的排版引擎、表格的计算引擎、演示的动画播放引擎以及公共的图形对象渲染引擎。</p> <p>庄湧表示，本质上，支撑 WPS 后续发展的基础就是当年的四大引擎，演进过程可以分三个阶段去看。</p> <p><img src="https://cdn.jiler.cn/techug/uploads/2021/10/img1635396607634339154.png" alt="img"></p> <p>2005 年 9 月 3 日，WPS Office 2005 封盘纪念。</p> <p>第一个阶段是 PC 时代，彼时四大引擎的重心是打磨自身，最基本的目标是保证 WPS 在 Windows 端的稳定性以及性能提升。</p> <p>文字排版引擎方面，不仅要让 WPS 打开微软 Office 文档的时候一页不差、一行不差、一字不差，同时也要提升性能，在打开几百页、上千页文档的时候，无论是在哪个位置编辑，甚至在多人协作时（当时还不是现在普遍的基于网络端的协作协同，而是需要通过文件传递和发送的方式去做批复），都要保障过程的顺畅。</p> <p>包括后来进入以银行为代表的金融企业，打磨表格的计算引擎的重点之一也是性能。“要做到在百万行数据中，无论在哪个地方操作都稳定且顺畅，背后其实要花好多功夫去优化。” 庄湧说。</p> <p>第二个阶段是移动时代。2011 年，雷军重回金山软件担任董事长，并一脚把 WPS 踹进了移动互联网。那会移动手机起步不久，受限于内存和屏幕尺寸，对于像 Office 这样的产品是否适合在手机上使用，该怎么用，大家心里都没底。但也正是因为这个机遇，WPS 的团队才真正开始用产品思维去思考问题。此前，为了与微软 Office 更好地兼容，团队更多是思考怎么和微软做得更像。</p> <p>团队面临的第一个问题就是，移动端的办公软件应该采用什么引擎？直接移植 C++ 开发的 PC 端引擎到安卓平台，会遇到很多兼容性问题，拖慢研发进度。因此研发团队选择了用 Java 语言开发新引擎，以赶上移动互联网时代的快速发展。而在做 iOS 版本的时候，庄湧既借鉴了安卓团队的移动开发经验，同时由于 iOS 平台支持 C++ 语言的开发，又复用了 PC 端的内核代码进行移植，节省了时间。</p> <p>然而，落地执行中团队遇到了更大困难：移动场景下办公需求发生了剧烈变化，功能不能照搬照抄，而是要围绕小内存、小屏幕等特性做取舍，这是移动时代引擎迭代过程中最大的挑战。“但是当时我们内部流行一句话，理解要执行，不理解也要在执行的过程中去加深理解。” 庄湧说。</p> <p>当时移动端仍然是新鲜事物，要把电脑里的办公软件搬到小小的手机屏幕里，这件事从没有哪家公司或者是哪个人尝试过，没有经验可借鉴，短时间甚至找不到合适的人。为了支持移动版开发，WPS 安卓团队的人不得不从 PC 团队中抽调，且均是骨干。</p> <p>随着人均持有的办公设备越来越多（比如手机、iPad、电脑等），为了解决文档在不同设备间流转所面临的问题，借助云技术，金山办公研发了 WPS 云文档。而随着对 Linux、Mac 等平台的不断适配，四大引擎在移动时代也充分验证了跨平台能力。</p> <p>第三阶段，随着 Web 端需求的增长，尤其是疫情下在线协作办公需求爆发，WPS 团队进一步在引擎中加入了协同特性。</p> <h2 id="新的不稳定状态"><a href="#新的不稳定状态" class="header-anchor">#</a> 新的不稳定状态</h2> <p>在日益月新的互联网行业里，新产品新事物层出不穷，某种意义上，发展了许多年的 WPS 已经是个相对稳定和成熟的产品，成长空间是否已经接近天花板？</p> <p>对于这个问题，Yeppy 说：“得看怎么去理解‘稳定’这两个字。如果是说内核，内核能不能保证不出错呢？”</p> <p>他以 WPS 的在线协作文档产品「金山文档」举例道，“为了能帮用户处理 Office 文档，我们在服务器上也跑了一个自己的内核。假如我们处理同一份文件，你在编辑，我也在编辑，那这两个编辑动作，该怎么样合到一个文件去，这里面有一个 OT（Operational Transformation）引擎，并且这个 OT 引擎一定要和我们原来的引擎相结合，保证计算、排版、调度、绘制、动画这些功能都是正常的。”</p> <p>“加了上面这些东西以后，原来的功能还算不算稳定呢？”Yeppy 进一步表示，从最基础的功能来说，WPS 看起来没有大的变化，但能力一直在横向和纵向扩展，比如协作是通过云端的引擎来做，比如多平台适配把内核从单一环境 “搬” 到了不同的设备环境，但它并不是直接搬就能跑起来，里面还有大量的开发和适配工作，这其实是一种“新的不稳定状态”。</p> <p>WPS 的客户端基本覆盖全平台，在服务器、云存储、浏览器前端等方向都有人在研究、在折腾各种新技术。</p> <p>Yeppy 介绍道，在线协作文档的服务器上跑的是核心引擎，怎么去做多人之间的操作、协作变换则是另外一个模块，用户连到服务器后怎么做并发承载，则是用的具备并发特性的语言去处理。为了能在各种浏览器运行，前端用的是 JavaScript，甚至在 10 年前团队还曾经试过用 Adobe 的 Flex 技术去做在浏览器里运行的小办公平台。诸如此类，不胜枚举。“<strong>折腾新技术其实是为了新的场景做准备</strong>。”Yeppy 说道。</p> <p>庄湧亦表示，从 PC 到移动再到云端，从工具转向云服务，为了解决用户的跨设备以及多人之间的协同协作问题，WPS 一直在不断吸收新技术，包括 AI。<strong>但技术只是手段，目的是帮助用户解决问题和提升工作效率，本质还是 “用户第一” 的理念，基于用户的场景和真实需求去应用技术。</strong></p> <h2 id="linux-版-wps-从-用爱发电-开始"><a href="#linux-版-wps-从-用爱发电-开始" class="header-anchor">#</a> Linux 版 WPS：从 “用爱发电” 开始</h2> <p>即使是 “小部分” 人群的需求，WPS 也没有忽视。如今，WPS Office 基本做到了全平台覆盖，包括在早期并不能带来商业价值的 Linux 平台。</p> <p>今年是 Linux 系统诞生三十周年，若从 2011 年立项算起，WPS 陪伴 Linux 其实也有十年了。柳杨从 2013 年开始参与 Linux 版 WPS 开发，他坦言，从操作系统的角度看，当时的 Linux 相比起 Windows，市占率非常低，而大家决定做 Linux 版的出发点其实很简单，因为有用户需要。</p> <p>“那时候用户给我们发了不少邮件，说想要 Linux 版，因为觉得 Linux 平台没有好用的办公软件。” 柳杨补充说，决定开发 Linux 版也跟 WPS 全平台覆盖的愿景有关，“<strong>我们就想让全平台用户都能有好用的办公软件</strong>。Linux 用户虽然不像 Windows 用户那么庞大，但是从 Linux 的用户画像来看，其中包括大量技术人员，有一些是真正的系统爱好者，有一些是在 Linux 平台上工作的，这些用户其实也是我们需要考虑到的一批优质用户。”</p> <p>“每一次我们发新版本的时候，尤其在 Linux 平台，很多用户就会给我们好评，说我们是一家良心企业，因为做 Linux 社区版不赚钱，但是我们一直在维护，默默去做这个产品，用户也常给我们一些正向的反馈。” 谈及怎么坚持做这么多年 Linux 社区版的时候，柳杨表示来自用户的支持也是一种动力。</p> <p><img src="https://cdn.jiler.cn/techug/uploads/2021/10/img1635396611302697004.png" alt="img"></p> <p>Linux 版 WPS 收到来自用户的暖心评价</p> <p>不过在发展过程中，Linux 版也有过一个 “小插曲”。2017 年上半年，一条关于“WPS Office for Linux 项目中止” 的消息不胫而走，在圈内引起过一阵热议。随后金山办公官方对此作出否认，称“WPS Office for Linux 并未停止更新，也从未有过停止更新的任何计划。”</p> <p>柳杨回忆道，“官方说明是我这边推动市场部去做的。” 为什么会出现这个传闻？他进一步解释称，原因主要有两方面，一是 Linux 面向个人的社区版分为海外版和国内版，当时有人提到海外版近一年没更新，很快网上就开始流传 Linux 版停止更新的猜测；二是跟当时产品刚好碰上大版本更迭有关。</p> <p>“17 年属于我们的一个转折点，WPS 要从 WPS 2016 升级到 WPS 2019，当时内部都在重点准备这个大版本，在推出 2016 加强版的同时，我们也在准备研究和开发 WPS 2019 版。大版本开发的工作量非常大，因此时间跨度也比较长。” 柳杨指出，大版本更新不仅做了新图表、云文档、SmartArt 等大量新功能，同时做了各种优化工作以及 bug 修复。而在这些工作没做完之前，发小版本其实对用户来说意义不大。</p> <p>此外，柳杨还提及了当下一个重要的行业变化。近几年，在 IT 国产化的浪潮下，强化产业链供应链自主可控，WPS 在 Linux 上的商业价值迅速显现，因此 Linux 团队经常需要闭关去做新的需求。</p> <p>据最新数据，金山办公的业务覆盖中国 30 多个省市自治区政府、400 多个市县级政府，连续多年为包括党政机关、金融、能源、航空、医疗、教育等领域在内众多行业提供定制化的办公产品和服务，帮助政府和企业加速实现数字化、智能化办公。</p> <h2 id="程序员文化的传承"><a href="#程序员文化的传承" class="header-anchor">#</a> 程序员文化的传承</h2> <p>2019 年 11 月，金山办公上市。现在人们往往只会看到其 “光鲜亮丽” 的一面：金山办公的市值挺高，WPS 活得挺滋润。但其实过去有很长一段时间，WPS 的日子并不好过，其发展起起伏伏。金山办公名誉董事长雷军亦曾说过：“曾经有很多人很多次劝我放弃 WPS，但是我们能够坚持下来，还是跟我们的使命息息相关，而不是一个纯粹的商业决定。”</p> <p>“技术立业” 的程序员文化是金山从创办之初就传承下来的。如今金山办公数千名员工，60% 以上是程序员，总数超过 2188 人，研发费用占营收比例超过 30%，位居科创板前列。Yeppy 认为，WPS 能坚持这么多年，一个很重要的原因是跟公司里的研发人员多有关，研发人很多时候会比较理想化、有使命感。公司历代领军人物细数下来，其实都是研发出身。</p> <p>最早可以追溯到 1988 年，当年求伯君把自己关在一个旅馆的小房间，用汇编语言敲出了 WPS 的第一个版本，这十多万行代码揭开了中文排版、中文办公时代的帷幕，这是个振奋人心的起点。“<strong>我认为这算是程序员个人英雄时代巅峰的辉煌。</strong>”Yeppy 感慨道，因为在那之后，软件开发就更多是群体作战模式。现在公司这么多号人，就是为了把几条产品线做到极致。</p> <p>“来 WPS 十年，我一直就是做 WPS Linux 版这款产品，从最开始只有几个人做，到现在我们也有非常大的团队去做，就一直围绕一个产品，把一件事做到极致。” 柳杨的语气中不乏坚定，在他看来，整个公司的氛围和基因里具备专注、热爱和理想的东西。“在我的认知范围里，我的职场生涯不用做太多花花绿绿的东西，也许把某一件事做好了，做到极致也就够了。”</p> <p>两个月前，在<a href="https://www.infoq.cn/article/k0ibBfCYT3c52BNFbdJx" target="_blank" rel="noopener noreferrer">金山技术开放日<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的活动上，庄湧曾介绍说，金山办公的技术人员具备一些独特特质，比如喜爱不断 “折腾”、精益求精等。具体来说，金山办公一代代传承下来的优秀程序员在写代码之前都会有多个维度的思考，从深度性到通用性，再到可维护性以及可扩展性。</p> <p>2002 年那一次 WPS 代码推翻重写，同时进行重塑的还有 WPS 的内核引擎。这么多年过去，当时重塑的四大办公软件引擎作为底座能支撑到今天，或许也恰恰印证了金山办公技术人的实力与底蕴。</p> <p>本文选自《中国卓越技术团队访谈录》（2021 年第五季），<a href="https://www.infoq.cn/minibook/LxX7bFUwKH17bzxQkSKt" target="_blank" rel="noopener noreferrer">点击下载电子书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，查看更多独家专访！</p> <p><strong>《中国顶尖技术团队访谈录》品牌升级，现正式更名为《中国卓越技术团队访谈录》</strong>，这是 InfoQ 打造的重磅内容产品，以各个国内优秀企业的 IT 技术团队为线索策划系列采访，希望向外界传递杰出技术团队的做事方法 / 技术实践，让开发者了解他们的知识积累、技术演进、产品锤炼与团队文化等，并从中获得有价值的见解。</p> <p>如果你身处传统企业经历了完整的数字化转型过程或者正在互联网公司进行创新技术的研发，并希望 InfoQ 可以关注并采访你所在的技术团队，可以添加微信：caifangfang842852，请注明来意及公司名称。</p> <p>本文文字及图片出自 <a href="https://www.infoq.cn/article/3bCZ0MqjJrmyBkTJCHxs" target="_blank" rel="noopener noreferrer">InfoQ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>全文完</p> <p>本文由 <a href="http://ksria.com/simpread" target="_blank" rel="noopener noreferrer">简悦 SimpRead<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 优化，用以提升阅读体验</p> <p>使用了 全新的简悦词法分析引擎 beta，<a href="http://ksria.com/simpread/docs/#/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%BC%95%E6%93%8E" target="_blank" rel="noopener noreferrer">点击查看<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>详细说明</p> <p><a href="https://www.techug.com/post/one-of-the-largest-c-plus-software-projects-in-china-wps-s-self-defense-way.html#sr-toc-0" target="_blank" rel="noopener noreferrer">重新演绎 WPS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://www.techug.com/post/one-of-the-largest-c-plus-software-projects-in-china-wps-s-self-defense-way.html#sr-toc-1" target="_blank" rel="noopener noreferrer">四大引擎的演进<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://www.techug.com/post/one-of-the-largest-c-plus-software-projects-in-china-wps-s-self-defense-way.html#sr-toc-2" target="_blank" rel="noopener noreferrer">新的不稳定状态<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://www.techug.com/post/one-of-the-largest-c-plus-software-projects-in-china-wps-s-self-defense-way.html#sr-toc-3" target="_blank" rel="noopener noreferrer">Linux 版 WPS：从 “用爱发电” 开始<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://www.techug.com/post/one-of-the-largest-c-plus-software-projects-in-china-wps-s-self-defense-way.html#sr-toc-4" target="_blank" rel="noopener noreferrer">程序员文化的传承<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021/11/12 上午12:25:46</span></div></footer> <!----> </main> <div class="footer-wrapper footer"><span><a href="https://beian.miit.gov.cn/">豫ICP备20003255号</a></span> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.05d38243.js" defer></script><script src="/assets/js/2.a6173bc2.js" defer></script><script src="/assets/js/103.2717b6ca.js" defer></script>
  </body>
</html>
