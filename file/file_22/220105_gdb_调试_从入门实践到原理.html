<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å°å¼ ç¬”è®°</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-141019448-1"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
      
          gtag('config', 'UA-141019448-1');
      </script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2468672938537807" crossorigin="anonymous"></script>
    <meta name="description" content="Little Zhang's Note">
    <meta name="baidu-site-verification" content="code-HRrK6kdBX1">
    
    <link rel="preload" href="/assets/css/0.styles.9b71556a.css" as="style"><link rel="preload" href="/assets/js/app.9582591d.js" as="script"><link rel="preload" href="/assets/js/2.a6173bc2.js" as="script"><link rel="preload" href="/assets/js/129.3bb78856.js" as="script"><link rel="prefetch" href="/assets/js/10.bf63d664.js"><link rel="prefetch" href="/assets/js/100.a06e9908.js"><link rel="prefetch" href="/assets/js/101.1752c00a.js"><link rel="prefetch" href="/assets/js/102.8bc80000.js"><link rel="prefetch" href="/assets/js/103.5dd4f5ae.js"><link rel="prefetch" href="/assets/js/104.833ac430.js"><link rel="prefetch" href="/assets/js/105.4d2da361.js"><link rel="prefetch" href="/assets/js/106.b5844b20.js"><link rel="prefetch" href="/assets/js/107.2b0aad6c.js"><link rel="prefetch" href="/assets/js/108.75c6f552.js"><link rel="prefetch" href="/assets/js/109.30bffdcb.js"><link rel="prefetch" href="/assets/js/11.aadd368b.js"><link rel="prefetch" href="/assets/js/110.d7c079c1.js"><link rel="prefetch" href="/assets/js/111.0c0f2ed2.js"><link rel="prefetch" href="/assets/js/112.7466820f.js"><link rel="prefetch" href="/assets/js/113.7ece5e39.js"><link rel="prefetch" href="/assets/js/114.492721cf.js"><link rel="prefetch" href="/assets/js/115.66ba5216.js"><link rel="prefetch" href="/assets/js/116.6b5eb6c2.js"><link rel="prefetch" href="/assets/js/117.8d647b4f.js"><link rel="prefetch" href="/assets/js/118.3f83232e.js"><link rel="prefetch" href="/assets/js/119.6456b1c4.js"><link rel="prefetch" href="/assets/js/12.ef0e7bb2.js"><link rel="prefetch" href="/assets/js/120.c164ee50.js"><link rel="prefetch" href="/assets/js/121.89721857.js"><link rel="prefetch" href="/assets/js/122.0dec1a13.js"><link rel="prefetch" href="/assets/js/123.09dc1f40.js"><link rel="prefetch" href="/assets/js/124.439f290f.js"><link rel="prefetch" href="/assets/js/125.8acfea8e.js"><link rel="prefetch" href="/assets/js/126.4779119a.js"><link rel="prefetch" href="/assets/js/127.16576eb2.js"><link rel="prefetch" href="/assets/js/128.4d10934f.js"><link rel="prefetch" href="/assets/js/13.60c4e03a.js"><link rel="prefetch" href="/assets/js/130.c019f492.js"><link rel="prefetch" href="/assets/js/131.891ad3cd.js"><link rel="prefetch" href="/assets/js/132.c7f540d8.js"><link rel="prefetch" href="/assets/js/133.e17c06bd.js"><link rel="prefetch" href="/assets/js/134.658b2050.js"><link rel="prefetch" href="/assets/js/135.5c5d3cb7.js"><link rel="prefetch" href="/assets/js/136.ff40d177.js"><link rel="prefetch" href="/assets/js/137.c7047377.js"><link rel="prefetch" href="/assets/js/138.e7c97515.js"><link rel="prefetch" href="/assets/js/139.fcc04691.js"><link rel="prefetch" href="/assets/js/14.2c7002f2.js"><link rel="prefetch" href="/assets/js/140.d1e32cc4.js"><link rel="prefetch" href="/assets/js/141.cf0f599b.js"><link rel="prefetch" href="/assets/js/142.0259a0ce.js"><link rel="prefetch" href="/assets/js/143.32ef75ba.js"><link rel="prefetch" href="/assets/js/144.105c41cd.js"><link rel="prefetch" href="/assets/js/145.b026234b.js"><link rel="prefetch" href="/assets/js/146.e6fdc557.js"><link rel="prefetch" href="/assets/js/147.eefdb03d.js"><link rel="prefetch" href="/assets/js/148.585e4fff.js"><link rel="prefetch" href="/assets/js/149.358de87e.js"><link rel="prefetch" href="/assets/js/15.4de023df.js"><link rel="prefetch" href="/assets/js/150.3b3d44d5.js"><link rel="prefetch" href="/assets/js/151.99eb067e.js"><link rel="prefetch" href="/assets/js/152.25c0a783.js"><link rel="prefetch" href="/assets/js/153.cf81e597.js"><link rel="prefetch" href="/assets/js/154.229e9bef.js"><link rel="prefetch" href="/assets/js/155.d7e35a2e.js"><link rel="prefetch" href="/assets/js/156.3830314b.js"><link rel="prefetch" href="/assets/js/157.a65ef48d.js"><link rel="prefetch" href="/assets/js/158.4ef72c7a.js"><link rel="prefetch" href="/assets/js/159.a91a9e40.js"><link rel="prefetch" href="/assets/js/16.b93d6c0b.js"><link rel="prefetch" href="/assets/js/160.e5bf5269.js"><link rel="prefetch" href="/assets/js/161.60206e8b.js"><link rel="prefetch" href="/assets/js/162.253aabfd.js"><link rel="prefetch" href="/assets/js/163.bbead85c.js"><link rel="prefetch" href="/assets/js/164.d7f6fc95.js"><link rel="prefetch" href="/assets/js/165.0e630561.js"><link rel="prefetch" href="/assets/js/166.2aecebbc.js"><link rel="prefetch" href="/assets/js/167.d2b6f663.js"><link rel="prefetch" href="/assets/js/168.3413f0f7.js"><link rel="prefetch" href="/assets/js/169.6bb62297.js"><link rel="prefetch" href="/assets/js/17.50a4cf3d.js"><link rel="prefetch" href="/assets/js/170.d248b63a.js"><link rel="prefetch" href="/assets/js/171.b15b0b98.js"><link rel="prefetch" href="/assets/js/172.53917b06.js"><link rel="prefetch" href="/assets/js/18.fb9b797a.js"><link rel="prefetch" href="/assets/js/19.675e7f4b.js"><link rel="prefetch" href="/assets/js/20.9afd380f.js"><link rel="prefetch" href="/assets/js/21.2d80faa7.js"><link rel="prefetch" href="/assets/js/22.9d9363ab.js"><link rel="prefetch" href="/assets/js/23.f639be99.js"><link rel="prefetch" href="/assets/js/24.a7985697.js"><link rel="prefetch" href="/assets/js/25.e18d2339.js"><link rel="prefetch" href="/assets/js/26.d5a8efd0.js"><link rel="prefetch" href="/assets/js/27.be3c7096.js"><link rel="prefetch" href="/assets/js/28.065e60f5.js"><link rel="prefetch" href="/assets/js/29.17e68582.js"><link rel="prefetch" href="/assets/js/3.582414ce.js"><link rel="prefetch" href="/assets/js/30.b0baeeff.js"><link rel="prefetch" href="/assets/js/31.cb1b182a.js"><link rel="prefetch" href="/assets/js/32.7e360b94.js"><link rel="prefetch" href="/assets/js/33.7108bfa8.js"><link rel="prefetch" href="/assets/js/34.c8d3757e.js"><link rel="prefetch" href="/assets/js/35.557ebc2a.js"><link rel="prefetch" href="/assets/js/36.ef3dfd72.js"><link rel="prefetch" href="/assets/js/37.c417aa61.js"><link rel="prefetch" href="/assets/js/38.dee41f22.js"><link rel="prefetch" href="/assets/js/39.7d33731b.js"><link rel="prefetch" href="/assets/js/4.61c13500.js"><link rel="prefetch" href="/assets/js/40.4a34c99b.js"><link rel="prefetch" href="/assets/js/41.e686adf9.js"><link rel="prefetch" href="/assets/js/42.26dae2e8.js"><link rel="prefetch" href="/assets/js/43.66b41ada.js"><link rel="prefetch" href="/assets/js/44.a9b83519.js"><link rel="prefetch" href="/assets/js/45.36cce691.js"><link rel="prefetch" href="/assets/js/46.1571750c.js"><link rel="prefetch" href="/assets/js/47.5ef2e5f0.js"><link rel="prefetch" href="/assets/js/48.4e02e2a8.js"><link rel="prefetch" href="/assets/js/49.bae75f8c.js"><link rel="prefetch" href="/assets/js/5.6c7f4d05.js"><link rel="prefetch" href="/assets/js/50.2b73aa0d.js"><link rel="prefetch" href="/assets/js/51.e464afd6.js"><link rel="prefetch" href="/assets/js/52.72462e20.js"><link rel="prefetch" href="/assets/js/53.704a046e.js"><link rel="prefetch" href="/assets/js/54.11553025.js"><link rel="prefetch" href="/assets/js/55.bec4ce27.js"><link rel="prefetch" href="/assets/js/56.f98acd6b.js"><link rel="prefetch" href="/assets/js/57.d70bbe3b.js"><link rel="prefetch" href="/assets/js/58.2d51457e.js"><link rel="prefetch" href="/assets/js/59.a61c72f7.js"><link rel="prefetch" href="/assets/js/6.bb33fed3.js"><link rel="prefetch" href="/assets/js/60.8d1bec36.js"><link rel="prefetch" href="/assets/js/61.59c5ee89.js"><link rel="prefetch" href="/assets/js/62.ac93daf6.js"><link rel="prefetch" href="/assets/js/63.40df2cf8.js"><link rel="prefetch" href="/assets/js/64.ecd858e4.js"><link rel="prefetch" href="/assets/js/65.21f3258f.js"><link rel="prefetch" href="/assets/js/66.171f35fe.js"><link rel="prefetch" href="/assets/js/67.562942ac.js"><link rel="prefetch" href="/assets/js/68.6df222fd.js"><link rel="prefetch" href="/assets/js/69.7d13f83f.js"><link rel="prefetch" href="/assets/js/7.03daa1b7.js"><link rel="prefetch" href="/assets/js/70.391277d9.js"><link rel="prefetch" href="/assets/js/71.b9bda1ec.js"><link rel="prefetch" href="/assets/js/72.66176b3f.js"><link rel="prefetch" href="/assets/js/73.dab66c9c.js"><link rel="prefetch" href="/assets/js/74.470b1f15.js"><link rel="prefetch" href="/assets/js/75.5afb9d35.js"><link rel="prefetch" href="/assets/js/76.823db0a9.js"><link rel="prefetch" href="/assets/js/77.aaba26af.js"><link rel="prefetch" href="/assets/js/78.6e7250ab.js"><link rel="prefetch" href="/assets/js/79.a10866fe.js"><link rel="prefetch" href="/assets/js/8.150af887.js"><link rel="prefetch" href="/assets/js/80.1a710702.js"><link rel="prefetch" href="/assets/js/81.fb6ada45.js"><link rel="prefetch" href="/assets/js/82.fbc130b3.js"><link rel="prefetch" href="/assets/js/83.4f604021.js"><link rel="prefetch" href="/assets/js/84.27315e8e.js"><link rel="prefetch" href="/assets/js/85.e8f82aae.js"><link rel="prefetch" href="/assets/js/86.8b6718bd.js"><link rel="prefetch" href="/assets/js/87.9ba8b8d2.js"><link rel="prefetch" href="/assets/js/88.353f5275.js"><link rel="prefetch" href="/assets/js/89.620be4f7.js"><link rel="prefetch" href="/assets/js/9.f7aab732.js"><link rel="prefetch" href="/assets/js/90.c02a5f85.js"><link rel="prefetch" href="/assets/js/91.486e70d6.js"><link rel="prefetch" href="/assets/js/92.44b6b56c.js"><link rel="prefetch" href="/assets/js/93.b3bf1947.js"><link rel="prefetch" href="/assets/js/94.40b89e32.js"><link rel="prefetch" href="/assets/js/95.47d2b977.js"><link rel="prefetch" href="/assets/js/96.ef8bcb5f.js"><link rel="prefetch" href="/assets/js/97.604dbc59.js"><link rel="prefetch" href="/assets/js/98.ffa22afb.js"><link rel="prefetch" href="/assets/js/99.146aa0a5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9b71556a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">å°å¼ ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ç´¢å¼•/Search.html" class="nav-link">
  Googleç«™å†…æœç´¢
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/file_22/220105_gdb_è°ƒè¯•_ä»å…¥é—¨å®è·µåˆ°åŸç†.html" class="nav-link">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ç´¢å¼•/Search.html" class="nav-link">
  Googleç«™å†…æœç´¢
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/file_22/220105_gdb_è°ƒè¯•_ä»å…¥é—¨å®è·µåˆ°åŸç†.html" class="nav-link">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav>  <!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>gdb_è°ƒè¯•_ä»å…¥é—¨å®è·µåˆ°åŸç†
https://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;mid=2247486816&amp;idx=1&amp;sn=a6dfc1361ce15ce5ad1c7d7734f9c939&amp;chksm=c3376ba7f440e2b18267c303c35572ab089fb97d3b2fe0adb58009637d6631020bb52bd9a28c&amp;scene=90&amp;subscene=93&amp;sessionid=1641357450&amp;clicktime=1641357452&amp;enterid=1641357452&amp;ascene=56&amp;devicetype=android-28&amp;version=2800105d&amp;nettype=WIFI&amp;abtest_cookie=AAACAA%3D%3D&amp;lang=zh_CN&amp;exportkey=AUEdBXXUioQROVUWB%2B24Qp8%3D&amp;pass_ticket=%2B3e0Y17j0cjm3REMTeghpi%2BjSzKqssP918so5VaZuyEaklJjnjS7a7qpQjVDLl0R&amp;wx_header=1
å…¬ä¼—å·
ä½ å¥½ï¼Œæˆ‘æ˜¯é›¨ä¹ï¼</p> <p>åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†çº¿ä¸Š coredump äº§ç”Ÿçš„åŸå› ï¼Œå…¶ä¸­ç”¨åˆ°äº† coredump åˆ†æå·¥å…· gdbï¼Œè¿™å‡ å¤©ä¸€ç›´æœ‰è¯»è€…åœ¨é—®ï¼Œèƒ½ä¸èƒ½å†™ä¸€ç¯‡å…³äº gdb è°ƒè¯•æ–¹é¢çš„æ–‡ç« ï¼Œä»Šå¤©å€ŸåŠ©æ­¤æ–‡ï¼Œåˆ†äº«ä¸€äº›å·¥ä½œä¸­çš„è°ƒè¯•ç»éªŒï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°å¤§å®¶ã€‚</p> <p>å†™åœ¨å‰é¢
åœ¨æˆ‘çš„å·¥ä½œç»å†ä¸­ï¼Œå‰å‡ å¹´åœ¨ Windows ä¸Šè¿›è¡Œå¼€å‘ï¼Œä½¿ç”¨ Visual Studio è¿›è¡Œè°ƒè¯•ï¼Œç®€ç›´æ˜¯åˆ©å™¨ï¼Œå„ç§æ–­ç‚¹ç­‰ç”¨é¼ æ ‡ç‚¹ç‚¹ç‚¹å°±èƒ½è®¾ç½®ï¼›å¤§æ¦‚ä» 12 å¹´å¼€å§‹è½¬ Linux å¼€å‘äº†ï¼Œæ‰€ä»¥è°ƒè¯•éƒ½æ˜¯åŸºäº GDB çš„ã€‚æœ¬æ¥è¿™ç¯‡æ–‡ç« ä¹Ÿæƒ³å†™å†™ Windows ä¸‹è°ƒè¯•ç›¸å…³ï¼Œå¥ˆä½•å¥½å¤šå¹´æ²¡ç”¨äº†ï¼Œå†åŠ ä¸Šå·¥ä½œå¤ªå¿™ï¼Œæ‰€ä»¥æœ¬æ–‡å°±åªå†™äº† Linux ä¸‹ GDB è°ƒè¯•ç›¸å…³ï¼Œå¯¹äº Windows å¼€å‘äººå‘˜ï¼Œå®åœ¨å¯¹ä¸ä½äº†ğŸ˜ƒã€‚</p> <p>è¿™ç¯‡æ–‡ç« ï¼Œæ¶‰åŠçš„æ¯”è¾ƒå…¨é¢ï¼Œæ€»ç»“äº†è¿™äº›å¹´çš„ gdb è°ƒè¯•ç»éªŒ (éƒ½æ˜¯å°å„¿ç§‘ğŸ˜)ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€äº›è°ƒè¯•æŠ€å·§ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä»äº‹ Linux å¼€å‘çš„ç›¸å…³äººå‘˜æœ‰æ‰€å¸®åŠ©</p> <p>èƒŒæ™¯
ä½œä¸º C/C++ å¼€å‘äººå‘˜ï¼Œä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œæ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç›®çš„ã€‚è€Œä¸ºäº†ä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè°ƒè¯•åˆ™æ˜¯æœ€åŸºæœ¬çš„æ‰‹æ®µï¼Œç†Ÿæ‚‰è¿™äº›è°ƒè¯•æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„å®šä½ç¨‹åºé—®é¢˜æ‰€åœ¨ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p> <p>åœ¨å¼€å‘è¿‡ç¨‹ï¼Œå¦‚æœç¨‹åºçš„è¿è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œç¬¬ä¸€æ—¶é—´å°±æ˜¯æ‰“å¼€ GDB è¿›è¡Œè°ƒè¯•ï¼Œåœ¨å¯¹åº”çš„åœ°æ–¹è®¾ç½®æ–­ç‚¹ï¼Œç„¶ååˆ†æåŸå› ï¼›å½“çº¿ä¸ŠæœåŠ¡å‡ºäº†é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´æŸ¥çœ‹è¿›ç¨‹åœ¨ä¸åœ¨ï¼Œå¦‚æœä¸åœ¨çš„è¯ï¼Œæ˜¯å¦ç”Ÿæˆäº†coredumpæ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨ gdb è°ƒè¯• coredump æ–‡ä»¶ï¼Œå¦åˆ™é€šè¿‡dmesgæ¥åˆ†æå†…æ ¸æ—¥å¿—æ¥æŸ¥æ‰¾åŸå› ã€‚</p> <p>æ¦‚å¿µ
GDB æ˜¯ä¸€ä¸ªç”± GNU å¼€æºç»„ç»‡å‘å¸ƒçš„ã€UNIX/LINUX æ“ä½œç³»ç»Ÿä¸‹çš„ã€ã€ŒåŸºäºå‘½ä»¤è¡Œçš„ã€åŠŸèƒ½å¼ºå¤§çš„ç¨‹åºè°ƒè¯•å·¥å…·ã€ã€‚</p> <p>GDB æ”¯æŒæ–­ç‚¹ã€å•æ­¥æ‰§è¡Œã€æ‰“å°å˜é‡ã€è§‚å¯Ÿå˜é‡ã€æŸ¥çœ‹å¯„å­˜å™¨ã€æŸ¥çœ‹å †æ ˆç­‰è°ƒè¯•æ‰‹æ®µã€‚åœ¨ Linux ç¯å¢ƒè½¯ä»¶å¼€å‘ä¸­ï¼ŒGDB æ˜¯ä¸»è¦çš„è°ƒè¯•å·¥å…·ï¼Œç”¨æ¥è°ƒè¯• C å’Œ C++ ç¨‹åº (ä¹Ÿæ”¯æŒ go ç­‰å…¶ä»–è¯­è¨€)ã€‚</p> <p>å¸¸ç”¨å‘½ä»¤
æ–­ç‚¹
æ–­ç‚¹æ˜¯æˆ‘ä»¬åœ¨è°ƒè¯•ä¸­ç»å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨æŒ‡å®šä½ç½®è®¾ç½®æ–­ç‚¹ä¹‹åï¼Œç¨‹åºè¿è¡Œåˆ°è¯¥ä½ç½®å°†ä¼šæš‚åœï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œæ›´å¤šçš„æ“ä½œï¼Œæ¯”å¦‚æŸ¥çœ‹å˜é‡å†…å®¹ï¼Œå †æ ˆæƒ…å†µç­‰ç­‰ï¼Œä»¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ç¨‹åºã€‚</p> <p>ä»¥è®¾ç½®æ–­ç‚¹çš„å‘½ä»¤åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p> <p>breakpoint
watchpoint
catchpoint
breakpoint
å¯ä»¥æ ¹æ®è¡Œå·ã€å‡½æ•°ã€æ¡ä»¶ç”Ÿæˆæ–­ç‚¹ï¼Œä¸‹é¢æ˜¯ç›¸å…³å‘½ä»¤ä»¥åŠå¯¹åº”çš„ä½œç”¨è¯´æ˜ï¼š</p> <p>å‘½ä»¤	ä½œç”¨
break [file]:function	åœ¨æ–‡ä»¶ file çš„ function å‡½æ•°å…¥å£è®¾ç½®æ–­ç‚¹
break [file]:line	åœ¨æ–‡ä»¶ file çš„ç¬¬ line è¡Œè®¾ç½®æ–­ç‚¹
info breakpoints	æŸ¥çœ‹æ–­ç‚¹åˆ—è¡¨
break [+-]offset	åœ¨å½“å‰ä½ç½®åç§»é‡ä¸º [+-]offset å¤„è®¾ç½®æ–­ç‚¹
break *addr	åœ¨åœ°å€ addr å¤„è®¾ç½®æ–­ç‚¹
break ... if expr	è®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼Œä»…ä»…åœ¨æ¡ä»¶æ»¡è¶³æ—¶
ignore n count	æ¥ä¸‹æ¥å¯¹äºç¼–å·ä¸º n çš„æ–­ç‚¹å¿½ç•¥ count æ¬¡
clear	åˆ é™¤æ‰€æœ‰æ–­ç‚¹
clear function	åˆ é™¤æ‰€æœ‰ä½äº function å†…çš„æ–­ç‚¹
delete n	åˆ é™¤æŒ‡å®šç¼–å·çš„æ–­ç‚¹
enable n	å¯ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹
disable n	ç¦ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹
save breakpoints file	ä¿å­˜æ–­ç‚¹ä¿¡æ¯åˆ°æŒ‡å®šæ–‡ä»¶
source file	å¯¼å…¥æ–‡ä»¶ä¸­ä¿å­˜çš„æ–­ç‚¹ä¿¡æ¯
break	åœ¨ä¸‹ä¸€ä¸ªæŒ‡ä»¤å¤„è®¾ç½®æ–­ç‚¹
clear [file:]line	åˆ é™¤ç¬¬ line è¡Œçš„æ–­ç‚¹
watchpoint
watchpoint æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–­ç‚¹ï¼Œç±»ä¼¼äºæ­£å¸¸æ–­ç‚¹ï¼Œæ˜¯è¦æ±‚ GDB æš‚åœç¨‹åºæ‰§è¡Œçš„å‘½ä»¤ã€‚åŒºåˆ«åœ¨äº watchpointæ²¡æœ‰é©»ç•™æŸä¸€è¡Œæºä»£ç ä¸­ï¼Œè€Œæ˜¯æŒ‡ç¤º GDB æ¯å½“æŸä¸ªè¡¨è¾¾å¼æ”¹å˜äº†å€¼å°±æš‚åœæ‰§è¡Œçš„å‘½ä»¤ã€‚</p> <p>watchpoint åˆ†ä¸ºç¡¬ä»¶å®ç°å’Œè½¯ä»¶å®ç°ä¸¤ç§ã€‚å‰è€…éœ€è¦ç¡¬ä»¶ç³»ç»Ÿçš„æ”¯æŒï¼›åè€…çš„åŸç†å°±æ˜¯æ¯æ­¥æ‰§è¡Œåéƒ½æ£€æŸ¥å˜é‡çš„å€¼æ˜¯å¦æ”¹å˜ã€‚GDB åœ¨æ–°å»ºæ•°æ®æ–­ç‚¹æ—¶ä¼šä¼˜å…ˆå°è¯•ç¡¬ä»¶æ–¹å¼ï¼Œå¦‚æœå¤±è´¥å†å°è¯•è½¯ä»¶å®ç°ã€‚</p> <p>å‘½ä»¤	ä½œç”¨
watch variable	è®¾ç½®å˜é‡æ•°æ®æ–­ç‚¹
watch var1 + var2	è®¾ç½®è¡¨è¾¾å¼æ•°æ®æ–­ç‚¹
rwatch variable	è®¾ç½®è¯»æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°
awatch variable	è®¾ç½®è¯»å†™æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°
info watchpoints	æŸ¥çœ‹æ•°æ®æ–­ç‚¹åˆ—è¡¨
set can-use-hw-watchpoints 0	å¼ºåˆ¶åŸºäºè½¯ä»¶æ–¹å¼å®ç°
ä½¿ç”¨æ•°æ®æ–­ç‚¹æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š</p> <p>å½“ç›‘æ§å˜é‡ä¸ºå±€éƒ¨å˜é‡æ—¶ï¼Œä¸€æ—¦å±€éƒ¨å˜é‡å¤±æ•ˆï¼Œæ•°æ®æ–­ç‚¹ä¹Ÿä¼šå¤±æ•ˆ
å¦‚æœç›‘æ§çš„æ˜¯æŒ‡é’ˆå˜é‡pï¼Œåˆ™watch *pç›‘æ§çš„æ˜¯pæ‰€æŒ‡å†…å­˜æ•°æ®çš„å˜åŒ–æƒ…å†µï¼Œè€Œwatch pç›‘æ§çš„æ˜¯pæŒ‡é’ˆæœ¬èº«æœ‰æ²¡æœ‰æ”¹å˜æŒ‡å‘
æœ€å¸¸è§çš„æ•°æ®æ–­ç‚¹åº”ç”¨åœºæ™¯ï¼šã€Œå®šä½å †ä¸Šçš„ç»“æ„ä½“å†…éƒ¨æˆå‘˜ä½•æ—¶è¢«ä¿®æ”¹ã€ã€‚ç”±äºæŒ‡é’ˆä¸€èˆ¬ä¸ºå±€éƒ¨å˜é‡ï¼Œä¸ºäº†è§£å†³æ–­ç‚¹å¤±æ•ˆï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ã€‚</p> <p>å‘½ä»¤	ä½œç”¨
print &amp;variable	æŸ¥çœ‹å˜é‡çš„å†…å­˜åœ°å€
watch *(type *)address	é€šè¿‡å†…å­˜åœ°å€é—´æ¥è®¾ç½®æ–­ç‚¹
watch -l variable	æŒ‡å®š location å‚æ•°
watch variable thread 1	ä»…ç¼–å·ä¸º 1 çš„çº¿ç¨‹ä¿®æ”¹å˜é‡ var å€¼æ—¶ä¼šä¸­æ–­
catchpoint
ä»å­—é¢æ„æ€ç†è§£ï¼Œæ˜¯æ•è·æ–­ç‚¹ï¼Œå…¶ä¸»è¦ç›‘æµ‹ä¿¡å·çš„äº§ç”Ÿã€‚ä¾‹å¦‚ c++ çš„ throwï¼Œæˆ–è€…åŠ è½½åº“çš„æ—¶å€™ï¼Œäº§ç”Ÿæ–­ç‚¹è¡Œä¸ºã€‚</p> <p>å‘½ä»¤	å«ä¹‰
catch fork	ç¨‹åºè°ƒç”¨ fork æ—¶ä¸­æ–­
tcatch fork	è®¾ç½®çš„æ–­ç‚¹åªè§¦å‘ä¸€æ¬¡ï¼Œä¹‹åè¢«è‡ªåŠ¨åˆ é™¤
catch syscall ptrace	ä¸º ptrace ç³»ç»Ÿè°ƒç”¨è®¾ç½®æ–­ç‚¹
â
åœ¨commandå‘½ä»¤ååŠ æ–­ç‚¹ç¼–å·ï¼Œå¯ä»¥å®šä¹‰æ–­ç‚¹è§¦å‘åæƒ³è¦æ‰§è¡Œçš„æ“ä½œã€‚åœ¨ä¸€äº›é«˜çº§çš„è‡ªåŠ¨åŒ–è°ƒè¯•åœºæ™¯ä¸­å¯èƒ½ä¼šç”¨åˆ°ã€‚</p> <p>â
å‘½ä»¤è¡Œ
å‘½ä»¤	ä½œç”¨
run arglist	ä»¥ arglist ä¸ºå‚æ•°åˆ—è¡¨è¿è¡Œç¨‹åº
set args arglist	æŒ‡å®šå¯åŠ¨å‘½ä»¤è¡Œå‚æ•°
set args	æŒ‡å®šç©ºçš„å‚æ•°åˆ—è¡¨
show args	æ‰“å°å‘½ä»¤è¡Œåˆ—è¡¨
ç¨‹åºæ ˆ
å‘½ä»¤	ä½œç”¨
backtrace [n]	æ‰“å°æ ˆå¸§
frame [n]	é€‰æ‹©ç¬¬ n ä¸ªæ ˆå¸§ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ‰“å°å½“å‰æ ˆå¸§
up n	é€‰æ‹©å½“å‰æ ˆå¸§ç¼–å· + n çš„æ ˆå¸§
down n	é€‰æ‹©å½“å‰æ ˆå¸§ç¼–å· - n çš„æ ˆå¸§
info frame [addr]	æè¿°å½“å‰é€‰æ‹©çš„æ ˆå¸§
info args	å½“å‰æ ˆå¸§çš„å‚æ•°åˆ—è¡¨
info locals	å½“å‰æ ˆå¸§çš„å±€éƒ¨å˜é‡
å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹
å¤šè¿›ç¨‹
GDB åœ¨è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºï¼ˆç¨‹åºå«forkè°ƒç”¨ï¼‰æ—¶ï¼Œé»˜è®¤åªè¿½è¸ªçˆ¶è¿›ç¨‹ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è®¾ç½®ï¼Œå®ç°åªè¿½è¸ªçˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹ï¼Œæˆ–è€…åŒæ—¶è°ƒè¯•çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚</p> <p>å‘½ä»¤	ä½œç”¨
info inferiors	æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨
attach pid	ç»‘å®šè¿›ç¨‹ id
inferior num	åˆ‡æ¢åˆ°æŒ‡å®šè¿›ç¨‹ä¸Šè¿›è¡Œè°ƒè¯•
print $_exitcode	æ˜¾ç¤ºç¨‹åºé€€å‡ºæ—¶çš„è¿”å›å€¼
set follow-fork-mode child	è¿½è¸ªå­è¿›ç¨‹
set follow-fork-mode parent	è¿½è¸ªçˆ¶è¿›ç¨‹
set detach-on-fork on	fork è°ƒç”¨æ—¶åªè¿½è¸ªå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹
set detach-on-fork off	fork è°ƒç”¨æ—¶ä¼šåŒæ—¶è¿½è¸ªçˆ¶å­è¿›ç¨‹
åœ¨è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºæ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤äº†å½“å‰è°ƒè¯•çš„è¿›ç¨‹ï¼Œå…¶ä»–è¿›ç¨‹éƒ½å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œå¦‚æœéœ€è¦åœ¨è°ƒè¯•å½“å‰è¿›ç¨‹çš„æ—¶å€™ï¼Œå…¶ä»–è¿›ç¨‹ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œï¼Œé‚£ä¹ˆé€šè¿‡è®¾ç½®set schedule-multiple onå³å¯ã€‚</p> <p>å¤šçº¿ç¨‹
å¤šçº¿ç¨‹å¼€å‘åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­å¾ˆå¸¸è§ï¼Œæ‰€ä»¥å¤šçº¿ç¨‹çš„è°ƒè¯•æŠ€å·§éå¸¸æœ‰å¿…è¦æŒæ¡ã€‚</p> <p>é»˜è®¤è°ƒè¯•å¤šçº¿ç¨‹æ—¶ï¼Œä¸€æ—¦ç¨‹åºä¸­æ–­ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å°†æš‚åœã€‚å¦‚æœæ­¤æ—¶å†ç»§ç»­æ‰§è¡Œå½“å‰çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿä¼šåŒæ—¶æ‰§è¡Œã€‚</p> <p>å‘½ä»¤	ä½œç”¨
info threads	æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨
print $_thread	æ˜¾ç¤ºå½“å‰æ­£åœ¨è°ƒè¯•çš„çº¿ç¨‹ç¼–å·
set scheduler-locking on	è°ƒè¯•ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œå…¶ä»–çº¿ç¨‹æš‚åœæ‰§è¡Œ
set scheduler-locking off	è°ƒè¯•ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œå…¶ä»–çº¿ç¨‹åŒæ­¥æ‰§è¡Œ
set scheduler-locking step	ä»…ç”¨ step è°ƒè¯•çº¿ç¨‹æ—¶å…¶ä»–çº¿ç¨‹ä¸æ‰§è¡Œï¼Œç”¨å…¶ä»–å‘½ä»¤å¦‚ next è°ƒè¯•æ—¶ä»æ‰§è¡Œ
å¦‚æœåªå…³å¿ƒå½“å‰çº¿ç¨‹ï¼Œå»ºè®®ä¸´æ—¶è®¾ç½® scheduler-locking ä¸º onï¼Œé¿å…å…¶ä»–çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¯¼è‡´å‘½ä¸­å…¶ä»–æ–­ç‚¹åˆ†æ•£æ³¨æ„åŠ›ã€‚</p> <p>æ‰“å°è¾“å‡º
é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹æŸä¸ªå˜é‡çš„å€¼ï¼Œä»¥åˆ†æå…¶æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ‰“å°è¾“å‡ºå˜é‡å€¼ã€‚</p> <p>å‘½ä»¤	ä½œç”¨
whatis variable	æŸ¥çœ‹å˜é‡çš„ç±»å‹
ptype variable	æŸ¥çœ‹å˜é‡è¯¦ç»†çš„ç±»å‹ä¿¡æ¯
info variables var	æŸ¥çœ‹å®šä¹‰è¯¥å˜é‡çš„æ–‡ä»¶ï¼Œä¸æ”¯æŒå±€éƒ¨å˜é‡
æ‰“å°å­—ç¬¦ä¸²
ä½¿ç”¨x/så‘½ä»¤æ‰“å°ASCIIå­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯å®½å­—ç¬¦å­—ç¬¦ä¸²ï¼Œéœ€è¦å…ˆçœ‹å®½å­—ç¬¦çš„é•¿åº¦ print sizeof(str)ã€‚</p> <p>å¦‚æœé•¿åº¦ä¸º2ï¼Œåˆ™ä½¿ç”¨x/hsæ‰“å°ï¼›å¦‚æœé•¿åº¦ä¸º4ï¼Œåˆ™ä½¿ç”¨x/wsæ‰“å°ã€‚</p> <p>å‘½ä»¤	ä½œç”¨
x/s str	æ‰“å°å­—ç¬¦ä¸²
set print elements 0	æ‰“å°ä¸é™åˆ¶å­—ç¬¦ä¸²é•¿åº¦ / æˆ–ä¸é™åˆ¶æ•°ç»„é•¿åº¦
call printf(&quot;%s\n&quot;,xxx)	è¿™æ—¶æ‰“å°å‡ºçš„å­—ç¬¦ä¸²ä¸ä¼šå«æœ‰å¤šä½™çš„è½¬ä¹‰ç¬¦
printf &quot;%s\n&quot;,xxx	åŒä¸Š
æ‰“å°æ•°ç»„
å‘½ä»¤	ä½œç”¨
print *array@10	æ‰“å°ä»æ•°ç»„å¼€å¤´è¿ç»­ 10 ä¸ªå…ƒç´ çš„å€¼
print array[60]@10	æ‰“å° array æ•°ç»„ä¸‹æ ‡ä» 60 å¼€å§‹çš„ 10 ä¸ªå…ƒç´ ï¼Œå³ç¬¬ 60~69 ä¸ªå…ƒç´ 
set print array-indexes on	æ‰“å°æ•°ç»„å…ƒç´ æ—¶ï¼ŒåŒæ—¶æ‰“å°æ•°ç»„çš„ä¸‹æ ‡
æ‰“å°æŒ‡é’ˆ
å‘½ä»¤	ä½œç”¨
print ptr	æŸ¥çœ‹è¯¥æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹åŠæŒ‡é’ˆåœ°å€
print *(struct xxx *)ptr	æŸ¥çœ‹æŒ‡å‘çš„ç»“æ„ä½“çš„å†…å®¹
æ‰“å°æŒ‡å®šå†…å­˜åœ°å€çš„å€¼
ä½¿ç”¨xå‘½ä»¤æ¥æ‰“å°å†…å­˜çš„å€¼ï¼Œæ ¼å¼ä¸ºx/nfu addrï¼Œä»¥fæ ¼å¼æ‰“å°ä»addrå¼€å§‹çš„nä¸ªé•¿åº¦å•å…ƒä¸ºuçš„å†…å­˜å€¼ã€‚</p> <p>nï¼šè¾“å‡ºå•å…ƒçš„ä¸ªæ•°
fï¼šè¾“å‡ºæ ¼å¼ï¼Œå¦‚xè¡¨ç¤ºä»¥16è¿›åˆ¶è¾“å‡ºï¼Œoè¡¨ç¤ºä»¥8è¿›åˆ¶è¾“å‡ºï¼Œé»˜è®¤ä¸ºx
uï¼šä¸€ä¸ªå•å…ƒçš„é•¿åº¦ï¼Œbè¡¨ç¤º1ä¸ªbyteï¼Œhè¡¨ç¤º2ä¸ªbyteï¼ˆhalf wordï¼‰ï¼Œwè¡¨ç¤º4ä¸ªbyteï¼Œgè¡¨ç¤º8ä¸ªbyteï¼ˆgiant wordï¼‰
å‘½ä»¤	ä½œç”¨
x/8xb array	ä»¥ 16 è¿›åˆ¶æ‰“å°æ•°ç»„ array çš„å‰ 8 ä¸ª byte çš„å€¼
x/8xw array	ä»¥ 16 è¿›åˆ¶æ‰“å°æ•°ç»„ array çš„å‰ 16 ä¸ª word çš„å€¼
æ‰“å°å±€éƒ¨å˜é‡
å‘½ä»¤	ä½œç”¨
info locals	æ‰“å°å½“å‰å‡½æ•°å±€éƒ¨å˜é‡çš„å€¼
backtrace full	æ‰“å°å½“å‰æ ˆå¸§å„ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡å€¼ï¼Œå‘½ä»¤å¯ç¼©å†™ä¸º bt
bt full n	ä»å†…åˆ°å¤–æ˜¾ç¤º n ä¸ªæ ˆå¸§åŠå…¶å±€éƒ¨å˜é‡
bt full -n	ä»å¤–å‘å†…æ˜¾ç¤º n ä¸ªæ ˆå¸§åŠå…¶å±€éƒ¨å˜é‡
æ‰“å°ç»“æ„ä½“
å‘½ä»¤	ä½œç”¨
set print pretty on	æ¯è¡Œåªæ˜¾ç¤ºç»“æ„ä½“çš„ä¸€åæˆå‘˜
set print null-stop	ä¸æ˜¾ç¤º'\000'è¿™ç§
å‡½æ•°è·³è½¬
å‘½ä»¤	ä½œç”¨
set step-mode on	ä¸è·³è¿‡ä¸å«è°ƒè¯•ä¿¡æ¯çš„å‡½æ•°ï¼Œå¯ä»¥æ˜¾ç¤ºå’Œè°ƒè¯•æ±‡ç¼–ä»£ç 
finish	æ‰§è¡Œå®Œå½“å‰å‡½æ•°å¹¶æ‰“å°è¿”å›å€¼ï¼Œç„¶åè§¦å‘ä¸­æ–­
return 0	ä¸å†æ‰§è¡Œåé¢çš„æŒ‡ä»¤ï¼Œç›´æ¥è¿”å›ï¼Œå¯ä»¥æŒ‡å®šè¿”å›å€¼
call printf(&quot;%s\n&quot;, str)	è°ƒç”¨ printf å‡½æ•°ï¼Œæ‰“å°å­—ç¬¦ä¸² (å¯ä»¥ä½¿ç”¨ call æˆ–è€… print è°ƒç”¨å‡½æ•°)
print func()	è°ƒç”¨ func å‡½æ•° (å¯ä»¥ä½¿ç”¨ call æˆ–è€… print è°ƒç”¨å‡½æ•°)
set var variable=xxx	è®¾ç½®å˜é‡ variable çš„å€¼ä¸º xxx
set {type}address = xxx	ç»™å­˜å‚¨åœ°å€ä¸º addressï¼Œç±»å‹ä¸º type çš„å˜é‡èµ‹å€¼
info frame	æ˜¾ç¤ºå‡½æ•°å †æ ˆçš„ä¿¡æ¯ï¼ˆå †æ ˆå¸§åœ°å€ã€æŒ‡ä»¤å¯„å­˜å™¨çš„å€¼ç­‰ï¼‰
å…¶å®ƒ
å›¾å½¢åŒ–
tui ä¸ºterminal user interfaceçš„ç¼©å†™ï¼Œåœ¨å¯åŠ¨æ—¶å€™æŒ‡å®š-tuiå‚æ•°ï¼Œæˆ–è€…è°ƒè¯•æ—¶ä½¿ç”¨ctrl+x+aç»„åˆé”®ï¼Œå¯è¿›å…¥æˆ–é€€å‡ºå›¾å½¢åŒ–ç•Œé¢ã€‚</p> <p>å‘½ä»¤	å«ä¹‰
layout src	æ˜¾ç¤ºæºç çª—å£
layout asm	æ˜¾ç¤ºæ±‡ç¼–çª—å£
layout split	æ˜¾ç¤ºæºç  + æ±‡ç¼–çª—å£
layout regs	æ˜¾ç¤ºå¯„å­˜å™¨ + æºç æˆ–æ±‡ç¼–çª—å£
winheight src +5	æºç çª—å£é«˜åº¦å¢åŠ  5 è¡Œ
winheight asm -5	æ±‡ç¼–çª—å£é«˜åº¦å‡å° 5 è¡Œ
winheight cmd +5	æ§åˆ¶å°çª—å£é«˜åº¦å¢åŠ  5 è¡Œ
winheight regs -5	å¯„å­˜å™¨çª—å£é«˜åº¦å‡å° 5 è¡Œ
æ±‡ç¼–
å‘½ä»¤	å«ä¹‰
disassemble function	æŸ¥çœ‹å‡½æ•°çš„æ±‡ç¼–ä»£ç 
disassemble /mr function	åŒæ—¶æ¯”è¾ƒå‡½æ•°æºä»£ç å’Œæ±‡ç¼–ä»£ç 
è°ƒè¯•å’Œä¿å­˜ core æ–‡ä»¶
å‘½ä»¤	å«ä¹‰
file exec_file  *# *	åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·è¡¨ä¿¡æ¯
core core_file	åŠ è½½ core-dump æ–‡ä»¶
gcore core_file	ç”Ÿæˆ core-dump æ–‡ä»¶ï¼Œè®°å½•å½“å‰è¿›ç¨‹çš„çŠ¶æ€
å¯åŠ¨æ–¹å¼
ä½¿ç”¨ gdb è°ƒè¯•ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§å¯åŠ¨æ–¹å¼ï¼š</p> <p>gdb filename: è°ƒè¯•å¯æ‰§è¡Œç¨‹åº
gdb attach pid: é€šè¿‡â€ ç»‘å®š â€œè¿›ç¨‹ ID æ¥è°ƒè¯•æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹
gdb filename -c coredump_file: è°ƒè¯•å¯æ‰§è¡Œæ–‡ä»¶
åœ¨ä¸‹é¢çš„å‡ èŠ‚ä¸­ï¼Œå°†åˆ†åˆ«å¯¹ä¸Šè¿°å‡ ç§è°ƒè¯•æ–¹å¼è¿›è¡Œè®²è§£ï¼Œä»ä¾‹å­çš„è§’åº¦å‡ºå‘ï¼Œä½¿å¾—å¤§å®¶èƒ½å¤Ÿæ›´å¥½çš„æŒæ¡è°ƒè¯•æŠ€å·§ã€‚</p> <p>è°ƒè¯•
å¯æ‰§è¡Œæ–‡ä»¶
å•çº¿ç¨‹
é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€æ®µä»£ç ï¼š</p> <p>#include&lt;stdio.h&gt;</p> <p>void print(int xx, int *xxptr) {
printf(&quot;In print():\n&quot;);
printf(&quot;   xx is %d and is stored at %p.\n&quot;, xx, &amp;xx);
printf(&quot;   ptr points to %p which holds %d.\n&quot;, xxptr, *xxptr);
}</p> <p>int main(void) {
int x = 10;
int *ptr = &amp;x;
printf(&quot;In main():\n&quot;);
printf(&quot;   x is %d and is stored at %p.\n&quot;, x, &amp;x);
printf(&quot;   ptr points to %p which holds %d.\n&quot;, ptr, *ptr);
print(x, ptr);
return 0;
}</p> <p>è¿™ä¸ªä»£ç æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹è¿›å…¥è°ƒè¯•ï¼š</p> <p>gdb ./test_main
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <a href="http://gnu.org/licenses/gpl.html" target="_blank" rel="noopener noreferrer">http://gnu.org/licenses/gpl.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-redhat-linux-gnu&quot;.
For bug reporting instructions, please see:
<a href="http://www.gnu.org/software/gdb/bugs/" target="_blank" rel="noopener noreferrer">http://www.gnu.org/software/gdb/bugs/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>...
Reading symbols from /root/test_main...done.
(gdb) r
Starting program: /root/./test_main
In main():
x is 10 and is stored at 0x7fffffffe424.
ptr points to 0x7fffffffe424 which holds 10.
In print():
xx is 10 and is stored at 0x7fffffffe40c.
xxptr points to 0x7fffffffe424 which holds 10.
[Inferior 1 (process 31518) exited normally]
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64</p> <p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ gdb test å‘½ä»¤å¯åŠ¨è°ƒè¯•ï¼Œç„¶åé€šè¿‡æ‰§è¡Œ r(run å‘½ä»¤çš„ç¼©å†™) æ‰§è¡Œç¨‹åºï¼Œç›´è‡³é€€å‡ºï¼Œæ¢å¥è¯è¯´ï¼Œä¸Šè¿°å‘½ä»¤æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨ gdb è¿è¡Œå¯æ‰§è¡Œç¨‹åºçš„å®Œæ•´è¿‡ç¨‹ (åªä½¿ç”¨äº† r å‘½ä»¤)ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»¥æ­¤ä¸ºä¾‹å­ï¼Œä»‹ç»å‡ ç§æ¯”è¾ƒå¸¸è§çš„å‘½ä»¤ã€‚</p> <p>æ–­ç‚¹
(gdb) b 15
Breakpoint 1 at 0x400601: file test_main.cc, line 15.
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x0000000000400601 in main() at test_main.cc:15
(gdb) r
Starting program: /root/./test_main
In main():
x is 10 and is stored at 0x7fffffffe424.
ptr points to 0x7fffffffe424 which holds 10.</p> <p>Breakpoint 1, main () at test_main.cc:15
15   print(xx, xxptr);
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64
(gdb)</p> <p>backtrace
(gdb) backtrace
#0  main () at test_main.cc:15
(gdb)</p> <p>backtrace å‘½ä»¤æ˜¯åˆ—å‡ºå½“å‰å †æ ˆä¸­çš„æ‰€æœ‰å¸§ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ ˆä¸Šåªæœ‰ä¸€å¸§ï¼Œç¼–å·ä¸º 0ï¼Œå±äº main å‡½æ•°ã€‚</p> <p>(gdb) step
print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
4   printf(&quot;In print():\n&quot;);
(gdb)</p> <p>æ¥ç€ï¼Œæˆ‘ä»¬æ‰§è¡Œäº† step å‘½ä»¤ï¼Œå³è¿›å…¥å‡½æ•°å†…ã€‚ä¸‹é¢æˆ‘ä»¬ç»§ç»­é€šè¿‡ backtrace å‘½ä»¤æ¥æŸ¥çœ‹æ ˆå¸§ä¿¡æ¯ã€‚</p> <p>(gdb) backtrace
#0  print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
#1  0x0000000000400612 in main () at test_main.cc:15
(gdb)</p> <p>ä»ä¸Šé¢è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºï¼Œæœ‰ä¸¤ä¸ªæ ˆå¸§ï¼Œç¬¬ 1 å¸§å±äº main å‡½æ•°ï¼Œç¬¬ 0 å¸§å±äº print å‡½æ•°ã€‚</p> <p>æ¯ä¸ªæ ˆå¸§éƒ½åˆ—å‡ºäº†è¯¥å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œmain å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œè€Œ print å‡½æ•°æœ‰å‚æ•°ï¼Œå¹¶ä¸”æ˜¾ç¤ºäº†å…¶å‚æ•°çš„å€¼ã€‚</p> <p>æœ‰ä¸€ç‚¹æˆ‘ä»¬å¯èƒ½æ¯”è¾ƒè¿·æƒ‘ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œ backtrace çš„æ—¶å€™ï¼Œmain å‡½æ•°æ‰€åœ¨çš„æ ˆå¸§ç¼–å·ä¸º 0ï¼Œè€Œç¬¬äºŒæ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œmain å‡½æ•°çš„æ ˆå¸§ä¸º 1ï¼Œè€Œ print å‡½æ•°çš„æ ˆå¸§ä¸º 0ï¼Œè¿™æ˜¯å› ä¸º_ä¸æ ˆçš„å‘ä¸‹å¢é•¿_è§„å¾‹ä¸€è‡´ï¼Œæˆ‘ä»¬åªéœ€è¦è®°ä½_ç¼–å·æœ€å°å¸§å·å°±æ˜¯æœ€è¿‘ä¸€æ¬¡è°ƒç”¨çš„å‡½æ•°_ã€‚</p> <p>frame
æ ˆå¸§ç”¨æ¥å­˜å‚¨å‡½æ•°çš„å˜é‡å€¼ç­‰ä¿¡æ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒGDB æ€»æ˜¯ä½äºå½“å‰æ­£åœ¨æ‰§è¡Œå‡½æ•°å¯¹åº”æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­ã€‚</p> <p>åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œç”±äºå½“å‰æ­£åœ¨ print() å‡½æ•°ä¸­æ‰§è¡Œï¼ŒGDB ä½äºç¬¬ 0 å¸§çš„ä¸Šä¸‹æ–‡ä¸­ã€‚å¯ä»¥é€šè¿‡ frame å‘½ä»¤æ¥è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸Šä¸‹æ–‡æ‰€åœ¨çš„å¸§ã€‚</p> <p>(gdb) frame
#0  print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
4   printf(&quot;In print():\n&quot;);
(gdb)</p> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ print å‘½ä»¤æ‰“å°ä¸‹å½“å‰æ ˆå¸§çš„å€¼ï¼Œå¦‚ä¸‹ï¼š</p> <p>(gdb) print xx
$1 = 10
(gdb) print xxptr
$2 = (int *) 0x7fffffffe424
(gdb)</p> <p>å¦‚æœæˆ‘ä»¬æƒ³çœ‹å…¶ä»–æ ˆå¸§çš„å†…å®¹å‘¢ï¼Ÿæ¯”å¦‚ main å‡½æ•°ä¸­ x å’Œ ptr çš„ä¿¡æ¯å‘¢ï¼Ÿå‡å¦‚ç›´æ¥æ‰“å°è¿™ä¿©å€¼çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°å¦‚ä¸‹ï¼š</p> <p>(gdb) print x
No symbol &quot;x&quot; in current context.
(gdb) print xxptr
No symbol &quot;ptr&quot; in current context.
(gdb)</p> <p>åœ¨æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡_frame num_æ¥åˆ‡æ¢æ ˆå¸§ï¼Œå¦‚ä¸‹ï¼š</p> <p>(gdb) frame 1
#1  0x0000000000400612 in main () at test_main.cc:15
15   print(x, ptr);
(gdb) print x
$3 = 10
(gdb) print ptr
$4 = (int *) 0x7fffffffe424
(gdb)</p> <p>å¤šçº¿ç¨‹
ä¸ºäº†æ–¹ä¾¿è¿›è¡Œæ¼”ç¤ºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <p>#include <chrono>
#include <iostream>
#include <string>
#include <thread>
#include <vector></vector></thread></string></iostream></chrono></p> <p>int fun_int(int n) {
std::this_thread::sleep_for(std::chrono::seconds(10));
std::cout &lt;&lt; &quot;in fun_int n = &quot; &lt;&lt; n &lt;&lt; std::endl;</p> <p>return 0;
}</p> <p>int fun_string(const std::string &amp;s) {
std::this_thread::sleep_for(std::chrono::seconds(10));
std::cout &lt;&lt; &quot;in fun_string s = &quot; &lt;&lt; s &lt;&lt; std::endl;</p> <p>return 0;
}</p> <p>int main() {
std::vector<int> v;
v.emplace_back(1);
v.emplace_back(2);
v.emplace_back(3);</int></p> <p>std::cout &lt;&lt; v.size() &lt;&lt; std::endl;</p> <p>std::thread t1(fun_int, 1);
std::thread t2(fun_string, &quot;test&quot;);</p> <p>std::cout &lt;&lt; &quot;after thread create&quot; &lt;&lt; std::endl;
t1.join();
t2.join();
return 0;
}</p> <p>ä¸Šè¿°ä»£ç æ¯”è¾ƒç®€å•ï¼š</p> <p>å‡½æ•° fun_int çš„åŠŸèƒ½æ˜¯ä¼‘çœ  10sï¼Œç„¶åæ‰“å°å…¶å‚æ•°
å‡½æ•° fun_string åŠŸèƒ½æ˜¯ä¼‘çœ  10sï¼Œç„¶åæ‰“å°å…¶å‚æ•°
main å‡½æ•°ä¸­ï¼Œåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«æ‰§è¡Œä¸Šè¿°ä¸¤ä¸ªå‡½æ•°
ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„è°ƒè¯•è¿‡ç¨‹ï¼š</p> <p>(gdb) b 27
Breakpoint 1 at 0x4013d5: file test.cc, line 27.
(gdb) b test.cc:32
Breakpoint 2 at 0x40142d: file test.cc, line 32.
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00000000004013d5 in main() at test.cc:27
2       breakpoint     keep y   0x000000000040142d in main() at test.cc:32
(gdb) r
Starting program: /root/test
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib64/libthread_db.so.1&quot;.</p> <p>Breakpoint 1, main () at test.cc:27
(gdb) c
Continuing.
3
[New Thread 0x7ffff6fd2700 (LWP 44996)]
in fun_int n = 1
[New Thread 0x7ffff67d1700 (LWP 44997)]</p> <p>Breakpoint 2, main () at test.cc:32
32   std::cout &lt;&lt; &quot;after thread create&quot; &lt;&lt; std::endl;
(gdb) info threads
Id   Target Id         Frame
3    Thread 0x7ffff67d1700 (LWP 44997) &quot;test&quot; 0x00007ffff7051fc3 in new_heap () from /lib64/libc.so.6
2    Thread 0x7ffff6fd2700 (LWP 44996) &quot;test&quot; 0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6</p> <ul><li>1    Thread 0x7ffff7fe7740 (LWP 44987) &quot;test&quot; main () at test.cc:32
(gdb) thread 2
[Switching to thread 2 (Thread 0x7ffff6fd2700 (LWP 44996))]
#0  0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6
(gdb) bt
#0  0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6
#1  0x00007ffff7097cc4 in sleep () from /lib64/libc.so.6
#2  0x00007ffff796ceb9 in std::this_thread::__sleep_for(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt;, std::chrono::duration&lt;long, std::ratio&lt;1l, 1000000000l&gt; &gt;) () from /lib64/libstdc++.so.6
#3  0x00000000004018cc in std::this_thread::sleep_for&lt;long, std::ratio&lt;1l, 1l&gt; &gt; (__rtime=...) at /usr/include/c++/4.8.2/thread:281
#4  0x0000000000401307 in fun_int (n=1) at test.cc:9
#5  0x0000000000404696 in std::_Bind_simple&lt;int (<em>(int))(int)&gt;::_M_invoke&lt;0ul&gt;(std::_Index_tuple&lt;0ul&gt;) (this=0x609080)
at /usr/include/c++/4.8.2/functional:1732
#6  0x000000000040443d in std::_Bind_simple&lt;int (</em>(int))(int)&gt;::operator()() (this=0x609080) at /usr/include/c++/4.8.2/functional:1720
#7  0x000000000040436e in std::thread::_Impl&lt;std::_Bind_simple&lt;int (*(int))(int)&gt; &gt;::_M_run() (this=0x609068) at /usr/include/c++/4.8.2/thread:115
#8  0x00007ffff796d070 in ?? () from /lib64/libstdc++.so.6
#9  0x00007ffff7bc6dd5 in start_thread () from /lib64/libpthread.so.0
#10 0x00007ffff70d0ead in clone () from /lib64/libc.so.6
(gdb) c
Continuing.
after thread create
in fun_int n = 1
[Thread 0x7ffff6fd2700 (LWP 45234) exited]
in fun_string s = test
[Thread 0x7ffff67d1700 (LWP 45235) exited]
[Inferior 1 (process 45230) exited normally]
(gdb) q</li></ul> <p>åœ¨ä¸Šè¿°è°ƒè¯•è¿‡ç¨‹ä¸­ï¼š</p> <p>b 27 åœ¨ç¬¬ 27 è¡ŒåŠ ä¸Šæ–­ç‚¹</p> <p>b test.cc:32 åœ¨ç¬¬ 32 è¡ŒåŠ ä¸Šæ–­ç‚¹ (æ•ˆæœä¸ b 32 ä¸€è‡´)</p> <p>info b è¾“å‡ºæ‰€æœ‰çš„æ–­ç‚¹ä¿¡æ¯</p> <p>r ç¨‹åºå¼€å§‹è¿è¡Œï¼Œå¹¶åœ¨ç¬¬ä¸€ä¸ªæ–­ç‚¹å¤„æš‚åœ</p> <p>c æ‰§è¡Œ c å‘½ä»¤ï¼Œåœ¨ç¬¬äºŒä¸ªæ–­ç‚¹å¤„æš‚åœï¼Œåœ¨ç¬¬ä¸€ä¸ªæ–­ç‚¹å’Œç¬¬äºŒä¸ªæ–­ç‚¹ä¹‹é—´ï¼Œåˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ t1 å’Œ t2</p> <p>info threads è¾“å‡ºæ‰€æœ‰çš„çº¿ç¨‹ä¿¡æ¯ï¼Œä»è¾“å‡ºä¸Šå¯ä»¥çœ‹å‡ºï¼Œæ€»å…±æœ‰ 3 ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«ä¸º main çº¿ç¨‹ã€t1 å’Œ t2</p> <p>thread 2 åˆ‡æ¢è‡³çº¿ç¨‹ 2</p> <p>bt è¾“å‡ºçº¿ç¨‹ 2 çš„å †æ ˆä¿¡æ¯</p> <p>c ç›´è‡³ç¨‹åºç»“æŸ</p> <p>q é€€å‡º gdb</p> <p>å¤šè¿›ç¨‹
åŒä¸Šé¢ä¸€æ ·ï¼Œæˆ‘ä»¬ä»ç„¶ä»¥ä¸€ä¸ªä¾‹å­è¿›è¡Œæ¨¡æ‹Ÿå¤šè¿›ç¨‹è°ƒè¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <p>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;</p> <p>int main()
{
pid_t pid = fork();
if (pid == -1) {
perror(&quot;fork error\n&quot;);
return -1;
}</p> <div class="language- extra-class"><pre><code>if(pid == 0) { // å­è¿›ç¨‹
    int num = 1;
    while(num == 1){
      sleep(10);
     }
    printf(&quot;this is child,pid = %d\n&quot;, getpid());
} else { // çˆ¶è¿›ç¨‹
    printf(&quot;this is parent,pid = %d\n&quot;, getpid());
  wait(NULL); // ç­‰å¾…å­è¿›ç¨‹é€€å‡º
}
return 0;
</code></pre></div><p>}</p> <p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼ŒåŒ…å«ä¸¤ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯çˆ¶è¿›ç¨‹ (ä¹Ÿå°±æ˜¯ main è¿›ç¨‹)ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ç”± fork() å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ã€‚</p> <p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å¤šè¿›ç¨‹ç¨‹åºä¸­ï¼ŒGDB åªè°ƒè¯• main è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºç¨‹åºè°ƒç”¨äº†å¤šå°‘æ¬¡ fork()å‡½æ•°åˆ›å»ºäº†å¤šå°‘ä¸ªå­è¿›ç¨‹ï¼ŒGDB åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªè°ƒè¯•çˆ¶è¿›ç¨‹ã€‚ä¸ºäº†æ”¯æŒå¤šè¿›ç¨‹è°ƒè¯•ï¼Œä» GDB ç‰ˆæœ¬ 7.0 å¼€å§‹æ”¯æŒå•ç‹¬è°ƒè¯• (è°ƒè¯•çˆ¶è¿›ç¨‹æˆ–è€…å­è¿›ç¨‹) å’ŒåŒæ—¶è°ƒè¯•å¤šä¸ªè¿›ç¨‹ã€‚</p> <p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è°ƒè¯•å­è¿›ç¨‹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‡ ç§æ–¹å¼è¿›è¡Œå­è¿›ç¨‹è°ƒè¯•ã€‚</p> <p>attach
é¦–å…ˆï¼Œæ— è®ºæ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ï¼Œéƒ½å¯ä»¥é€šè¿‡ attach å‘½ä»¤å¯åŠ¨ gdb è¿›è¡Œè°ƒè¯•ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äºæ¯ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿéƒ½ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªå”¯ä¸€ ID å·ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹ IDã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“äº†è¿›ç¨‹ IDï¼Œå°±å¯ä»¥ä½¿ç”¨ attach å‘½ä»¤å¯¹å…¶è¿›è¡Œè°ƒè¯•äº†ã€‚</p> <p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œfork() å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹å†…éƒ¨ï¼Œé¦–å…ˆä¼šè¿›å…¥ while å¾ªç¯ sleepï¼Œç„¶ååœ¨ while å¾ªç¯ä¹‹åè°ƒç”¨ printf å‡½æ•°ã€‚è¿™æ ·åšçš„ç›®çš„æœ‰å¦‚ä¸‹ï¼š</p> <p>å¸®åŠ© attach æ•è·è¦è°ƒè¯•çš„è¿›ç¨‹ id
åœ¨ä½¿ç”¨ gdb è¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼ŒçœŸæ­£çš„ä»£ç  (å³ print å‡½æ•°) æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥ä»å¤´å¼€å§‹å¯¹å­è¿›ç¨‹è¿›è¡Œè°ƒè¯•
â
å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼Œä¸Šé¢ä»£ç ä»¥åŠè¿›å…¥ while å¾ªç¯ï¼Œæ— è®ºå¦‚ä½•æ˜¯ä¸ä¼šæ‰§è¡Œåˆ°ä¸‹é¢ printf å‡½æ•°ã€‚å…¶å®ï¼Œè¿™å°±æ˜¯ gdb çš„å‰å®³ä¹‹å¤„ï¼Œå¯ä»¥é€šè¿‡ gdb å‘½ä»¤ä¿®æ”¹ num çš„å€¼ï¼Œä»¥ä¾¿å…¶è·³å‡º while å¾ªç¯</p> <p>â
ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ test_process</p> <p>g++ -g test_process.cc -o test_process</p> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹å°è¯•å¯åŠ¨è°ƒè¯•ã€‚</p> <p>gdb -q ./test_process
Reading symbols from /root/test_process...done.
(gdb)</p> <p>è¿™é‡Œéœ€è¦è¯´æ˜ä¸‹ï¼Œä¹‹æ‰€ä»¥åŠ  - q é€‰é¡¹ï¼Œæ˜¯æƒ³å»æ‰å…¶ä»–ä¸å¿…è¦çš„è¾“å‡ºï¼Œq ä¸º quite çš„ç¼©å†™ã€‚</p> <p>(gdb) r
Starting program: /root/./test_process
Detaching after fork from child process 37482.
this is parent,pid = 37478
[Inferior 1 (process 37478) exited normally]
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
(gdb) attach 37482
//ç¬¦å·ç±»è¾“å‡ºï¼Œæ­¤å¤„ç•¥å»
(gdb) n
Single stepping until exit from function __nanosleep_nocancel,
which has no line number information.
0x00007ffff72b3cc4 in sleep () from /lib64/libc.so.6
(gdb)
Single stepping until exit from function sleep,
which has no line number information.
main () at test_process.cc:8
8       while(num==10){
(gdb)</p> <p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œäº† n(next çš„ç¼©å†™)ï¼Œä½¿å…¶é‡æ–°å¯¹ while å¾ªç¯çš„åˆ¤æ–­ä½“è¿›è¡Œåˆ¤æ–­ã€‚</p> <p>(gdb) set num = 1
(gdb) n
12       printf(&quot;this is child,pid = %d\n&quot;,getpid());
(gdb) c
Continuing.
this is child,pid = 37482
[Inferior 1 (process 37482) exited normally]
(gdb)</p> <p>ä¸ºäº†é€€å‡º while å¾ªç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ set å‘½ä»¤è®¾ç½®äº† num çš„å€¼ä¸º 1ï¼Œè¿™æ ·æ¡ä»¶å°±ä¼šå¤±æ•ˆé€€å‡º while å¾ªç¯ï¼Œè¿›è€Œæ‰§è¡Œä¸‹é¢çš„ printf() å‡½æ•°ï¼›åœ¨æœ€åæˆ‘ä»¬æ‰§è¡Œäº† c(continue çš„ç¼©å†™) å‘½ä»¤ï¼Œæ”¯æŒç¨‹åºé€€å‡ºã€‚</p> <p>â
å¦‚æœç¨‹åºæ­£åœ¨æ­£å¸¸è¿è¡Œï¼Œå‡ºç°äº†æ­»é”ç­‰ç°è±¡ï¼Œåˆ™å¯ä»¥é€šè¿‡ ps è·å–è¿›ç¨‹ IDï¼Œç„¶åæ ¹æ® gdb attach pid è¿›è¡Œç»‘å®šï¼Œè¿›è€ŒæŸ¥çœ‹å †æ ˆä¿¡æ¯</p> <p>â
æŒ‡å®šè¿›ç¨‹
é»˜è®¤æƒ…å†µä¸‹ï¼ŒGDB è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºæ—¶å€™ï¼Œåªè°ƒè¯•çˆ¶è¿›ç¨‹ã€‚GDB æä¾›äº†ä¸¤ä¸ªå‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡ follow-fork-mode å’Œ detach-on-fork æ¥æŒ‡å®šè°ƒè¯•çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ã€‚</p> <p>follow-fork-mode
è¯¥å‘½ä»¤çš„ä½¿ç”¨æ–¹å¼ä¸ºï¼š</p> <p>(gdb) set follow-fork-mode mode</p> <p>å…¶ä¸­ï¼Œmode æœ‰ä»¥ä¸‹ä¸¤ä¸ªé€‰é¡¹ï¼š</p> <p>parent: çˆ¶è¿›ç¨‹ï¼Œmode çš„é»˜è®¤é€‰é¡¹
child: å­è¿›ç¨‹ï¼Œå…¶ç›®çš„æ˜¯å‘Šè¯‰ gdb åœ¨ç›®æ ‡åº”ç”¨è°ƒç”¨ fork ä¹‹åæ¥ç€è°ƒè¯•å­è¿›ç¨‹è€Œä¸æ˜¯çˆ¶è¿›ç¨‹ï¼Œå› ä¸ºåœ¨ Linux ç³»ç»Ÿä¸­ fork() ç³»ç»Ÿè°ƒç”¨æˆåŠŸä¼šè¿”å›ä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ï¼Œä¸€æ¬¡åœ¨å­è¿›ç¨‹
(gdb) show follow-fork-mode
Debugger response to a program call of fork or vfork is &quot;parent&quot;.
(gdb) set follow-fork-mode child
(gdb) r
Starting program: /root/./test_process
[New process 37830]
this is parent,pid = 37826</p> <p>^C
Program received signal SIGINT, Interrupt.
[Switching to process 37830]
0x00007ffff72b3e10 in __nanosleep_nocancel () from /lib64/libc.so.6
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
(gdb) n
Single stepping until exit from function __nanosleep_nocancel,
which has no line number information.
0x00007ffff72b3cc4 in sleep () from /lib64/libc.so.6
(gdb) n
Single stepping until exit from function sleep,
which has no line number information.
main () at test_process.cc:8
8       while(num==10){
(gdb) show follow-fork-mode
Debugger response to a program call of fork or vfork is &quot;child&quot;.
(gdb)</p> <p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬åšäº†å¦‚ä¸‹æ“ä½œï¼š</p> <p>show follow-fork-mode: é€šè¿‡è¯¥å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰å¤„äºä»€ä¹ˆæ¨¡å¼ä¸‹ï¼Œé€šè¿‡è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œå¤„äº parent å³çˆ¶è¿›ç¨‹æ¨¡å¼
set follow-fork-mode child: æŒ‡å®šè°ƒè¯•å­è¿›ç¨‹æ¨¡å¼
r: è¿è¡Œç¨‹åºï¼Œç›´æ¥è¿è¡Œç¨‹åºï¼Œæ­¤æ—¶ä¼šè¿›å…¥å­è¿›ç¨‹ï¼Œç„¶åæ‰§è¡Œ while å¾ªç¯
ctrl + c: é€šè¿‡è¯¥å‘½ä»¤ï¼Œå¯ä»¥ä½¿å¾— GDB æ”¶åˆ° SIGINT å‘½ä»¤ï¼Œä»è€Œæš‚åœæ‰§è¡Œ while å¾ªç¯
n(next): ç»§ç»­æ‰§è¡Œï¼Œè¿›è€Œè¿›å…¥åˆ° while å¾ªç¯çš„æ¡ä»¶åˆ¤æ–­å¤„
show follow-fork-mode: å†æ¬¡æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œé€šè¿‡è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œå½“å‰å¤„äº child æ¨¡å¼ä¸‹
detach-on-fork
å¦‚æœä¸€å¼€å§‹æŒ‡å®šè¦è°ƒè¯•å­è¿›ç¨‹è¿˜æ˜¯çˆ¶è¿›ç¨‹ï¼Œé‚£ä¹ˆä½¿ç”¨ follow-fork-mode å‘½ä»¤å®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚; ä½†æ˜¯å¦‚æœæƒ³åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæƒ³æ ¹æ®å®é™…æƒ…å†µåœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢è°ƒè¯•å‘¢ï¼Ÿ</p> <p>GDB æä¾›äº†å¦å¤–ä¸€ä¸ªå‘½ä»¤ï¼š</p> <p>(gdb) set detach-on-fork mode</p> <p>å…¶ä¸­ mode æœ‰å¦‚ä¸‹ä¸¤ä¸ªå€¼ï¼š</p> <p>on: é»˜è®¤å€¼ï¼Œå³è¡¨æ˜åªè°ƒè¯•ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥æ˜¯å­è¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯çˆ¶è¿›ç¨‹</p> <p>off: ç¨‹åºä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«è®°å½•ï¼Œè¿›è€Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰çš„è¿›ç¨‹è¿›è¡Œè°ƒè¯•</p> <p>å¦‚æœé€‰æ‹©å…³é—­detach-on-forkæ¨¡å¼ (mode ä¸º off)ï¼Œé‚£ä¹ˆ GDB å°†ä¿ç•™å¯¹æ‰€æœ‰è¢« fork å‡ºæ¥çš„è¿›ç¨‹æ§åˆ¶ï¼Œå³å¯ç”¨è°ƒè¯•æ‰€æœ‰è¢« fork å‡ºæ¥çš„è¿›ç¨‹ã€‚å¯ç”¨ ä½¿ç”¨info forkså‘½ä»¤åˆ—å‡ºæ‰€æœ‰çš„å¯è¢« GDB è°ƒè¯•çš„ fork è¿›ç¨‹ï¼Œå¹¶å¯ç”¨ä½¿ç”¨ fork å‘½ä»¤ä»ä¸€ä¸ª fork è¿›ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ª fork è¿›ç¨‹ã€‚</p> <p>info forks: æ‰“å° DGB æ§åˆ¶ä¸‹çš„æ‰€æœ‰è¢« fork å‡ºæ¥çš„è¿›ç¨‹åˆ—è¡¨ã€‚è¯¥åˆ—è¡¨åŒ…æ‹¬ fork idã€è¿›ç¨‹ id å’Œå½“å‰è¿›ç¨‹çš„ä½ç½®
fork fork-id: å‚æ•° fork-id æ˜¯ GDB åˆ†é…çš„å†…éƒ¨ fork ç¼–å·ï¼Œè¯¥ç¼–å·å¯ç”¨é€šè¿‡ä¸Šé¢çš„å‘½ä»¤info forksè·å–
coredump
å½“æˆ‘ä»¬å¼€å‘æˆ–è€…ä½¿ç”¨ä¸€ä¸ªç¨‹åºæ—¶å€™ï¼Œæœ€æ€•çš„è«è¿‡äºç¨‹åºè«åå…¶å¦™å´©æºƒã€‚ä¸ºäº†åˆ†æå´©æºƒäº§ç”Ÿçš„åŸå› ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜å†…å®¹ï¼ˆåŒ…æ‹¬ç¨‹åºå´©æºƒæ—¶å€™çš„å †æ ˆç­‰ä¿¡æ¯ï¼‰ä¼šåœ¨ç¨‹åºå´©æºƒçš„æ—¶å€™ dump å‡ºæ¥ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶åä¸º core.pidï¼Œå…¶ä¸­ pid ä¸ºè¿›ç¨‹ idï¼‰ï¼Œè¿™ä¸ª dump æ“ä½œå«åš coredump(æ ¸å¿ƒè½¬å‚¨)ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç”¨è°ƒè¯•å™¨è°ƒè¯•æ­¤æ–‡ä»¶ï¼Œä»¥è¿˜åŸç¨‹åºå´©æºƒæ—¶å€™çš„åœºæ™¯ã€‚</p> <p>åœ¨æˆ‘ä»¬åˆ†æå¦‚æœç”¨ gdb è°ƒè¯• coredump æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆéœ€è¦ç”Ÿæˆä¸€ä¸ª coredumpï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°±ç”¨å¦‚ä¸‹ä¾‹å­æ¥ç”Ÿæˆï¼š</p> <p>#include &lt;stdio.h&gt;</p> <p>void print(int *v, int size) {
for (int i = 0; i &lt; size; ++i) {
printf(&quot;elem[%d] = %d\n&quot;, i, v[i]);
}
}</p> <p>int main() {
int v[] = {0, 1, 2, 3, 4};
print(v, 1000);
return 0;
}</p> <p>ç¼–è¯‘å¹¶è¿è¡Œè¯¥ç¨‹åºï¼š</p> <p>g++ -g test_core.cc -o test_core
./test_core</p> <p>è¾“å‡ºå¦‚ä¸‹ï¼š</p> <p>elem[775] = 1702113070
elem[776] = 1667200115
elem[777] = 6648431
elem[778] = 0
elem[779] = 0
æ®µé”™è¯¯(åæ ¸)</p> <p>å¦‚æˆ‘ä»¬é¢„æœŸï¼Œç¨‹åºäº§ç”Ÿäº†å¼‚å¸¸ï¼Œä½†æ˜¯å´æ²¡æœ‰ç”Ÿæˆ coredump æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç³»ç»Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œcoredump ç”Ÿæˆæ˜¯å…³é—­çš„ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®å¯¹åº”çš„é€‰é¡¹ä»¥æ‰“å¼€ coredump ç”Ÿæˆã€‚</p> <p>é’ˆå¯¹å¤šçº¿ç¨‹ç¨‹åºäº§ç”Ÿçš„ coredumpï¼Œæœ‰æ—¶å€™å…¶å †æ ˆä¿¡æ¯å¹¶ä¸èƒ½å®Œæ•´çš„å»åˆ†æåŸå› ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬å¾—æœ‰å…¶ä»–æ–¹å¼ã€‚</p> <p>18 å¹´æœ‰ä¸€æ¬¡çº¿ä¸Šæ•…éšœï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯åœ¨çº¿ä¸Šçš„æ—¶å€™ï¼Œå°±ä¼š coredumpï¼Œæ ¹æ® gdb è°ƒè¯• coredumpï¼Œåªèƒ½å®šä½åˆ°äº† libcurl é‡Œé¢ï¼Œä½†å´å®šä½ä¸å‡ºåŸå› ï¼Œç”¨äº†å¤§æ¦‚ä¸¤å¤©çš„æ—¶é—´ï¼Œå‘ç°åªæœ‰åœ¨è¶…æ—¶çš„æ—¶å€™ï¼Œæ‰ä¼š coredumpï¼Œè€Œæµ‹è¯•ç¯å¢ƒå› ä¸ºé…ç½®æ¯”è¾ƒå·®è¶…æ—¶è®¾ç½®çš„æ˜¯ 20msï¼Œè€Œçº¿ä¸Šæ˜¯ 5msï¼ŒçŸ¥é“ coredump åŸå› åï¼Œé‡‡ç”¨é€æ­¥å®šä½ç¼©å°èŒƒå›´æ³•ï¼Œé€æ­¥ç¼©å°ä»£ç èŒƒå›´ï¼Œæœ€ç»ˆå®šä½åˆ°æ˜¯ libcurl ä¸€ä¸ª bug å¯¼è‡´ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œå®šä½çº¿ä¸Šé—®é¢˜éœ€è¦ç»“åˆå®é™…æƒ…å†µï¼Œé‡‡å–åˆé€‚çš„æ–¹æ³•æ¥å®šä½é—®é¢˜ã€‚</p> <p>é…ç½®
é…ç½® coredump ç”Ÿæˆï¼Œæœ‰ä¸´æ—¶é…ç½® (é€€å‡ºç»ˆç«¯åï¼Œé…ç½®å¤±æ•ˆ) å’Œæ°¸ä¹…é…ç½®ä¸¤ç§ã€‚</p> <p>ä¸´æ—¶
é€šè¿‡ulimit -aå¯ä»¥åˆ¤æ–­å½“å‰æœ‰æ²¡æœ‰é…ç½® coredump ç”Ÿæˆï¼š</p> <p>ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0</p> <p>ä»ä¸Šé¢è¾“å‡ºå¯ä»¥çœ‹å‡º core file size åé¢çš„æ•°ä¸º 0ï¼Œå³ä¸ç”Ÿæˆ coredump æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œè®¾ç½®</p> <p>ulimit -c size</p> <p>å…¶ä¸­ size ä¸ºå…è®¸ç”Ÿæˆçš„ coredump å¤§å°ï¼Œè¿™ä¸ªä¸€èˆ¬å°½é‡è®¾ç½®å¤§ç‚¹ï¼Œä»¥é˜²æ­¢ç”Ÿæˆçš„ coredump ä¿¡æ¯ä¸å…¨ï¼Œç¬”è€…ä¸€èˆ¬è®¾ç½®ä¸ºä¸é™ã€‚</p> <p>ulimit -c unlimited</p> <p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¸´æ—¶é…ç½®çš„ coredump é€‰é¡¹ï¼Œå…¶é»˜è®¤ç”Ÿæˆè·¯å¾„ä¸ºæ‰§è¡Œè¯¥å‘½ä»¤æ—¶å€™çš„è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ¥è¿›è¡Œè·¯å¾„ä¿®æ”¹ã€‚</p> <p>æ°¸ä¹…
ä¸Šé¢çš„è®¾ç½®åªæ˜¯ä½¿èƒ½äº† core dump åŠŸèƒ½ï¼Œç¼ºçœæƒ…å†µä¸‹ï¼Œå†…æ ¸åœ¨ coredump æ—¶æ‰€äº§ç”Ÿçš„ core æ–‡ä»¶æ”¾åœ¨ä¸è¯¥ç¨‹åºç›¸åŒçš„ç›®å½•ä¸­ï¼Œå¹¶ä¸”æ–‡ä»¶åå›ºå®šä¸º coreã€‚å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæœ‰å¤šä¸ªç¨‹åºäº§ç”Ÿ core æ–‡ä»¶ï¼Œæˆ–è€…åŒä¸€ä¸ªç¨‹åºå¤šæ¬¡å´©æºƒï¼Œå°±ä¼šé‡å¤è¦†ç›–åŒä¸€ä¸ª core æ–‡ä»¶ã€‚</p> <p>è¿‡ä¿®æ”¹ kernel çš„å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå†…æ ¸æ‰€ç”Ÿæˆçš„ coredump æ–‡ä»¶çš„æ–‡ä»¶åã€‚ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå¯ä»¥å®ç° coredump æ°¸ä¹…é…ç½®ã€å­˜æ”¾è·¯å¾„ä»¥åŠç”Ÿæˆ coredump åç§°ç­‰ã€‚</p> <p>mkdir -p /www/coredump/
chmod 777 /www/coredump/</p> <p>/etc/profile
ulimit -c unlimited</p> <p>/etc/security/limits.conf</p> <ul><li><div class="language- extra-class"><pre><code>     soft     core   unlimited
</code></pre></div></li></ul> <p>echo &quot;/www/coredump/core-%e-%p-%h-%t&quot; &gt; /proc/sys/kernel/core_pattern</p> <p>è°ƒè¯•
ç°åœ¨ï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŒ‰ç…§é¢„æœŸäº§ç”Ÿ coredump æ–‡ä»¶ï¼š</p> <p>./test_coredump</p> <p>elem[955] = 1702113070
elem[956] = 1667200115
elem[957] = 6648431
elem[958] = 0
elem[959] = 0
æ®µé”™è¯¯(åæ ¸)</p> <p>ç„¶åä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œ coredump è°ƒè¯•ï¼š</p> <p>gdb ./test_core -c /www/coredump/core_test_core_1640765384_38924 -q</p> <p>è¾“å‡ºå¦‚ä¸‹ï¼š</p> <p>#0  0x0000000000400569 in print (v=0x7fff3293c100, size=1000) at test_core.cc:5
5     printf(&quot;elem[%d] = %d\n&quot;, i, v[i]);
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
(gdb)</p> <p>å¯ä»¥çœ‹å‡ºï¼Œç¨‹åº core åœ¨äº†ç¬¬ 5 è¡Œï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡whereå‘½ä»¤æ¥æŸ¥çœ‹å †æ ˆå›æº¯ä¿¡æ¯ã€‚</p> <p>â
åœ¨ gdb ä¸­è¾“å…¥ where å‘½ä»¤ï¼Œå¯ä»¥è·å–å †æ ˆè°ƒç”¨ä¿¡æ¯ã€‚å½“è¿›è¡Œ coredump è°ƒè¯•æ—¶å€™ï¼Œè¿™ä¸ªæ˜¯æœ€åŸºæœ¬ä¸”æœ€æœ‰ç”¨å¤„çš„å‘½ä»¤ã€‚where å‘½ä»¤è¾“å‡ºçš„ç»“æœåŒ…å«ç¨‹åºä¸­ çš„å‡½æ•°åç§°å’Œç›¸å…³å‚æ•°å€¼ã€‚</p> <p>â
é€šè¿‡ where å‘½ä»¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ç¨‹åº core åœ¨äº†ç¬¬ 5 è¡Œï¼Œé‚£ä¹ˆæ ¹æ®åˆ†ææºç åŸºæœ¬å°±èƒ½å®šä½åŸå› ã€‚</p> <p>â
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œcore ä¸ä¸€å®šåœ¨å½“å‰çº¿ç¨‹ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å¯¹ä»£ç æœ‰ä¸€å®šçš„äº†è§£ï¼Œèƒ½å¤Ÿä¿è¯å“ªå—ä»£ç æ˜¯å®‰å…¨çš„ï¼Œç„¶åé€šè¿‡ thread num åˆ‡æ¢çº¿ç¨‹ï¼Œç„¶åå†é€šè¿‡ bt æˆ–è€… where å‘½ä»¤æŸ¥çœ‹å †æ ˆä¿¡æ¯ï¼Œè¿›è€Œå®šä½ coredump åŸå› ã€‚</p> <p>â
åŸç†
åœ¨å‰é¢å‡ èŠ‚ï¼Œæˆ‘ä»¬è®²äº† gdb çš„å‘½ä»¤ï¼Œä»¥åŠè¿™äº›å‘½ä»¤åœ¨è°ƒè¯•æ—¶å€™çš„ä½œç”¨ï¼Œå¹¶ä»¥ä¾‹å­è¿›è¡Œäº†æ¼”ç¤ºã€‚ä½œä¸º C/C++ coderï¼Œè¦çŸ¥å…¶ç„¶ï¼Œæ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚æ‰€ä»¥ï¼Œå€ŸåŠ©æœ¬èŠ‚ï¼Œæˆ‘ä»¬å¤§æ¦‚è®²ä¸‹ GDB è°ƒè¯•çš„åŸç†ã€‚</p> <p>gdb é€šè¿‡ç³»ç»Ÿè°ƒç”¨ ptrace æ¥æ¥ç®¡ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œã€‚ptrace ç³»ç»Ÿè°ƒç”¨æä¾›äº†ä¸€ç§æ–¹æ³•ä½¿å¾—çˆ¶è¿›ç¨‹å¯ä»¥è§‚å¯Ÿå’Œæ§åˆ¶å…¶å®ƒè¿›ç¨‹çš„æ‰§è¡Œï¼Œæ£€æŸ¥å’Œæ”¹å˜å…¶æ ¸å¿ƒæ˜ åƒä»¥åŠå¯„å­˜å™¨ã€‚å®ƒä¸»è¦ç”¨æ¥å®ç°æ–­ç‚¹è°ƒè¯•å’Œç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªã€‚</p> <p>ptrace ç³»ç»Ÿè°ƒç”¨å®šä¹‰å¦‚ä¸‹ï¼š</p> <p>#include &lt;sys/ptrace.h&gt;
long ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data)</p> <p>pid_t pidï¼šæŒ‡ç¤º ptrace è¦è·Ÿè¸ªçš„è¿›ç¨‹
void *addrï¼šæŒ‡ç¤ºè¦ç›‘æ§çš„å†…å­˜åœ°å€
enum __ptrace_request requestï¼šå†³å®šäº†ç³»ç»Ÿè°ƒç”¨çš„åŠŸèƒ½ï¼Œå‡ ä¸ªä¸»è¦çš„é€‰é¡¹ï¼š
PTRACE_TRACEMEï¼šè¡¨ç¤ºæ­¤è¿›ç¨‹å°†è¢«çˆ¶è¿›ç¨‹è·Ÿè¸ªï¼Œä»»ä½•ä¿¡å·ï¼ˆé™¤äº† SIGKILLï¼‰éƒ½ä¼šæš‚åœå­è¿›ç¨‹ï¼Œæ¥ç€é˜»å¡äº wait() ç­‰å¾…çš„çˆ¶è¿›ç¨‹è¢«å”¤é†’ã€‚å­è¿›ç¨‹å†…éƒ¨å¯¹ exec() çš„è°ƒç”¨å°†å‘å‡º SIGTRAP ä¿¡å·ï¼Œè¿™å¯ä»¥è®©çˆ¶è¿›ç¨‹åœ¨å­è¿›ç¨‹æ–°ç¨‹åºå¼€å§‹è¿è¡Œä¹‹å‰å°±å®Œå…¨æ§åˆ¶å®ƒ
PTRACE_ATTACHï¼šattach åˆ°ä¸€ä¸ªæŒ‡å®šçš„è¿›ç¨‹ï¼Œä½¿å…¶æˆä¸ºå½“å‰è¿›ç¨‹è·Ÿè¸ªçš„å­è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹çš„è¡Œä¸ºç­‰åŒäºå®ƒè¿›è¡Œäº†ä¸€æ¬¡ PTRACE_TRACEME æ“ä½œã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å½“å‰è¿›ç¨‹æˆä¸ºè¢«è·Ÿè¸ªè¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼Œä½†æ˜¯å­è¿›ç¨‹ä½¿ç”¨ getppid() çš„åˆ°çš„ä»å°†æ˜¯å…¶åŸå§‹çˆ¶è¿›ç¨‹çš„ pid
PTRACE_CONTï¼šç»§ç»­è¿è¡Œä¹‹å‰åœæ­¢çš„å­è¿›ç¨‹ã€‚å¯åŒæ—¶å‘å­è¿›ç¨‹äº¤ä»˜æŒ‡å®šçš„ä¿¡å·
è°ƒè¯•åŸç†
è¿è¡Œå¹¶è°ƒè¯•æ–°è¿›ç¨‹
è¿è¡Œå¹¶è°ƒè¯•æ–°è¿›ç¨‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p> <p>è¿è¡Œ gdb exe
è¾“å…¥ run å‘½ä»¤ï¼Œgdb æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
é€šè¿‡ fork() ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹
åœ¨æ–°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­æ‰§è¡Œ ptrace(PTRACE_TRACEME, 0, 0, 0) æ“ä½œ
åœ¨å­è¿›ç¨‹ä¸­é€šè¿‡ execv() ç³»ç»Ÿè°ƒç”¨åŠ è½½æŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶
attach è¿è¡Œçš„è¿›ç¨‹
å¯ä»¥é€šè¿‡ gdb attach pid æ¥è°ƒè¯•ä¸€ä¸ªè¿è¡Œçš„è¿›ç¨‹ï¼Œgdb å°†å¯¹æŒ‡å®šè¿›ç¨‹æ‰§è¡Œ ptrace(PTRACE_ATTACH, pid, 0, 0) æ“ä½œã€‚</p> <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ attach ä¸€ä¸ªè¿›ç¨‹ id æ—¶å€™ï¼Œå¯èƒ½ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p> <p>Attaching to process 28849
ptrace: Operation not permitted.</p> <p>è¿™æ˜¯å› ä¸ºæ²¡æœ‰æƒé™è¿›è¡Œæ“ä½œï¼Œå¯ä»¥æ ¹æ®å¯åŠ¨è¯¥è¿›ç¨‹ç”¨æˆ·ä¸‹æˆ–è€… root ä¸‹è¿›è¡Œæ“ä½œã€‚</p> <p>æ–­ç‚¹åŸç†
å®ç°åŸç†
å½“æˆ‘ä»¬é€šè¿‡ b æˆ–è€… break è®¾ç½®æ–­ç‚¹æ—¶å€™ï¼Œå°±æ˜¯åœ¨æŒ‡å®šä½ç½®æ’å…¥æ–­ç‚¹æŒ‡ä»¤ï¼Œå½“è¢«è°ƒè¯•çš„ç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹çš„æ—¶å€™ï¼Œäº§ç”Ÿ SIGTRAP ä¿¡å·ã€‚è¯¥ä¿¡å·è¢« gdb æ•è·å¹¶ è¿›è¡Œæ–­ç‚¹å‘½ä¸­åˆ¤æ–­ã€‚</p> <p>è®¾ç½®åŸç†
åœ¨ç¨‹åºä¸­è®¾ç½®æ–­ç‚¹ï¼Œå°±æ˜¯å…ˆåœ¨è¯¥ä½ç½®ä¿å­˜åŸæŒ‡ä»¤ï¼Œç„¶ååœ¨è¯¥ä½ç½®å†™å…¥ int 3ã€‚å½“æ‰§è¡Œåˆ° int 3 æ—¶ï¼Œå‘ç”Ÿè½¯ä¸­æ–­ï¼Œå†…æ ¸ä¼šå‘å­è¿›ç¨‹å‘é€ SIGTRAP ä¿¡å·ã€‚å½“ç„¶ï¼Œè¿™ä¸ªä¿¡å·ä¼šè½¬å‘ç»™çˆ¶è¿›ç¨‹ã€‚ç„¶åç”¨ä¿å­˜çš„æŒ‡ä»¤æ›¿æ¢ int 3 å¹¶ç­‰å¾…æ“ä½œæ¢å¤ã€‚</p> <p>å‘½ä¸­åˆ¤æ–­
gdb å°†æ‰€æœ‰æ–­ç‚¹ä½ç½®å­˜å‚¨åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ã€‚å‘½ä¸­åˆ¤å®šå°†è¢«è°ƒè¯•ç¨‹åºçš„å½“å‰åœæ­¢ä½ç½®ä¸é“¾è¡¨ä¸­çš„æ–­ç‚¹ä½ç½®è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æŸ¥çœ‹æ–­ç‚¹äº§ç”Ÿçš„ä¿¡å·ã€‚</p> <p>æ¡ä»¶åˆ¤æ–­
åœ¨æ–­ç‚¹å¤„æ¢å¤æŒ‡ä»¤åï¼Œå¢åŠ äº†ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™è§¦å‘æ–­ç‚¹ã€‚ç”±äºéœ€è¦åˆ¤æ–­ä¸€æ¬¡ï¼Œæ·»åŠ æ¡ä»¶æ–­ç‚¹åï¼Œæ˜¯å¦è§¦å‘æ¡ä»¶æ–­ç‚¹ï¼Œéƒ½ä¼šå½±å“æ€§èƒ½ã€‚åœ¨ x86 å¹³å°ä¸Šï¼Œéƒ¨åˆ†ç¡¬ä»¶æ”¯æŒç¡¬ä»¶æ–­ç‚¹ã€‚ä¸æ˜¯åœ¨æ¡ä»¶æ–­ç‚¹å¤„æ’å…¥ int 3ï¼Œè€Œæ˜¯æ’å…¥å¦ä¸€æ¡æŒ‡ä»¤ã€‚å½“ç¨‹åºåˆ°è¾¾è¿™ä¸ªåœ°å€æ—¶ï¼Œä¸æ˜¯å‘å‡º int 3 ä¿¡å·ï¼Œè€Œæ˜¯è¿›è¡Œæ¯”è¾ƒã€‚ç‰¹å®šå¯„å­˜å™¨çš„å†…å®¹å’ŒæŸä¸ªåœ°å€ï¼Œç„¶åå†³å®šæ˜¯å¦å‘é€ int 3ã€‚å› æ­¤ï¼Œå½“ä½ çš„æ–­ç‚¹ä½ç½®è¢«ç¨‹åºé¢‘ç¹ â€œé€šè¿‡â€ æ—¶ï¼Œå°½é‡ä½¿ç”¨ç¡¬ä»¶æ–­ç‚¹ï¼Œè¿™å°†æœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚</p> <p>å•æ­¥åŸç†
è¿™ä¸ª ptrace å‡½æ•°æœ¬èº«å°±æ”¯æŒï¼Œå¯ä»¥é€šè¿‡ ptrace(PTRACE_SINGLESTEP, pid,...) è°ƒç”¨æ¥å®ç°å•æ­¥ã€‚</p> <p>printf(&quot;attaching to PID %d\n&quot;, pid);
if (ptrace(PTRACE_ATTACH, pid, 0, 0) != 0)
{
perror(&quot;attach failed&quot;);
}
int waitStat = 0;
int waitRes = waitpid(pid, &amp;waitStat, WUNTRACED);
if (waitRes != pid || !WIFSTOPPED(waitStat))
{
printf(&quot;unexpected waitpid result!\n&quot;);
exit(1);
}</p> <div class="language- extra-class"><pre><code>int64_t numSteps = 0;
while (true) {
    auto res = ptrace(PTRACE_SINGLESTEP, pid, 0, 0);
}
</code></pre></div><p>ä¸Šè¿°ä»£ç ï¼Œé¦–å…ˆæ¥æ”¶ä¸€ä¸ª pidï¼Œç„¶åå¯¹å…¶è¿›è¡Œ attachï¼Œæœ€åè°ƒç”¨ ptrace è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚</p> <p>å…¶å®ƒ
å€ŸåŠ©æœ¬æ–‡ï¼Œç®€å•ä»‹ç»ä¸‹ç¬”è€…å·¥ä½œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸€äº›å…¶ä»–å‘½ä»¤æˆ–è€…å·¥å…·ã€‚</p> <p>pstack
æ­¤å‘½ä»¤å¯æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„æ ˆè·Ÿè¸ªã€‚pstack å‘½ä»¤å¿…é¡»ç”±ç›¸åº”è¿›ç¨‹çš„å±ä¸»æˆ– root è¿è¡Œã€‚å¯ä»¥ä½¿ç”¨ pstack æ¥ç¡®å®šè¿›ç¨‹æŒ‚èµ·çš„ä½ç½®ã€‚æ­¤å‘½ä»¤å…è®¸ä½¿ç”¨çš„å”¯ä¸€é€‰é¡¹æ˜¯è¦æ£€æŸ¥çš„è¿›ç¨‹çš„ PIDã€‚</p> <p>è¿™ä¸ªå‘½ä»¤åœ¨æ’æŸ¥è¿›ç¨‹é—®é¢˜æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å‘ç°ä¸€ä¸ªæœåŠ¡ä¸€ç›´å¤„äº work çŠ¶æ€ï¼ˆå¦‚å‡æ­»çŠ¶æ€ï¼Œå¥½ä¼¼æ­»å¾ªç¯ï¼‰ï¼Œä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°±èƒ½è½»æ¾å®šä½é—®é¢˜æ‰€åœ¨ï¼›å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œå¤šæ‰§è¡Œå‡ æ¬¡ pstackï¼Œè‹¥å‘ç°ä»£ç æ ˆæ€»æ˜¯åœåœ¨åŒä¸€ä¸ªä½ç½®ï¼Œé‚£ä¸ªä½ç½®å°±éœ€è¦é‡ç‚¹å…³æ³¨ï¼Œå¾ˆå¯èƒ½å°±æ˜¯å‡ºé—®é¢˜çš„åœ°æ–¹ï¼›</p> <p>ä»¥å‰é¢çš„å¤šçº¿ç¨‹ä»£ç ä¸ºä¾‹ï¼Œå…¶è¿›ç¨‹ ID æ˜¯ 4507(åœ¨ç¬”è€…æœ¬åœ°)ï¼Œé‚£ä¹ˆé€šè¿‡</p> <p>pstack 4507 è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p> <p>Thread 3 (Thread 0x7f07aaa69700 (LWP 45708)):
#0  0x00007f07aab2ee2d in nanosleep () from /lib64/libc.so.6
#1  0x00007f07aab2ecc4 in sleep () from /lib64/libc.so.6
#2  0x00007f07ab403eb9 in std::this_thread::__sleep_for(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt;, std::chrono::duration&lt;long, std::ratio&lt;1l, 1000000000l&gt; &gt;) () from /lib64/libstdc++.so.6
#3  0x00000000004018cc in void std::this_thread::sleep_for&lt;long, std::ratio&lt;1l, 1l&gt; &gt;(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt; const&amp;) ()
#4  0x00000000004012de in fun_int(int) ()
#5  0x0000000000404696 in int std::_Bind_simple&lt;int (<em>(int))(int)&gt;::_M_invoke&lt;0ul&gt;(std::_Index_tuple&lt;0ul&gt;) ()
#6  0x000000000040443d in std::_Bind_simple&lt;int (</em>(int))(int)&gt;::operator()() ()
#7  0x000000000040436e in std::thread::_Impl&lt;std::_Bind_simple&lt;int (<em>(int))(int)&gt; &gt;::_M_run() ()
#8  0x00007f07ab404070 in ?? () from /lib64/libstdc++.so.6
#9  0x00007f07ab65ddd5 in start_thread () from /lib64/libpthread.so.0
#10 0x00007f07aab67ead in clone () from /lib64/libc.so.6
Thread 2 (Thread 0x7f07aa268700 (LWP 45709)):
#0  0x00007f07aab2ee2d in nanosleep () from /lib64/libc.so.6
#1  0x00007f07aab2ecc4 in sleep () from /lib64/libc.so.6
#2  0x00007f07ab403eb9 in std::this_thread::__sleep_for(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt;, std::chrono::duration&lt;long, std::ratio&lt;1l, 1000000000l&gt; &gt;) () from /lib64/libstdc++.so.6
#3  0x00000000004018cc in void std::this_thread::sleep_for&lt;long, std::ratio&lt;1l, 1l&gt; &gt;(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt; const&amp;) ()
#4  0x0000000000401340 in fun_string(std::string const&amp;) ()
#5  0x000000000040459f in int std::_Bind_simple&lt;int (</em>(char const*))(std::string const&amp;)&gt;::_M_invoke&lt;0ul&gt;(std::_Index_tuple&lt;0ul&gt;) ()
#6  0x000000000040441f in std::_Bind_simple&lt;int (<em>(char const</em>))(std::string const&amp;)&gt;::operator()() ()
#7  0x0000000000404350 in std::thread::_Impl&lt;std::_Bind_simple&lt;int (<em>(char const</em>))(std::string const&amp;)&gt; &gt;::_M_run() ()
#8  0x00007f07ab404070 in ?? () from /lib64/libstdc++.so.6
#9  0x00007f07ab65ddd5 in start_thread () from /lib64/libpthread.so.0
#10 0x00007f07aab67ead in clone () from /lib64/libc.so.6
Thread 1 (Thread 0x7f07aba80740 (LWP 45707)):
#0  0x00007f07ab65ef47 in pthread_join () from /lib64/libpthread.so.0
#1  0x00007f07ab403e37 in std::thread::join() () from /lib64/libstdc++.so.6
#2  0x0000000000401455 in main ()</p> <p>åœ¨ä¸Šè¿°è¾“å‡ºç»“æœä¸­ï¼Œå°†è¿›ç¨‹å†…éƒ¨çš„è¯¦ç»†ä¿¡æ¯éƒ½è¾“å‡ºåœ¨ç»ˆç«¯ï¼Œä»¥æ–¹ä¾¿åˆ†æé—®é¢˜ã€‚</p> <p>ldd
åœ¨æˆ‘ä»¬ç¼–è¯‘è¿‡ç¨‹ä¸­é€šå¸¸ä¼šæç¤ºç¼–è¯‘å¤±è´¥ï¼Œé€šè¿‡è¾“å‡ºé”™è¯¯ä¿¡æ¯å‘ç°æ˜¯æ‰¾ä¸åˆ°å‡½æ•°å®šä¹‰ï¼Œå†æˆ–è€…ç¼–è¯‘æˆåŠŸäº†ï¼Œä½†æ˜¯è¿è¡Œæ—¶å€™å¤±è´¥ (å¾€å¾€æ˜¯å› ä¸ºä¾èµ–äº†éæ­£å¸¸ç‰ˆæœ¬çš„ lib åº“å¯¼è‡´)ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ ldd æ¥åˆ†æè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä¾èµ–äº†å“ªäº›åº“ä»¥åŠè¿™äº›åº“æ‰€åœ¨çš„è·¯å¾„ã€‚</p> <p>ç”¨æ¥æŸ¥çœ‹ç¨‹å¼è¿è¡Œæ‰€éœ€çš„å…±äº«åº“, å¸¸ç”¨æ¥è§£å†³ç¨‹å¼å› ç¼ºå°‘æŸä¸ªåº“æ–‡ä»¶è€Œä¸èƒ½è¿è¡Œçš„ä¸€äº›é—®é¢˜ã€‚</p> <p>ä»ç„¶æŸ¥çœ‹å¯æ‰§è¡Œç¨‹åº test_thread çš„ä¾èµ–åº“ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p> <p>ldd -r ./test_thread
linux-vdso.so.1 =&gt;  (0x00007ffde43bc000)
libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f8c5e310000)
libstdc++.so.6 =&gt; /lib64/libstdc++.so.6 (0x00007f8c5e009000)
libm.so.6 =&gt; /lib64/libm.so.6 (0x00007f8c5dd07000)
libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007f8c5daf1000)
libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f8c5d724000)
/lib64/ld-linux-x86-64.so.2 (0x00007f8c5e52c000)</p> <p>åœ¨ä¸Šè¿°è¾“å‡ºä¸­ï¼š</p> <p>ç¬¬ä¸€åˆ—ï¼šç¨‹åºéœ€è¦ä¾èµ–ä»€ä¹ˆåº“
ç¬¬äºŒåˆ—ï¼šç³»ç»Ÿæä¾›çš„ä¸ç¨‹åºéœ€è¦çš„åº“æ‰€å¯¹åº”çš„åº“
ç¬¬ä¸‰åˆ—ï¼šåº“åŠ è½½çš„å¼€å§‹åœ°å€
åœ¨æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡ ldd æŸ¥çœ‹ä¾èµ–åº“çš„æ—¶å€™ï¼Œä¼šæç¤ºæ‰¾ä¸åˆ°åº“ï¼Œå¦‚ä¸‹ï¼š</p> <p>ldd -r test_process
linux-vdso.so.1 =&gt;  (0x00007ffc71b80000)
libstdc++.so.6 =&gt; /lib64/libstdc++.so.6 (0x00007fe4badd5000)
libm.so.6 =&gt; /lib64/libm.so.6 (0x00007fe4baad3000)
libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007fe4ba8bd000)
libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fe4ba4f0000)
/lib64/ld-linux-x86-64.so.2 (0x00007fe4bb0dc000)
liba.so =&gt; not found</p> <p>æ¯”å¦‚ä¸Šé¢æœ€åä¸€å¥æç¤ºï¼Œliba.so æ‰¾ä¸åˆ°ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦æˆ‘ä»¬çŸ¥é“ liba.so çš„è·¯å¾„ï¼Œæ¯”å¦‚åœ¨ / path/to/liba.soï¼Œé‚£ä¹ˆå¯ä»¥æœ‰ä¸‹é¢ä¸¤ç§æ–¹å¼ï¼š</p> <p>LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path/to/</p> <p>è¿™æ ·åœ¨é€šè¿‡ ldd æŸ¥çœ‹ï¼Œå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„ lib åº“ï¼Œä½†æ˜¯è¿™ä¸ªç¼ºç‚¹æ˜¯ä¸´æ—¶çš„ï¼Œå³é€€å‡ºç»ˆç«¯åï¼Œå†æ‰§è¡Œ lddï¼Œä»ç„¶ä¼šæç¤ºæ‰¾ä¸åˆ°è¯¥åº“ï¼Œæ‰€ä»¥å°±æœ‰äº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå³é€šè¿‡ä¿®æ”¹ / etc/ld.so.confï¼Œåœ¨è¯¥æ–‡ä»¶çš„åé¢åŠ ä¸Šéœ€è¦çš„è·¯å¾„ï¼Œå³</p> <p>include ld.so.conf.d/*.conf
/path/to/</p> <p>ç„¶åé€šè¿‡å¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯æ°¸ä¹…ç”Ÿæ•ˆ</p> <p>/sbin/ldconfig</p> <p>c++filt
å› ä¸º c++ æ”¯æŒé‡è½½ï¼Œä¹Ÿå°±å¼•å‡ºäº†ç¼–è¯‘å™¨çš„name manglingæœºåˆ¶ï¼Œå¯¹å‡½æ•°è¿›è¡Œé‡å‘½åã€‚</p> <p>æˆ‘ä»¬é€šè¿‡ strings å‘½ä»¤æŸ¥çœ‹ test_thread ä¸­çš„å‡½æ•°ä¿¡æ¯ (ä»…è¾“å‡º fun ç­‰ç›¸å…³)</p> <p>strings test_thread | grep fun_
in fun_int n =
in fun_string s =
_GLOBAL__sub_I__Z7fun_inti
_Z10fun_stringRKSs</p> <p>å¯ä»¥çœ‹åˆ°_Z10fun_stringRKSs è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœæƒ³çŸ¥é“è¿™ä¸ªå‡½æ•°å®šä¹‰çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ c++filt å‘½ä»¤ï¼Œå¦‚ä¸‹ï¼š</p> <p>c++filt _Z10fun_stringRKSs
fun_string(std::basic_string&lt;char, std::char_traits<char>, std::allocator<char> &gt; const&amp;)</char></char></p> <p>é€šè¿‡ä¸Šè¿°è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼–è¯‘å™¨ç”Ÿæˆçš„å‡½æ•°åè¿˜åŸåˆ°æˆ‘ä»¬ä»£ç ä¸­çš„å‡½æ•°åå³ fun_stringã€‚</p> <p>ç»“è¯­
GDB æ˜¯ä¸€ä¸ªåœ¨ Linux ä¸Šè¿›è¡Œå¼€å‘çš„ä¸€ä¸ªå¿…ä¸å¯å°‘çš„è°ƒè¯•å·¥å…·ï¼Œä½¿ç”¨åœºæ™¯ä¾èµ–äºå…·ä½“çš„éœ€æ±‚æˆ–è€…é‡åˆ°çš„å…·ä½“é—®é¢˜ã€‚åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œç†Ÿç»ƒä½¿ç”¨ GDB åŠ ä»¥è¾…åŠ©ï¼Œèƒ½å¤Ÿä½¿å¾—å¼€å‘è¿‡ç¨‹äº‹åŠåŠŸå€ã€‚</p> <p>æœ¬æ–‡ä»ä¸€äº›ç®€å•çš„å‘½ä»¤å‡ºå‘ï¼Œé€šè¿‡ä¸¾ä¾‹è°ƒè¯•å¯æ‰§è¡Œç¨‹åº (å•çº¿ç¨‹ã€å¤šçº¿ç¨‹ä»¥åŠå¤šè¿›ç¨‹åœºæ™¯)ã€coredump æ–‡ä»¶ç­‰å„ä¸ªåœºæ™¯ï¼Œä½¿å¾—å¤§å®¶èƒ½å¤Ÿæ›´åŠ ç›´è§‚çš„äº†è§£ GDB çš„ä½¿ç”¨ã€‚GDB åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œç¬”è€…å·¥ä½œä¸­ä½¿ç”¨çš„éƒ½æ˜¯éå¸¸åŸºæœ¬çš„ä¸€äº›åŠŸèƒ½ï¼Œå¦‚æœæƒ³æ·±å…¥ç†è§£ GDBï¼Œåˆ™éœ€è¦å»å®˜ç½‘è¿›è¡Œé˜…è¯»äº†è§£ã€‚</p> <p>å¥½äº†ï¼Œæœ¬æœŸçš„æ–‡ç« å°±åˆ°è¿™ï¼Œæˆ‘ä»¬ä¸‹æœŸè§ã€‚</p> <p>â
æœ¬æ–‡ä»æ„æ€åˆ°å®Œæˆï¼Œå¤§æ¦‚ç”¨äº†ä¸‰å‘¨æ—¶é—´ï¼Œå†™ä½œè¿‡ç¨‹æ˜¯ç—›è‹¦çš„ (éœ€è¦æ•´ç†èµ„æ–™ä»¥åŠæ„å»ºå„ç§åœºæ™¯ï¼Œä»¥åŠå°†å„ç§ç°åœºè¿˜åŸ)ï¼ŒåŒæ—¶åˆæ˜¯æ”¶è·æ»¡æ»¡çš„ã€‚é€šè¿‡æœ¬æ–‡ï¼Œè¿›ä¸€æ­¥åŠ æ·±äº†å¯¹ GDB çš„åº•å±‚åŸç†ç†è§£ã€‚</p> <p>â
å‚è€ƒ
https://www.codetd.com/en/article/13107993</p> <p>https://www.codetd.com/en/article/13107993 https://users.ece.utexas.edu/~adnan/gdb-refcard.pdf</p> <p>https://www.cloudsavvyit.com/10921/debugging-with-gdb-getting-started/</p> <p>https://blog.birost.com/a?ID=00650-b03e2257-94bf-41f3-b0fc-d352d5b02431</p> <p>https://www.cnblogs.com/xsln/p/ptrace.html</p> <p>å¦‚æœå¯¹æœ¬æ–‡æœ‰ç–‘é—®å¯ä»¥åŠ ç¬”è€…å¾®ä¿¡ç›´æ¥äº¤æµï¼Œç¬”è€…ä¹Ÿå»ºäº† C/C++ ç›¸å…³çš„æŠ€æœ¯ç¾¤ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è”ç³»ç¬”è€…åŠ ç¾¤ã€‚</p> <p>å¾€æœŸç²¾å½©å›é¡¾</p> <p>ã€çº¿ä¸Šé—®é¢˜ã€‘P1 çº§å…¬å¸æ•…éšœï¼Œå¹´ç»ˆå¥–ä¸ä¿
ã€æ€§èƒ½ä¼˜åŒ–ã€‘lock-free åœ¨å¬å›å¼•æ“ä¸­çš„å®ç°
ã€æ€§èƒ½ä¼˜åŒ–ã€‘é«˜æ•ˆå†…å­˜æ± çš„è®¾è®¡ä¸å®ç°
2 ä¸‡å­— | 30 å¼ å›¾å¸¦ä½ é¢†ç•¥ glibc å†…å­˜ç®¡ç†ç²¾é«“
ã€ä¸‡å­—é•¿æ–‡ã€‘åƒé€è´Ÿè½½å‡è¡¡
æµé‡æ§åˆ¶è¿˜èƒ½è¿™ä¹ˆæã€‚ã€‚ã€‚
æŠ€æœ¯åå¹´
èŠèŠæœåŠ¡æ³¨å†Œä¸å‘ç°</p> <p>ç‚¹ä¸ªå…³æ³¨å§!</p> <p>å…¬ä¼—å·
å…¨æ–‡å®Œ
æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead ä¼˜åŒ–ï¼Œç”¨ä»¥æå‡é˜…è¯»ä½“éªŒ
ä½¿ç”¨äº† å…¨æ–°çš„ç®€æ‚¦è¯æ³•åˆ†æå¼•æ“ betaï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦ç»†è¯´æ˜
å†™åœ¨å‰é¢
èƒŒæ™¯
æ¦‚å¿µ
å¸¸ç”¨å‘½ä»¤
æ–­ç‚¹
breakpoint
watchpoint
catchpoint
å‘½ä»¤è¡Œ
ç¨‹åºæ ˆ
å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹
å¤šè¿›ç¨‹
å¤šçº¿ç¨‹
æ‰“å°è¾“å‡º
å‡½æ•°è·³è½¬
å…¶å®ƒ
å›¾å½¢åŒ–
æ±‡ç¼–
è°ƒè¯•å’Œä¿å­˜ core æ–‡ä»¶
å¯åŠ¨æ–¹å¼
è°ƒè¯•
å¯æ‰§è¡Œæ–‡ä»¶
å•çº¿ç¨‹
å¤šçº¿ç¨‹
å¤šè¿›ç¨‹
coredump
åŸç†
è°ƒè¯•åŸç†
è¿è¡Œå¹¶è°ƒè¯•æ–°è¿›ç¨‹
attach è¿è¡Œçš„è¿›ç¨‹
æ–­ç‚¹åŸç†
å®ç°åŸç†
è®¾ç½®åŸç†
å‘½ä¸­åˆ¤æ–­
æ¡ä»¶åˆ¤æ–­
å•æ­¥åŸç†
å…¶å®ƒ
pstack
ldd
c++filt
ç»“è¯­
å‚è€ƒ</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022/1/10 ä¸‹åˆ4:07:35</span></div></footer> <!----> </main> <div class="footer-wrapper footer"><span><a href="https://beian.miit.gov.cn/">è±«ICPå¤‡20003255å·</a></span> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9582591d.js" defer></script><script src="/assets/js/2.a6173bc2.js" defer></script><script src="/assets/js/129.3bb78856.js" defer></script>
  </body>
</html>
