<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>“存储引擎个人调查报告“ | 小张笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-141019448-1"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
      
          gtag('config', 'UA-141019448-1');
      </script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2468672938537807" crossorigin="anonymous"></script>
    <meta name="description" content="Little Zhang's Note">
    <meta name="baidu-site-verification" content="code-HRrK6kdBX1">
    
    <link rel="preload" href="/assets/css/0.styles.ceffaf74.css" as="style"><link rel="preload" href="/assets/js/app.0c0842f3.js" as="script"><link rel="preload" href="/assets/js/2.a6173bc2.js" as="script"><link rel="preload" href="/assets/js/61.1afe7d7a.js" as="script"><link rel="prefetch" href="/assets/js/10.bf63d664.js"><link rel="prefetch" href="/assets/js/100.26066952.js"><link rel="prefetch" href="/assets/js/101.af73cdfe.js"><link rel="prefetch" href="/assets/js/102.7595455c.js"><link rel="prefetch" href="/assets/js/103.7d1e9bcd.js"><link rel="prefetch" href="/assets/js/104.ffe1e7ed.js"><link rel="prefetch" href="/assets/js/105.1f0786cd.js"><link rel="prefetch" href="/assets/js/106.6a48bf56.js"><link rel="prefetch" href="/assets/js/107.49a2484f.js"><link rel="prefetch" href="/assets/js/108.5141baf2.js"><link rel="prefetch" href="/assets/js/109.d4b9b021.js"><link rel="prefetch" href="/assets/js/11.485b99ca.js"><link rel="prefetch" href="/assets/js/110.6106ded1.js"><link rel="prefetch" href="/assets/js/111.0779a44a.js"><link rel="prefetch" href="/assets/js/112.ee4b5344.js"><link rel="prefetch" href="/assets/js/113.b0d9e8f0.js"><link rel="prefetch" href="/assets/js/114.8d6e510e.js"><link rel="prefetch" href="/assets/js/115.62f1946c.js"><link rel="prefetch" href="/assets/js/116.2b8e6798.js"><link rel="prefetch" href="/assets/js/117.9fa03b43.js"><link rel="prefetch" href="/assets/js/118.89d4a12d.js"><link rel="prefetch" href="/assets/js/119.21b2436d.js"><link rel="prefetch" href="/assets/js/12.ef0e7bb2.js"><link rel="prefetch" href="/assets/js/120.03436387.js"><link rel="prefetch" href="/assets/js/121.d073d8f2.js"><link rel="prefetch" href="/assets/js/122.f5a7c934.js"><link rel="prefetch" href="/assets/js/123.5e10b800.js"><link rel="prefetch" href="/assets/js/124.0657ec75.js"><link rel="prefetch" href="/assets/js/125.e707dfcd.js"><link rel="prefetch" href="/assets/js/126.95d0631d.js"><link rel="prefetch" href="/assets/js/127.f032934c.js"><link rel="prefetch" href="/assets/js/128.4a5f529b.js"><link rel="prefetch" href="/assets/js/129.91a6c0b4.js"><link rel="prefetch" href="/assets/js/13.87dd89d6.js"><link rel="prefetch" href="/assets/js/130.bda83357.js"><link rel="prefetch" href="/assets/js/131.4aa57eff.js"><link rel="prefetch" href="/assets/js/132.5b9896e8.js"><link rel="prefetch" href="/assets/js/133.38cee145.js"><link rel="prefetch" href="/assets/js/134.bebc442c.js"><link rel="prefetch" href="/assets/js/135.0726be31.js"><link rel="prefetch" href="/assets/js/136.148aa795.js"><link rel="prefetch" href="/assets/js/137.ecf5da6a.js"><link rel="prefetch" href="/assets/js/138.075e8bc7.js"><link rel="prefetch" href="/assets/js/139.3f2e7d02.js"><link rel="prefetch" href="/assets/js/14.d98aa6b4.js"><link rel="prefetch" href="/assets/js/140.bc3e4561.js"><link rel="prefetch" href="/assets/js/141.ace4896f.js"><link rel="prefetch" href="/assets/js/142.ac7853e7.js"><link rel="prefetch" href="/assets/js/143.45450d0f.js"><link rel="prefetch" href="/assets/js/144.25820a3f.js"><link rel="prefetch" href="/assets/js/145.241f1f1e.js"><link rel="prefetch" href="/assets/js/146.34385972.js"><link rel="prefetch" href="/assets/js/147.96aa98bf.js"><link rel="prefetch" href="/assets/js/148.9de0fb5f.js"><link rel="prefetch" href="/assets/js/149.eba5050d.js"><link rel="prefetch" href="/assets/js/15.b59d47ee.js"><link rel="prefetch" href="/assets/js/150.aba2fd84.js"><link rel="prefetch" href="/assets/js/151.dd288598.js"><link rel="prefetch" href="/assets/js/152.741c9b96.js"><link rel="prefetch" href="/assets/js/153.5183a4cf.js"><link rel="prefetch" href="/assets/js/154.43618a7f.js"><link rel="prefetch" href="/assets/js/16.63ef0330.js"><link rel="prefetch" href="/assets/js/17.ab2f2dac.js"><link rel="prefetch" href="/assets/js/18.d9538616.js"><link rel="prefetch" href="/assets/js/19.b1c3184d.js"><link rel="prefetch" href="/assets/js/20.47ac56bd.js"><link rel="prefetch" href="/assets/js/21.6b476e98.js"><link rel="prefetch" href="/assets/js/22.f9bfbad9.js"><link rel="prefetch" href="/assets/js/23.76b7cdec.js"><link rel="prefetch" href="/assets/js/24.c7e3e56c.js"><link rel="prefetch" href="/assets/js/25.c9f17ec9.js"><link rel="prefetch" href="/assets/js/26.ceeb895c.js"><link rel="prefetch" href="/assets/js/27.353cf9c7.js"><link rel="prefetch" href="/assets/js/28.cf6c83bd.js"><link rel="prefetch" href="/assets/js/29.218d6a39.js"><link rel="prefetch" href="/assets/js/3.582414ce.js"><link rel="prefetch" href="/assets/js/30.f457d7ac.js"><link rel="prefetch" href="/assets/js/31.9a2bd76d.js"><link rel="prefetch" href="/assets/js/32.76f542ca.js"><link rel="prefetch" href="/assets/js/33.3516b47f.js"><link rel="prefetch" href="/assets/js/34.999c4a7b.js"><link rel="prefetch" href="/assets/js/35.4f666517.js"><link rel="prefetch" href="/assets/js/36.9288d5ed.js"><link rel="prefetch" href="/assets/js/37.4663f1b2.js"><link rel="prefetch" href="/assets/js/38.dff2362e.js"><link rel="prefetch" href="/assets/js/39.a0462821.js"><link rel="prefetch" href="/assets/js/4.37124f74.js"><link rel="prefetch" href="/assets/js/40.4470e8cb.js"><link rel="prefetch" href="/assets/js/41.87c56094.js"><link rel="prefetch" href="/assets/js/42.85a1217e.js"><link rel="prefetch" href="/assets/js/43.6038e8e4.js"><link rel="prefetch" href="/assets/js/44.7aafac1f.js"><link rel="prefetch" href="/assets/js/45.05e89f7b.js"><link rel="prefetch" href="/assets/js/46.fe22afa4.js"><link rel="prefetch" href="/assets/js/47.4d0f0f82.js"><link rel="prefetch" href="/assets/js/48.9b41e3ac.js"><link rel="prefetch" href="/assets/js/49.c4163dc8.js"><link rel="prefetch" href="/assets/js/5.b649da8c.js"><link rel="prefetch" href="/assets/js/50.57533708.js"><link rel="prefetch" href="/assets/js/51.fdf07d65.js"><link rel="prefetch" href="/assets/js/52.4c7fdcd2.js"><link rel="prefetch" href="/assets/js/53.ddd0e223.js"><link rel="prefetch" href="/assets/js/54.5c91c7e3.js"><link rel="prefetch" href="/assets/js/55.250afd87.js"><link rel="prefetch" href="/assets/js/56.5c138b7e.js"><link rel="prefetch" href="/assets/js/57.60e551e3.js"><link rel="prefetch" href="/assets/js/58.921e3d14.js"><link rel="prefetch" href="/assets/js/59.6468404c.js"><link rel="prefetch" href="/assets/js/6.a396de83.js"><link rel="prefetch" href="/assets/js/60.fa65e7a8.js"><link rel="prefetch" href="/assets/js/62.518ff306.js"><link rel="prefetch" href="/assets/js/63.19d38b68.js"><link rel="prefetch" href="/assets/js/64.3069aeba.js"><link rel="prefetch" href="/assets/js/65.f2f736aa.js"><link rel="prefetch" href="/assets/js/66.ee3184cb.js"><link rel="prefetch" href="/assets/js/67.2f1c3534.js"><link rel="prefetch" href="/assets/js/68.a3b9b943.js"><link rel="prefetch" href="/assets/js/69.10d835d5.js"><link rel="prefetch" href="/assets/js/7.03daa1b7.js"><link rel="prefetch" href="/assets/js/70.4c7a468d.js"><link rel="prefetch" href="/assets/js/71.5ba570b2.js"><link rel="prefetch" href="/assets/js/72.a231600f.js"><link rel="prefetch" href="/assets/js/73.096b496f.js"><link rel="prefetch" href="/assets/js/74.21040cf6.js"><link rel="prefetch" href="/assets/js/75.d8605e36.js"><link rel="prefetch" href="/assets/js/76.737ce24b.js"><link rel="prefetch" href="/assets/js/77.7c7b532f.js"><link rel="prefetch" href="/assets/js/78.60b44955.js"><link rel="prefetch" href="/assets/js/79.6dbe3652.js"><link rel="prefetch" href="/assets/js/8.150af887.js"><link rel="prefetch" href="/assets/js/80.58526f91.js"><link rel="prefetch" href="/assets/js/81.c19d05fe.js"><link rel="prefetch" href="/assets/js/82.d0b9d12a.js"><link rel="prefetch" href="/assets/js/83.a61a8d5a.js"><link rel="prefetch" href="/assets/js/84.c4d8e817.js"><link rel="prefetch" href="/assets/js/85.6a87b80a.js"><link rel="prefetch" href="/assets/js/86.cab67863.js"><link rel="prefetch" href="/assets/js/87.b4cad765.js"><link rel="prefetch" href="/assets/js/88.22b46094.js"><link rel="prefetch" href="/assets/js/89.f494a431.js"><link rel="prefetch" href="/assets/js/9.f7aab732.js"><link rel="prefetch" href="/assets/js/90.8aca6139.js"><link rel="prefetch" href="/assets/js/91.42745b4d.js"><link rel="prefetch" href="/assets/js/92.b7ef843b.js"><link rel="prefetch" href="/assets/js/93.23cc4aff.js"><link rel="prefetch" href="/assets/js/94.338f5c05.js"><link rel="prefetch" href="/assets/js/95.00aa4f44.js"><link rel="prefetch" href="/assets/js/96.c911c744.js"><link rel="prefetch" href="/assets/js/97.0225f345.js"><link rel="prefetch" href="/assets/js/98.d421614b.js"><link rel="prefetch" href="/assets/js/99.e5a41af7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ceffaf74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小张笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/210814_存储引擎个人调查报告.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/索引/Search.html" class="nav-link">
  Google站内搜索
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/210814_存储引擎个人调查报告.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>“存储引擎个人调查报告“</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#boltdb" class="sidebar-link">boltdb</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#sqlite" class="sidebar-link">sqlite</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#key-value-system" class="sidebar-link">key-value-system</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#接下来的更新计划" class="sidebar-link">接下来的更新计划</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/file/210814_%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%AA%E4%BA%BA%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A.html#文章被以下专栏收录" class="sidebar-link">文章被以下专栏收录</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><hr> <p><img src="https://pic1.zhimg.com/v2-185fdc875e33f782d2a2aff3b6e9364e_1440w.jpg?source=172ae18b" alt="存储引擎个人调查报告"></p> <p>对于一个初学者来说，学习存储引擎最好的办法就是亲身参与一个存储引擎的编写，但是普通人很难有机会，存储引擎不像是普通的应用程序，编写工业级别的存储引擎的机会，一般只会在数据库公司/部门或者某几个高校中，那么自己造轮子就是一个很好的办法。自己造轮子，不可能只看一些理论，必须参考现成的存储引擎，故需要对现在的存储引擎的情况做一个调查。调查从以下几个指标进行：</p> <ul><li>编程语言</li> <li>代码规模</li> <li>资料丰富程度</li></ul> <p>这些指标影响着学习这些存储引擎的效率。倘若存储引擎所用的编程语言是你不擅长的语言，那么学习、使用它本身还需要额外的成本；代码规模不宜过大，让初学者去阅读上百万，上十万规模代码的项目是不现实的，到目前为止，PostrgeSQL就有135万行代码，存储引擎部分肯定也不少，直接阅读它是不现实的，我去找猫咪借8条命也不够用；资料分为文档、书本、注释，资料丰富程度也影响着学习效率，代码的很多地方浓缩了很多信息量，直接阅读代码且没有相关经验的话很难理解代码的思路，丰富易读的资料能够让学习者如虎添翼，使得学习者可以以一个更高的视角去阅读代码。</p> <p>目前存储引擎所使用的语言集中在三种：C、C++和Go，其它语言的存储引擎有，但是数量偏少，比如说使用Java的HBase，我们暂且不去思考为什么，只是关注于这个事实，从而得出一个结论：学习存储引擎，最好要懂得使用C/C++或Go中的至少一个。</p> <p>对于初学者，代码规模在5000行以下是比较合适的，当然这里的代码是指核心代码，不包括一些脚本、测试、benchmark代码。这里的代码规模以选择存储引擎的特定版本为主，可能一些存储引擎的代码规模已经在10000行以上了，但是它的早期可用版本，在5000行以下，那么这也是合适的。代码行数也有两种，一种是整体代码行数，一种是有效代码行数，两者的区别是后者只统计能被编译器识别的部分，还需要除去头文件，注释是不计入的。整体代码行数使用Shell[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_1">1]</a>命令进行统计，有效代码函数使用jetbrains的Statistic插件[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_2">2]</a>进行统计。</p> <p>对于资料丰富程度，一般有文档、书本、注释，大多数成熟的存储引擎都有自己的文档，再加上互联网上其它前辈对它的研究成果，可以作为参考。有书专门讲解的存储引擎比较少，一般书本比较系统，但是未必写得好。很多开发者写代码很认真，不仅写了代码还写了许多注释，写过代码的同学都知道，写代码很爽，写注释、文档却是一件很费力的事情，注释，代表着开发者对代码思路的见解，也有很多参考价值。最后阅读知乎回答、和有相关经验的知乎用户交流，也是一种了解存储引擎的方式。</p> <p>下面介绍一些开源的存储引擎项目。该文章将随着我对它们了解的深入而不断更新。**想造轮子的童鞋可以联系我，咱们互相交流交流！**文章封面来自机核网[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_3">3]</a>。</p> <hr> <h2 id="boltdb"><a href="#boltdb" class="header-anchor">#</a> boltdb</h2> <p>boltdb是一个参考自LMDB的存储引擎，作者在早期的时候直接将LMDB的代码复杂到项目中，加上注释，然后编写成Go的代码。目前已经封存，最后的提交时间为2018年3月3日，其fork版本被etcd维护为<a href="https://link.zhihu.com/?target=https%3A//github.com/etcd-io/bbolt" target="_blank" rel="noopener noreferrer">bbolt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，并应用与分布式存储etcd中，etcd作者是阿里巴巴90后工程师李响[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_4">4]</a>。</p> <p>它具备以下几个特征：</p> <ul><li>使用B+树作为索引</li> <li>支持B+树嵌套（subbucket）</li> <li>支持事务</li> <li>支持持久化</li> <li>使用mmap从磁盘中读取数据</li> <li>使用freelist进行空间回收（不进行compact）</li></ul> <p>指标方面情况如下：</p> <ul><li><p>编程语言：纯Go编写（Go：99%，Makefile：0.1%）</p></li> <li><p>代码行数：</p></li> <li><ul><li><p>截至最新的<a href="https://link.zhihu.com/?target=https%3A//github.com/boltdb/bolt/tree/fd01fc79c553a8e99d512a07e8e0c63d4a3ccfc5" target="_blank" rel="noopener noreferrer">commit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，提交于2018年3月3日</p></li> <li><ul><li>整体代码行数（Go）12426行</li> <li>有效代码行数9060行。</li></ul></li> <li><p>第一个稳定版本<a href="https://link.zhihu.com/?target=https%3A//github.com/boltdb/bolt/tree/d8ec4f929730790653c1350f689da961b9a194cc" target="_blank" rel="noopener noreferrer">data/v1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，发布于2014年4月12日</p></li> <li><ul><li>整体代码行数5798行</li> <li>有效代码行数4197行。</li></ul></li> <li><p><a href="https://link.zhihu.com/?target=https%3A//github.com/boltdb/bolt/tree/c1f33cb04b4051fe9192773398fae7bb78565152" target="_blank" rel="noopener noreferrer">Alpha版本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，发布于2014年2月18日</p></li> <li><ul><li>整体代码行数3911行</li> <li>有效代码行数2700行。</li></ul></li></ul></li> <li><p>资料方面</p></li> <li><ul><li><p>文档方面</p></li> <li><ul><li>官方<a href="https://link.zhihu.com/?target=https%3A//github.com/boltdb/bolt/blob/master/README.md" target="_blank" rel="noopener noreferrer">README<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：介绍了boltdb的API，介绍了一些数据库、存储引擎，简要地概况核心源代码文件的功能和设计，以及一些阅读源码建议</li> <li>PingCAP员工  的博客文章：<a href="https://link.zhihu.com/?target=https%3A//youjiali1995.github.io/storage/boltdb/" target="_blank" rel="noopener noreferrer">boltbd源码分析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，简要地介绍了一下boltdb的存储、事务</li> <li>公众号codedump的网络日志中的<a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/mp/homepage%3F__biz%3DMzAwMjgwMTEzNw%3D%3D%26hid%3D7%26sn%3Da6de7eb747a2c666fe7a69c49ddddb16%26scene%3D18%23wechat_redirect" target="_blank" rel="noopener noreferrer">boltdb系列<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，从索引讲起，还是比较细致</li> <li>一位以注销用户对bolt优缺点的看法：<a href="https://zhuanlan.zhihu.com/p/47214093" target="_blank" rel="noopener noreferrer">BoltDB的优点与缺点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>同名公众号系列文章<a href="https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/mp/homepage%3F__biz%3DMzg5NzE4MjEwOQ%3D%3D%26hid%3D1%26sn%3Dcd687dc4e3d306a0fbaf0217d9905af5%26scene%3D18%23wechat_redirect" target="_blank" rel="noopener noreferrer">boltdb源码导读<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，知乎文章也有，可以翻翻，讲解了数据组织、索引设计、事务实现</li> <li>Github用户ZhengHe-MD的源码阅读项目<a href="https://link.zhihu.com/?target=https%3A//github.com/ZhengHe-MD/learn-bolt" target="_blank" rel="noopener noreferrer">learn bolt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p>书本方面</p></li> <li><ul><li><p>没有出版书，只有网络书籍，用户jaydenwen123的<a href="https://link.zhihu.com/?target=https%3A//www.bookstack.cn/books/jaydenwen123-boltdb_book" target="_blank" rel="noopener noreferrer">自底向上分析BoltDB源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，相当全面细致，不过我个人不赞同自底向上是很好的写书方式，尤其是对初学者而言，我们需要先了解该技术背景下所面临的问题，再才能去很好地理解技术本身，故自顶（实际问题）向下，发现问题、分析问题、学习技术、解决问题、总结优缺点才是更符合人性的编写方式，但是此书还是有很大的参考价值的。</p></li> <li><p>作者录制的相关网络视频：</p></li> <li><ul><li><a href="https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/BV1kf4y1t7zu" target="_blank" rel="noopener noreferrer">boltdb实现及源码分析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/BV1Zv411G7ty" target="_blank" rel="noopener noreferrer">数据存储与检索<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></li> <li><p>注释方面</p></li> <li><ul><li>除了原项目的注释以外没有发现第三方注释</li> <li>原项目注释较为齐全，很多变量、函数都有简要的说明</li></ul></li></ul></li></ul> <p>总结一下，boltdb代码量小，功能齐全，且其fork版本已经被应用到了工业级别的项目中，也已经封存，资料丰富，讨论研究的人也很多，故是学习的最佳对象之一，可惜我不太会go~对于熟悉go的同学来说是再好不过的项目了。</p> <h2 id="sqlite"><a href="#sqlite" class="header-anchor">#</a> sqlite</h2> <p>著名嵌入式关系型数据库，被大量应用于Android系统中，纯C编写，代码注释很齐全，准确地说这不是一个存储引擎，是一个完整的项目，但是可以抽取其中后端的部分来学习。作者写的一篇关于为什么sqlite使用C进行编写的文章，<a href="https://link.zhihu.com/?target=https%3A//sqlite.org/whyc.html" target="_blank" rel="noopener noreferrer">Why Is SQLite Coded In C<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 写的很好。下面是sqlite的架构：</p> <p><img src="https://pic3.zhimg.com/v2-206c3341d08caaa48fb3142b5c925e8a_b.jpg" alt="img"></p> <p>它具备以下特性：</p> <ul><li>采用B树作为索引，但是听说LSM也可，有模块可选择，不过是比较新的版本</li> <li>支持持久化，具体机制不了解</li> <li>支持事务</li> <li>支持WAL</li></ul> <p>各个指标方面：</p> <ul><li><p>编程语言：使用纯C编写，使用TCL进行测试（C：87.9%，TCL：6.8%）</p></li> <li><p>代码行数，来自于SQLite官方时间线[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_5">5]</a></p></li> <li><ul><li><p>截至最新的commit，提交于2021年7月21日</p></li> <li><ul><li>整体代码：367229[.c] + 19885[.h] = 397114</li> <li>有效代码：238904[.c] + 5343[.h] = 244247</li></ul></li> <li><p>第一个版本<a href="https://link.zhihu.com/?target=https%3A//www.sqlite.org/cgi/src/info/f37dd18e3fc6314e" target="_blank" rel="noopener noreferrer">Version 1.0 (CVS 499)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，提交于2000年8月17日</p></li> <li><ul><li>整体代码：15181[.c] + 757[.h] = 15938</li> <li>有效代码：10633[.c] + 238[.h] = 10871</li></ul></li> <li><p>第一次完整的提交<a href="https://link.zhihu.com/?target=https%3A//www.sqlite.org/cgi/src/info/6f3655f79f9b6fc9" target="_blank" rel="noopener noreferrer">initial check-in of the new version (CVS 1)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，提交于2000年5月29日</p></li> <li><ul><li>整体代码：10865[.c] + 638[.h] = 11503</li> <li>有效代码：7627[.c] + 172[.h] = 7799</li></ul></li></ul></li> <li><p>资料方面</p></li> <li><ul><li><p>文档方面：</p></li> <li><ul><li>官方的<a href="https://link.zhihu.com/?target=https%3A//sqlite.org/docs.html" target="_blank" rel="noopener noreferrer">文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，纯英文，详细介绍了SQLite的各个方面</li> <li><a href="https://link.zhihu.com/?target=https%3A//cstack.github.io/db_tutorial/" target="_blank" rel="noopener noreferrer">Let's Build a Simple Database<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：cstack编写的基于sqlite的教程，写得非常好，强烈推荐！！！从一个简单的问题，上手给读者演示如何解决问题，解决好后进行测试评价，在以后的篇幅中以这个问题为入口继续这个过程。书栈网把原项目进行了整理，你可以在它们的网站上[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_6">6]</a>阅读。</li> <li><a href="https://link.zhihu.com/?target=https%3A//blog.japinli.top/db_tutorial_trans" target="_blank" rel="noopener noreferrer">构建简单的数据库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：Let's Build a Simple：Let's Build a Simple Database的中文翻译，可惜翻译不完全，只到第8篇，还有一点点小瑕疵，不过还是很好的，不习惯英文的可以看这个。</li> <li>写的答案：<a href="https://www.zhihu.com/answer/62544197" target="_blank" rel="noopener noreferrer">如何学习sqlite源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，介绍了一下答主自己学习sqlite所造的轮子，还推荐了很多资料，写得很详细，我都没得写咯。</li></ul></li> <li><p>书本方面，这些在张原嘉的回答中都有详细的描述</p></li> <li><ul><li><a href="https://link.zhihu.com/?target=https%3A//book.douban.com/subject/2314119/" target="_blank" rel="noopener noreferrer">Inside SQLite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//195-cmcc-dd.tv002.com/down/437ce707f69023599664ec78b01873c4/%E6%90%AC%E4%B9%A6%E5%8C%A0-2374-Database%20Internals-2019-%E8%8B%B1%E6%96%87%E7%89%88.pdf%3Fcts%3Dyd-f-D39A173A24A184F16305%26ctp%3D39A173A24A184%26ctt%3D1626695300%26limit%3D1%26spd%3D35000%26ctk%3D437ce707f69023599664ec78b01873c4%26chk%3D11bbe1670d311b508a189afd58bebf3a-12905031%26mtd%3D1" target="_blank" rel="noopener noreferrer">SQLite Database System: Design and Implementation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p>注释方面</p></li> <li><ul><li>听说官方项目的注释很详尽，比书的内容都多~[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_7">7]</a></li></ul></li></ul></li></ul> <p>总结一下，相比boltdb，SQLite更有名，即使不是数据库、分布式行业从业者，也听过SQLite的鼎鼎大名，其代码质量是经受过考验的。缺点是代码规模略大，优点是资料比较多，讨论研究的人也挺多的吧，想学习当前的SQLite是不可能的，从第一个版本看起还是有可能的。</p> <h2 id="key-value-system"><a href="#key-value-system" class="header-anchor">#</a> key-value-system</h2> <p>这不是什么著名存储引擎，这只是一个玩具项目，应该是用作毕设的，我在我的Github的活动时间线[<a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_8">8]</a>中发现了它，那个时候我正愁毕设写什么，看见它就对存储引擎起了兴趣，它索引数据结构落后，甚至没有完备的持久化机制和压缩操作，但是它还是给了我很多启发。虽然没有封存，但是作者已不再开发，且很难联系上作者。</p> <p>它具备以下特性：</p> <ul><li>采用hashtable作为索引数据结构</li> <li>在索引下设计了一个缓冲池</li> <li>缓冲池支持持久化（索引不支持）</li></ul> <p>各个指标方面：</p> <ul><li><p>编程语言：纯C编写（C：100%）</p></li> <li><p>代码行数，没有发布过版本：</p></li> <li><ul><li><p>最后的<a href="https://link.zhihu.com/?target=https%3A//github.com/WadeLeng/key-value-system/commit/02cde0ceed971569a03c94da7e56d3ce71da7914" target="_blank" rel="noopener noreferrer">commit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提交与2012年2月26日</p></li> <li><ul><li>整体行数：3925[.c] + 653[.h] = 4578</li> <li>有效行数：3061[.c] + 165[.h] = 3226</li></ul></li> <li><p>去掉测试代码：</p></li> <li><ul><li>整体行数：941[.c] + 181[.h]  = 1122</li> <li>有效行数：735[.c] + 51[.h] = 786</li></ul></li></ul></li> <li><p>资料方面</p></li> <li><ul><li>只有<a href="https://link.zhihu.com/?target=https%3A//github.com/WadeLeng/key-value-system/tree/master/doc" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：分为使用、性能测试、设计文档，虽然不多，但是写得很全面，很到位</li></ul></li></ul> <p>总结一下，这是一个很简单，甚至有些过时的存储引擎，但是它很简单，代码量住够小，但是缓冲池的设计理解起来还是有点难度的。另我吃惊的是，测试代码所占的比重是如此之高，在75%以上！！着实让我感叹，测试才是数据库最重要的部分！这里推荐一下我的毕设成果<a href="https://link.zhihu.com/?target=https%3A//github.com/WangTingZheng/EdithDB" target="_blank" rel="noopener noreferrer">EdithDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，由于本人水平有限，写的项目漏洞百出，文档的话就是我的毕业论文，暂时没有公布，因为觉得没有人会看~</p> <h2 id="接下来的更新计划"><a href="#接下来的更新计划" class="header-anchor">#</a> 接下来的更新计划</h2> <ol><li><a href="https://link.zhihu.com/?target=https%3A//github.com/LMDB/lmdb" target="_blank" rel="noopener noreferrer">LMDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/google/leveldb" target="_blank" rel="noopener noreferrer">leveldb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/BohuTANG/nessDB" target="_blank" rel="noopener noreferrer">nessdb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/redis/redis" target="_blank" rel="noopener noreferrer">redis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/dgraph-io/badger" target="_blank" rel="noopener noreferrer">badger<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/roseduan/rosedb" target="_blank" rel="noopener noreferrer">rosedb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/clement/tokyo-cabinet" target="_blank" rel="noopener noreferrer">Tokyo Cabinet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ol><li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_1_0">^</a>find . -name &quot;*.c&quot;|xargs wc -l|grep &quot;total&quot;|awk '{print $1}'</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_2_0">^</a>Statistic是一个专门用来统计代码行数的插件 https://plugins.jetbrains.com/plugin/4509-statistic</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_3_0">^</a>游戏开发设计心得分享专题封面 https://www.gcores.com/collections/64</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_4_0">^</a>阿里巴巴李响加入 CNCF 技术监督委员会 https://www.infoq.cn/article/z1fl-LX3o2yGdIqG12S1</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_5_0">^</a>SQLite源代码时间线 https://www.sqlite.org/cgi/src/timeline</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_6_0">^</a>bookstack：[英文] DB Tutorial https://www.bookstack.cn/read/db_tutorial/README.md</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_7_0">^</a>还是来源于张原嘉的回答 https://www.zhihu.com/question/22819578/answer/62544197</li> <li><a href="about:reader?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F391693148#ref_8_0">^</a>当你进入github.com时，会推荐关注的人的收藏动态</li></ol> <p>发布于 07-22</p> <h3 id="文章被以下专栏收录"><a href="#文章被以下专栏收录" class="header-anchor">#</a> 文章被以下专栏收录</h3> <ul><li><a href="https://www.zhihu.com/column/c_1403853929994735616" target="_blank" rel="noopener noreferrer"><img src="https://pic2.zhimg.com/4b70deef7_xs.jpg?source=172ae18b" alt="一个存储引擎的诞生"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>​</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021/11/12 上午12:25:46</span></div></footer> <!----> </main> <div class="footer-wrapper footer"><span><a href="https://beian.miit.gov.cn/">豫ICP备20003255号</a></span> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0c0842f3.js" defer></script><script src="/assets/js/2.a6173bc2.js" defer></script><script src="/assets/js/61.1afe7d7a.js" defer></script>
  </body>
</html>
