<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>详解特征工程与推荐系统及其实践 | 小张笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-141019448-1"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
      
          gtag('config', 'UA-141019448-1');
      </script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2468672938537807" crossorigin="anonymous"></script>
    <meta name="description" content="Little Zhang's Note">
    <meta name="baidu-site-verification" content="code-HRrK6kdBX1">
    
    <link rel="preload" href="/assets/css/0.styles.ceffaf74.css" as="style"><link rel="preload" href="/assets/js/app.449dfc13.js" as="script"><link rel="preload" href="/assets/js/2.a6173bc2.js" as="script"><link rel="preload" href="/assets/js/68.fd1f0bf2.js" as="script"><link rel="prefetch" href="/assets/js/10.bf63d664.js"><link rel="prefetch" href="/assets/js/100.8bb33427.js"><link rel="prefetch" href="/assets/js/101.afd1cbca.js"><link rel="prefetch" href="/assets/js/102.e7796c10.js"><link rel="prefetch" href="/assets/js/103.281a2991.js"><link rel="prefetch" href="/assets/js/104.3f8667b5.js"><link rel="prefetch" href="/assets/js/105.d1267072.js"><link rel="prefetch" href="/assets/js/106.2babb0f3.js"><link rel="prefetch" href="/assets/js/107.d9ba2b27.js"><link rel="prefetch" href="/assets/js/108.e8b53490.js"><link rel="prefetch" href="/assets/js/109.3e3359aa.js"><link rel="prefetch" href="/assets/js/11.d2eced17.js"><link rel="prefetch" href="/assets/js/110.6f36a483.js"><link rel="prefetch" href="/assets/js/111.400bc66f.js"><link rel="prefetch" href="/assets/js/112.de9d641b.js"><link rel="prefetch" href="/assets/js/113.92478765.js"><link rel="prefetch" href="/assets/js/114.98616b1d.js"><link rel="prefetch" href="/assets/js/115.08115da4.js"><link rel="prefetch" href="/assets/js/116.8a884c76.js"><link rel="prefetch" href="/assets/js/117.dd0620a1.js"><link rel="prefetch" href="/assets/js/118.df9a29d9.js"><link rel="prefetch" href="/assets/js/119.c6c55598.js"><link rel="prefetch" href="/assets/js/12.30fbd27c.js"><link rel="prefetch" href="/assets/js/120.56e4b9b5.js"><link rel="prefetch" href="/assets/js/121.a414395d.js"><link rel="prefetch" href="/assets/js/122.2dc4ba8c.js"><link rel="prefetch" href="/assets/js/123.b9bea690.js"><link rel="prefetch" href="/assets/js/124.f90de3a9.js"><link rel="prefetch" href="/assets/js/125.eddc0b4c.js"><link rel="prefetch" href="/assets/js/126.53403b44.js"><link rel="prefetch" href="/assets/js/127.2394d09e.js"><link rel="prefetch" href="/assets/js/128.6057af80.js"><link rel="prefetch" href="/assets/js/129.e4d71a0f.js"><link rel="prefetch" href="/assets/js/13.12cd758b.js"><link rel="prefetch" href="/assets/js/130.5766d9da.js"><link rel="prefetch" href="/assets/js/131.3e359009.js"><link rel="prefetch" href="/assets/js/132.d02a0f2c.js"><link rel="prefetch" href="/assets/js/133.7a4a1482.js"><link rel="prefetch" href="/assets/js/134.e8cbf381.js"><link rel="prefetch" href="/assets/js/135.84b5b6c9.js"><link rel="prefetch" href="/assets/js/136.11a712f4.js"><link rel="prefetch" href="/assets/js/137.c56b763b.js"><link rel="prefetch" href="/assets/js/138.99380df4.js"><link rel="prefetch" href="/assets/js/139.97441cd8.js"><link rel="prefetch" href="/assets/js/14.ff09b7aa.js"><link rel="prefetch" href="/assets/js/140.385a99c9.js"><link rel="prefetch" href="/assets/js/141.757722f9.js"><link rel="prefetch" href="/assets/js/142.c670c258.js"><link rel="prefetch" href="/assets/js/143.1331cb27.js"><link rel="prefetch" href="/assets/js/144.05a0d3e8.js"><link rel="prefetch" href="/assets/js/145.0a1e6f5f.js"><link rel="prefetch" href="/assets/js/146.84c5aa55.js"><link rel="prefetch" href="/assets/js/147.fe28852c.js"><link rel="prefetch" href="/assets/js/148.b2f8fe4a.js"><link rel="prefetch" href="/assets/js/149.eb56ef7e.js"><link rel="prefetch" href="/assets/js/15.0d97466e.js"><link rel="prefetch" href="/assets/js/150.cb01f4b0.js"><link rel="prefetch" href="/assets/js/151.c2fe44db.js"><link rel="prefetch" href="/assets/js/152.38cdbe10.js"><link rel="prefetch" href="/assets/js/153.83b79388.js"><link rel="prefetch" href="/assets/js/154.1b2e2632.js"><link rel="prefetch" href="/assets/js/155.9ec4d0be.js"><link rel="prefetch" href="/assets/js/156.07cd6074.js"><link rel="prefetch" href="/assets/js/157.e6435032.js"><link rel="prefetch" href="/assets/js/158.200efa2b.js"><link rel="prefetch" href="/assets/js/159.456c0abc.js"><link rel="prefetch" href="/assets/js/16.eb3e41d4.js"><link rel="prefetch" href="/assets/js/160.99b8cd75.js"><link rel="prefetch" href="/assets/js/161.2b512783.js"><link rel="prefetch" href="/assets/js/162.1cb825a5.js"><link rel="prefetch" href="/assets/js/163.7f43ca8e.js"><link rel="prefetch" href="/assets/js/164.25356e36.js"><link rel="prefetch" href="/assets/js/165.7a0212ef.js"><link rel="prefetch" href="/assets/js/166.c2cf7290.js"><link rel="prefetch" href="/assets/js/167.30f521dd.js"><link rel="prefetch" href="/assets/js/168.aea46592.js"><link rel="prefetch" href="/assets/js/169.ac09a033.js"><link rel="prefetch" href="/assets/js/17.ba904e6e.js"><link rel="prefetch" href="/assets/js/170.790bb110.js"><link rel="prefetch" href="/assets/js/171.d6a87a53.js"><link rel="prefetch" href="/assets/js/172.3f908c2a.js"><link rel="prefetch" href="/assets/js/173.938abd06.js"><link rel="prefetch" href="/assets/js/174.a27b5c8e.js"><link rel="prefetch" href="/assets/js/175.33348ef9.js"><link rel="prefetch" href="/assets/js/176.67a2d1bd.js"><link rel="prefetch" href="/assets/js/177.207bf996.js"><link rel="prefetch" href="/assets/js/178.759cac62.js"><link rel="prefetch" href="/assets/js/179.4f0c6ccd.js"><link rel="prefetch" href="/assets/js/18.ec6ed67c.js"><link rel="prefetch" href="/assets/js/19.9695b39e.js"><link rel="prefetch" href="/assets/js/20.d9857ccc.js"><link rel="prefetch" href="/assets/js/21.5331bc2a.js"><link rel="prefetch" href="/assets/js/22.4e723398.js"><link rel="prefetch" href="/assets/js/23.922964c4.js"><link rel="prefetch" href="/assets/js/24.2db4d47a.js"><link rel="prefetch" href="/assets/js/25.3e0ebe0d.js"><link rel="prefetch" href="/assets/js/26.80f4afb8.js"><link rel="prefetch" href="/assets/js/27.9647f701.js"><link rel="prefetch" href="/assets/js/28.1fd2e4a0.js"><link rel="prefetch" href="/assets/js/29.40be5bfc.js"><link rel="prefetch" href="/assets/js/3.582414ce.js"><link rel="prefetch" href="/assets/js/30.8471dc5d.js"><link rel="prefetch" href="/assets/js/31.8333e639.js"><link rel="prefetch" href="/assets/js/32.0132cda0.js"><link rel="prefetch" href="/assets/js/33.226b28e7.js"><link rel="prefetch" href="/assets/js/34.ed0a3fc4.js"><link rel="prefetch" href="/assets/js/35.ca6c9a35.js"><link rel="prefetch" href="/assets/js/36.397a0431.js"><link rel="prefetch" href="/assets/js/37.b0f17eda.js"><link rel="prefetch" href="/assets/js/38.9320e1c8.js"><link rel="prefetch" href="/assets/js/39.b7b39a12.js"><link rel="prefetch" href="/assets/js/4.665c3627.js"><link rel="prefetch" href="/assets/js/40.9568845a.js"><link rel="prefetch" href="/assets/js/41.5be5f6b4.js"><link rel="prefetch" href="/assets/js/42.259904ec.js"><link rel="prefetch" href="/assets/js/43.4e2ee7d7.js"><link rel="prefetch" href="/assets/js/44.cc4264a0.js"><link rel="prefetch" href="/assets/js/45.66ad8c3b.js"><link rel="prefetch" href="/assets/js/46.4a339a85.js"><link rel="prefetch" href="/assets/js/47.41cc4c8b.js"><link rel="prefetch" href="/assets/js/48.b712267c.js"><link rel="prefetch" href="/assets/js/49.385d1cf1.js"><link rel="prefetch" href="/assets/js/5.b649da8c.js"><link rel="prefetch" href="/assets/js/50.6ae103f3.js"><link rel="prefetch" href="/assets/js/51.a2ec1533.js"><link rel="prefetch" href="/assets/js/52.8ef2068e.js"><link rel="prefetch" href="/assets/js/53.642e2726.js"><link rel="prefetch" href="/assets/js/54.2089cc21.js"><link rel="prefetch" href="/assets/js/55.4b6cb889.js"><link rel="prefetch" href="/assets/js/56.d5443f21.js"><link rel="prefetch" href="/assets/js/57.2eedc93a.js"><link rel="prefetch" href="/assets/js/58.45ef289d.js"><link rel="prefetch" href="/assets/js/59.2ab71f8f.js"><link rel="prefetch" href="/assets/js/6.a396de83.js"><link rel="prefetch" href="/assets/js/60.254e4725.js"><link rel="prefetch" href="/assets/js/61.9d8459f5.js"><link rel="prefetch" href="/assets/js/62.54b4f863.js"><link rel="prefetch" href="/assets/js/63.2f088967.js"><link rel="prefetch" href="/assets/js/64.a22a2b4f.js"><link rel="prefetch" href="/assets/js/65.e1c6fef4.js"><link rel="prefetch" href="/assets/js/66.33bb7f22.js"><link rel="prefetch" href="/assets/js/67.8e807291.js"><link rel="prefetch" href="/assets/js/69.d68740ca.js"><link rel="prefetch" href="/assets/js/7.03daa1b7.js"><link rel="prefetch" href="/assets/js/70.556ea243.js"><link rel="prefetch" href="/assets/js/71.3f4beb33.js"><link rel="prefetch" href="/assets/js/72.e3764731.js"><link rel="prefetch" href="/assets/js/73.d98f2232.js"><link rel="prefetch" href="/assets/js/74.34525972.js"><link rel="prefetch" href="/assets/js/75.1e8d7fdd.js"><link rel="prefetch" href="/assets/js/76.165bc994.js"><link rel="prefetch" href="/assets/js/77.fadec80a.js"><link rel="prefetch" href="/assets/js/78.db70a73d.js"><link rel="prefetch" href="/assets/js/79.98a49903.js"><link rel="prefetch" href="/assets/js/8.150af887.js"><link rel="prefetch" href="/assets/js/80.496ed396.js"><link rel="prefetch" href="/assets/js/81.3de25687.js"><link rel="prefetch" href="/assets/js/82.c62bb74c.js"><link rel="prefetch" href="/assets/js/83.c0a53afd.js"><link rel="prefetch" href="/assets/js/84.3423ca41.js"><link rel="prefetch" href="/assets/js/85.769c3844.js"><link rel="prefetch" href="/assets/js/86.e893b624.js"><link rel="prefetch" href="/assets/js/87.69ed3cea.js"><link rel="prefetch" href="/assets/js/88.6fa61ce3.js"><link rel="prefetch" href="/assets/js/89.44c4ed67.js"><link rel="prefetch" href="/assets/js/9.f7aab732.js"><link rel="prefetch" href="/assets/js/90.221e4495.js"><link rel="prefetch" href="/assets/js/91.1407d0f0.js"><link rel="prefetch" href="/assets/js/92.bf5af875.js"><link rel="prefetch" href="/assets/js/93.9ff27bac.js"><link rel="prefetch" href="/assets/js/94.b7effcde.js"><link rel="prefetch" href="/assets/js/95.07efa2a4.js"><link rel="prefetch" href="/assets/js/96.c84fd7cd.js"><link rel="prefetch" href="/assets/js/97.0e8ccb36.js"><link rel="prefetch" href="/assets/js/98.83d33fae.js"><link rel="prefetch" href="/assets/js/99.13925516.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ceffaf74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小张笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://toutiao.zhangfan.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小张头条
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/file_21/210915_详解特征工程与推荐系统及其实践.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://toutiao.zhangfan.vip" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小张头条
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/file/file_21/210915_详解特征工程与推荐系统及其实践.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>详解特征工程与推荐系统及其实践</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>11 月 13 日，云脑科技机器学习训练营正式开营，本期训练营由科赛 Kesci 联合云脑科技打造，中美大咖导师授课，精心指导学员解决机器学习中的实际问题，为人工智能行业培育高潜力人才。</p> <p>11 月 13 日，<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.kesci.com%2Fapps%2Fhome%2Fcompetition%2F5a06dd1f60680b295c20a5f4" target="_blank" rel="noopener noreferrer">云脑科技机器学习训练营<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>正式开营，本期训练营由<a href="https://link.juejin.cn/?target=www.kesci.com" target="_blank" rel="noopener noreferrer">科赛 Kesci<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 联合云脑科技打造，中美大咖导师授课，精心指导学员解决机器学习中的实际问题，为人工智能行业培育高潜力人才。</p> <p>K-Lab 在线数据分析协作平台为本次训练营提供全程支持，训练营学员可在浏览器中方便、快捷地进行数据处理、模型搭建、代码调试、撰写报告等分析工作，<strong>实现在线「报名 - AI 应用算法案例学习与实践 - 作品在线提交 - 能力测评与筛选」的一站式学习。</strong></p> <p>目前第一期大咖分享内容已出炉，以下是分享内容实录~</p> <p><strong>分享内容简介</strong></p> <p>主题：亿级用户电商平台推荐系统挑战</p> <p>主讲人：张本宇（云脑科技创始人 &amp; CEO）</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/160114fb22b5f25f~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>从事人工智能十八年的老兵，曾就职于微软亚洲研究院、Google 和 Facebook，在 AI 方面手握了 150 项美国专利，在国际一流期刊及会议上发表的 45 篇论文已被引用超过 6000 次，创新工场最新研究《AI 领域，中国人 / 华人有多牛？》中，张本宇位列 “华人前 10 位大牛科学家”。</p> <p>内容要点：</p> <ul><li>协同过滤 Collaborative Filtering</li> <li>特征工程 Feature Engineering</li> <li>推荐系统实战注意点</li></ul> <h3 id="机器学习中的特征工程"><a href="#机器学习中的特征工程" class="header-anchor">#</a> 机器学习中的特征工程</h3> <p>首先我们看一下机器学习的五大环节。</p> <p>一是特征工程。第二是算法定义和调参，就是你该选择什么样的算法，用什么样的参数进行调节。第三是数据采集和清洗，接下来是实现这个算法并进行优化。‘I’代表和业务生产系统集成，所以我们就会简称为 FaDAI 这五大步骤。特征工程是这五大环节最重要的一部分。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/1601158566ffc2e5~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>我们会简单介绍一下特征工程，以及一些常见的特征工程的方法。</p> <p>引用一下吴恩达的话：“应用机器学习其实就是在做特征工程，特征工程是非常难、耗时、也是需要专业知识的一个工作。” 我们理想中机器学习的情况：有很干净的 Raw data，然后变成可学习的 Dataset, 通过某些算法学出某些模型，然后解决一个问题，这是最理想的一个状态。但现实中，我们会有各种各样的数据，有的从数据库来，有的从日志来，有的从半结构结构化文档来，有的从无结构的音频、图片中来。从中抽取什么特征，才能够被我们机器学习所使用，从而能学习出模型解决出问题呢？</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/1601158acf733353~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/1601158dc1bde247~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <h3 id="变量类型的特征工程"><a href="#变量类型的特征工程" class="header-anchor">#</a> 变量类型的特征工程</h3> <p>接下来我们看一下针对变量类型的特征，这里实际上有几大类的变量类型。有分类型的特征变量，也有数值型的特征，还有两个比较特殊的是时间和空间，接下来我们也会一一介绍。</p> <p><strong>1. 离散型特征</strong></p> <p>对于离散型的特征枚举一些例子：你的操作系统是什么类型？有可能是桌面，有可能是平板，有可能是手机。那你的 user_id 是什么？有 121545，或者别的一些 id。 这种类型的特征是最需要特征工程的，因为它的取值空间非常巨大，经常会导致稀疏数据。所以说从效率和精度上来说，都是对模型一个巨大的挑战。</p> <p>那最简单的一个特征工程，叫做 One-Hot encoding。举例来说，platform 这个维度有三个取值：desktop、mobile、tablet。 那我们可以转换成三个特征，如果平台是在 desktop 上，那这个特征就取 1，如果在 mobile 上，那这个特征就取 1，如果在 tablet 上，那这个特征就取 1，这是一个非常稀疏的结构。举例来说，如果有十万个站点，那就十万维，这是十万维只有这一个维度上取 1，其他都取 0。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/16011596a299ab5f~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>一种比较常见的方法就是做 Hash Encoding。举例来说：有 200 多个国家，用 Hash 的方法把它转化为 100 多列，但用刚才 One-Hot 的方法就有 200 多列，但用 Hash 方式表达，参数是可调的，所以它可以缩成 100、50，甚至 10。那它会有一定的代价，比如说巴西和智利被放在一列，但是这两个国家可能有不同的特性，但他们必须 share 同样的位置。这是它们潜在的一个问题，但稀疏性是可以控制的，也可以处理低频和一些新的变量。这里隐含的条件是有一个假设，这个假设是有些特征可以 share 同一个位置。这个假设在深度学习中也会有使用。所以在实践中发现很多时候并不会影响实际的结果，只要你的参数空间相对是足够的，就是它有足够的表达能力。这个也是相对比较常见的一个方法 像有些比较知名、开源的机器学习的工具都有这样的一个功能。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/16011599dc1ae161~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>另外一个是计数型的 Encoding，就是把它变成全局的 count。比如广告 id:423654，他看了多少次，点击了多少次，直接把它转化成一个统计量，可以是观看的次数，点击的次数，广告的 CTR。就是用不同的 id，每个 id 有不同的权重，变成浮点数上的一个特征，共享一个权重。这里有一个假设，它跟全局统计有某种线性关系，或者在某个转化空间之后有线性关系。</p> <p><strong>2. 异常值</strong></p> <p>还有一个是我们关心的异常值对整个统计的影响，那我们可能就从绝对值改为一个相对值，相对值就是它排序的一个次序，比如说按 CTR 排序，最好的 CTR 有什么特征。</p> <p>最后是在神经网络中常见的做法，就是把分类变量转换为嵌入式变量，做 Embedding。比如说你有十万个不同 sites，把它投影到 64 维或者 128 维的 vector 上面，相当于原来需要十万个 Free parameters，现在只需要 64 维或 128 维。之所以能这样做，原来的十万维空间是非常稀疏的，64 维或者 128 维是更稠密的表达，所以还是有非常强的表达意义，好处就是内存需求会更少，相对来说精度也会更高。</p> <p>有同学问 Hash 和 Embedding 的区别，Embedding 本身是需要学习出来的，比如说 id1 它投影到怎样的 Embedding 空间，通过学习来获得。而哈希是通过预定义的哈希函数，直接投影过去，本身的哈希函数是不需要学习的。这里它最基础的逻辑是不一样的，Hash Encoding 也就是说你这两维特征可以 share 相同的 weight。比如说巴西和智利放在同一列中，他们有相同的权重，而 Embedding 实际上是一种 distributional 的表达方式。它的意思是说巴西可能使用 64 维上不同取值来代表，智利也是同样用这 64 维，所以这 64 维，每一列都参与表达不同的国家，每一个国家都由这 64 维来表达。它们两个的基本思路上是有所区别的。</p> <p><strong>3. 数值变量</strong></p> <p>我们现在进入到数值变量，数值变量主要有两种，一种是浮点数和一种是定点数，定点数也就是整数。很多时候数值变量也可以当成模型的直接输入来使用。但是基本上也都需要一定的特征工程，因为实践中它的取值范围会很分散，实际上对模型的影响也比较大。</p> <p>首先我们看一下缺失数据，缺失数据一种最简单的做法是转化为空白，或者 NaN，但实际上空白都会当成 0 来处理，这其实不是一种最好的表达。这时候其实更好的是使用平均值、中位值，或者模值，或者由其他模型来生成一些值。但常见来说平均值和中位值就足够好了。那第二种情况可能会做一些 rounding，就是忽略掉一些小数位上的变化，因为有时候小数位过高会是一种噪音。他本身的观测实际上没有这么高的精度，所以很多时候精度是一些更低阶的噪音带来的。或说我们希望他在某些特征上有一定的鲁棒性。比如说这个例子，它在乘 10 取整后，实际上某种程度上可以当成分类、离散型的变量，比如说 12345678910，当然它变成分类变量之后，实际上是产生了一个约束，10 一定比 9 好，9 一定比 8 好，它有个排序的次序和关系。所以这就是要看实际工作中，这样一个约束是否成立。</p> <p>然后还有一种情况是对取整的进一步拓展，二次化，0 和 1，超过 0 的就是 1，因为很多时候我们需要关注它定性上的一些特性。再做一些扩展就是做 Binning，就是做分块，离散化，切到若干个 bin 里面去，这个 bin 是等宽的，1 到 2，2 到 3，3 到 4 ，取值落到这里面的个数是多少。另外还有一种分法是落入某个桶的分法平均，尽量的平均，这样横轴就是平均的。</p> <p>还有的时候取值的范围跨度太大或太小，这时候就采用某种非线性的变化，比如说 log 的 transformation，让它在两个有 extreme 的 value range 上相对来说更 smooth 一些，更有区分力。这也是非线性的一种常用手段。虽然它非常简单，但实际上的效果是不错的。List 还有取平方或者开方。</p> <p>最后一种是对数组做一定的 normalization，有两种方法：一种是 minmax 找到最小值最大值，把他们 normalize 到 0 到 1 之间，还有一种是做一个比较标准的正态化，就是减去 mean 再除以 var，但要对数据的分布有个基本的了解。这里有另一种方法，是对数值向量做归一化，这也是为了防止数值上面一些 outlier 的点，主要还是为了数值上的稳定性。</p> <p>这里是一种特征生成的方法，比如说原始特征是 X1,X2，通过两两交互能够生成新的特征，也带来一定的非线性。后面要讲的推荐系统 FFM 本质上就是使用这样的方法。</p> <p>接下来是时间变量，本质上是一种连续值，但是实际上有一些特殊的处理，有时会忽略掉一些奇怪的问题，要注意一下。首先要注意一下时区的问题，是应该用 local 的时间还是同一时区，要根据具体问题来定，还有夏令时的问题。具体要根据场景来定。时间是连续值，很多时候也要进行分段，有时候会有一定语义的分法，比如早上，中午，晚上这样的切分。实际上对切分本身来说也可以做成有重叠的， 比如说 5 点到 9 点是 early morning，8 点到 11 点是 morning, 这样 8 点到 9 点就同时属于两个 bin，这也是可以的。第二个就是对它的某些时间趋势做一个特征，就是它所消耗的时间，上周所消耗的时间，或者是相对消耗时间上的一个变化。</p> <p><strong>4. 时间空间特征处理</strong></p> <p>还有一些场景下我们关注一些特殊的时间，比如说节假日、双十一。举例来说这些做用电量的预测，那么春节可能是一个非常强的特征。春节大城市的用电量会急剧下降，世界杯前、发工资又要做一些特殊的推荐可能是实践中需要考虑的东西。时间间隔：比如说上一次点击广告的时间，两次点击的间隔，因为会假设用户的兴趣会随着时间变量发生变化。</p> <p>和时间相对应的是空间上的变量，有可能是 GPS 坐标，也有可能是语义上的地址、邮编、城市、省，或是与特定位置的距离。很多时候地点是连续的特征流，每一秒可能都有 GPS 的坐标，他可能需要进行异常的监测，因为 GPS 并不是那么的精准可靠。也可以基于外部资源强增地点信息：包括这个区域的人口情况、收入情况等。</p> <h3 id="自然语言处理的特征工程"><a href="#自然语言处理的特征工程" class="header-anchor">#</a> 自然语言处理的特征工程</h3> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/1601159f43ac6daf~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>接下来我们看一下自然语言处理的特征工程。文本本质上也是一种分类变量，所以他会有一些传统的做法，比如说: Bag of words ,TF-IDF，也有比较新的 Embedding 或 Topic models。</p> <p>Bag of words 是 One-Hot encoding 的一种表达，TF-IDF 是对 Bag of words 的一种简单改进，它 feature 取值不仅仅取决于出现或不出现，它希望在这个 feature 的取值上能够反映这个单词对语义的相对重要性。Term Frequency 代表着一个词如果在文档中出现的次数越多，它可能的重要性越高。另外一方面，如果这个词在出现的文章个数越少，说明这个词更有区分性或者越具有代表性。 所以 TF 代表的是 Term Frequency，IDF 是 words 出现在 document 的 Frequency，两者相乘是信息检索领域对特征取值进行 re-weighting 的一种常见的方法。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/160115a281783ec1~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>有了两个文档的 TF-IDF 向量之后，就可以定义这个向量的相似性，可以用 Cosine 来定义，Cosine 可以理解为一个 normalize 的内积，把两个特征进行 L2 的正则，它们之间的关系就是内积，或者说是两个向量之间的夹角。</p> <p>Textual Similarity 是简单的进行一些定量的计算，比如说从一个文本转换成另一个文本难易程度的一个计算。Word2vec 实际上是 Embedding 的一种方法，需要定义某种损失函数来学习，最终是哪种损失函数满足最终我们所期望的损失函数。Topic models 本质上是进行某种矩阵的分解，目的是在高维的空间上进行低维的表达，能够更完整的刻画数据，这个在推荐系统上也会用到。</p> <p><strong>协同过滤与推荐系统</strong></p> <p>推荐系统是一种非常广泛的机器学习的领域，和广告系统密切相关。区别是业务上的逻辑，本质上算法可以互相借鉴。</p> <p>协同过滤本质是用别的用户来为这个用户进行推荐和过滤，假设 A 和 B 在都看过的 item 非常相似，那么 A 和 B 可能会 share 相似的 list. 比如某些 items 只有 B 看过，那么 A 很可能和 B 会有相同的喜好。Item 可能是广告、电影、音乐等等。</p> <p>举例来说绿代表喜欢，红色代表不喜欢，我们要看一下该用户对电视机的喜好程度，什么样的用户和他会比较像？我们会注意到第二个和第三个用户，我们会借鉴第二、三个用户的喜好来猜测它在电视机上的喜好，也意味着它喜欢第三个物品。</p> <p>协同过滤分为三个步骤：</p> <ul><li>用户需要对某个物品表现出他的喜好性。</li> <li>用算法去找到和他比较相似的用户。</li> <li>基于用户做一个推荐。</li></ul> <p>这是基于 user 的推荐，接下来还会举例基于 item 的推荐。</p> <p>首先他需要确定一个度量方法，可以度量 user 之间的相似性，也可以度量 item 之间的相似性。假定这样一个 item 都是使用一个特征向量的表达，那么它的相似性可以通过欧氏距离或皮尔逊相关系数来度量。欧氏距离实际上是最简单的一种度量方式，但很多时候也是非常好用的方法。</p> <p>假设两个向量是 n 维空间的两个点，那么这两个点的距离就是欧氏距离。距离我们需要转化为相似性，有时候越小越好，有时候越大越好。所以我们会用图中的一个变化。本质上是把无穷区间投影到 0，1 区间。皮尔逊系数本质上也是刻画两者之间的相似性。Cosine 也是基于内积的一个变化，如果在一个超球面上，它和欧氏距离有简单的对应关系。有了这样一个距离之后，我们可以找相似的 label，有两种找法：1. 找最近的 K 个邻居。2. 找相似性小于或大于某种程度的一些邻居。这两种方法在实践中都有使用。</p> <p>Item-item Filtering：现在有用户 ABC 和物品 ABC, 我们考虑是否要把物品 C 推荐给用户 C。我们看物品 C 和哪一个物品经常一起出现，发现是物品 A。用户 C 被推荐了物品 A，因此把物品 C 推荐给他。User-item Filtering 考虑对用户 A 进行推荐，先找到和 A 相似的可能是用户 C，看用户 C 有说明额外的物品是用户 A 不知道的，物品 D 是用户 A 不知道的，那么 D 就会推荐给 A。这两个可能是不同的维度，用哪种方法更好，也要看数据具体的特征来定。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/160115a7529d1f4f~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/160115a9703d9ab5~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>无论是哪种方法都会有一些缺点：1. 复杂度是 O(n^2) 的，会随着用户数和物品数增高。无论是用 Item-item Filtering 还是 User-item Filtering，本身 feature vector 的维度就很高，用来计算相似度或差异度的开销就会更大，会有一个 O(n) 的增长。找相似的 item 的做法有 O（n）的复杂度；2. 如何对新的用户进行推荐。</p> <p>因式分解机试图来解决带来的一些问题，这个工作是 10 年 Steffen 提出的，他从另外一个角度来增强模型，同时也取得了很好的效果。他关注点在特征间的协同作用，比如说将两两特征组合起来。举一个广告的例子，他关心的是用户是否有点击这个广告（1 或者 0），展示了用户的一些特征，国家、点击的时间、还有广告的类型，这是一个简化的数据集，使用 One-Hot encoding。</p> <p>最简单的方法是把所有特征进行 One-Hot 表达，也不对日期等别的特征进行哈希等别的方法的处理。把这样一个矩阵放回到推荐的系统中，比如用户和电影的推荐，每行代表用户和电影的关系，用户和电影都进行了 One-Hot 表达，时间做了一个 normalization，y 是好与不好。推荐系统除了协同过滤，另一种方法是把它当成回归问题，那回归问题 X 就是这些特征，y 就是 rating，最简单的一个模型就是线性回归。线性回归实际上是赋予每个特征一个权重，然后相加，再加一个先验。然后就得到一个预测值，我们希望预测值尽可能的接近真实的 y。</p> <p>当只使用原始特征时可能表达能力不够强。比如说在 USA 且今天是 Thanksgiving，这是一个非常重要的信息，我们可能需要对这样的特征进行组合然后构造新的特征。但这些组合空间可能会非常巨大，组合数是 n 方的关系。比如有 200 个国家，30 个节日，再结合其他特征如站点，相乘就会非常巨大。我们仔细观察特征组它们之间可能不是相互独立的，有一些可以 share 的参数，这些 share 的参数是一些非常重要的概念，在 Hash Encoding、CNN、RNN 上都会用到。比如说美国和 Thanksgiving 的组合，它与中国和中国的新年的组合非常有关联，所以它们俩之间可以用相同的 latent factors 进行刻画。</p> <p>找 latent factor 传统的技术是做矩阵因式分解，比如说我们有非常大的矩阵是 nm 的，我们通过找到两个 nk 和 km 的矩阵相乘可以重构出这样一个 nm 的矩阵，就是 SVD 或者 LSI，可能有不同的名词但是有相同的做法。所以这个想法就被延展到了 FFM 上面，这里最关键的想法是把 wij 定义成 vi 乘以 vj 的内积，vi 是 k 维上的一个元素，这样的一个好处是把 O(n^2) 的复杂度降到 O(n) 的复杂度。所以 wij 就不是任意的一个参数，它是受限制的一个参数。所以 FM 可以被表达成下面这样一个式子，它不在是 O(n^2) 的复杂度，而是 O(nk) 这样一个问题，k 是一个可选的参数，不会随着数据量或特征的增长而变化。计算量看起来更大了，但实际上有很多计算是重复的，通过简单的变化可以变成 O(nk) 的复杂度。</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/1/160115add8728170~tplv-t2oaga2asx-watermark.awebp" alt="img"></p> <p>总结一下它的优势：FM model 可以线性时间来计算，它可以和任何实数型的特征向量一起用，即使是在非常巨大的数据下它也可以进行一些参数估计，还可以做两阶的特征组合。</p> <p>全文完</p> <p>本文由 <a href="http://ksria.com/simpread" target="_blank" rel="noopener noreferrer">简悦 SimpRead<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 优化，用以提升阅读体验</p> <p>使用了 全新的简悦词法分析引擎 beta，<a href="http://ksria.com/simpread/docs/#/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%BC%95%E6%93%8E" target="_blank" rel="noopener noreferrer">点击查看<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>详细说明</p> <p><a href="https://juejin.cn/post/6844903518222958605#sr-toc-0" target="_blank" rel="noopener noreferrer">机器学习中的特征工程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://juejin.cn/post/6844903518222958605#sr-toc-1" target="_blank" rel="noopener noreferrer">变量类型的特征工程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://juejin.cn/post/6844903518222958605#sr-toc-2" target="_blank" rel="noopener noreferrer">自然语言处理的特征工程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022/7/8 下午2:41:42</span></div></footer> <!----> </main> <div class="footer-wrapper footer"><span><a href="https://toutiao.zhangfan.vip">小张头条</a></span> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.449dfc13.js" defer></script><script src="/assets/js/2.a6173bc2.js" defer></script><script src="/assets/js/68.fd1f0bf2.js" defer></script>
  </body>
</html>
