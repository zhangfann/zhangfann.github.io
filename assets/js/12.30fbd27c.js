(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{400:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("h2",{attrs:{id:"安装kvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装kvm"}},[s._v("#")]),s._v(" 安装kvm")]),s._v(" "),a("p",[s._v("https://computingforgeeks.com/use-open-vswitch-bridge-on-kvm-virtual-machines/")]),s._v(" "),a("p",[s._v("sudo apt -y install qemu-kvm libvirt-daemon-system virt-top libvirt-daemon bridge-utils libosinfo-bin virtinst libguestfs-tools")]),s._v(" "),a("p",[s._v("; 检查安装情况")]),s._v(" "),a("p",[s._v("lsmod| grep kvm")]),s._v(" "),a("p",[s._v("service libvirtd status")]),s._v(" "),a("h2",{attrs:{id:"配置桥接网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置桥接网络"}},[s._v("#")]),s._v(" 配置桥接网络")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# input:")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       kvm网桥 br0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       宿主机网卡 enp3s0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       宿主机ip/网关 192.168.9.4 192.168.9.1")]),s._v("\n\nbrctl addbr br0\n\nbrctl addif br0 enp3s0\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v(" br0 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".9.4/24 up\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v(" enp3s0 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" up\n\nroute "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" default gw "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".9.1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#vim /etc/resolv.conf")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       nameserver 114.114.114.114")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h1",{attrs:{id:"安装虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装虚拟机"}},[s._v("#")]),s._v(" 安装虚拟机")]),s._v(" "),a("h2",{attrs:{id:"安装镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装镜像"}},[s._v("#")]),s._v(" 安装镜像")]),s._v(" "),a("p",[s._v("https://computingforgeeks.com/use-open-vswitch-bridge-on-kvm-virtual-machines/")]),s._v(" "),a("p",[s._v("升级e2fsck修复16.04")]),s._v(" "),a("p",[s._v("https://askubuntu.com/questions/1053404/e2fsck-how-to-handle-the-metadata-csum-error-by-advancing-the-e2fsck-version?noredirect=1&lq=1")]),s._v(" "),a("p",[s._v("dpkg -i e2fslibs_1.43.5-1_amd64.deb")]),s._v(" "),a("p",[s._v("dpkg -i e2fsprogs_1.43.5-1_amd64.deb")]),s._v(" "),a("h2",{attrs:{id:"显示基本os镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显示基本os镜像"}},[s._v("#")]),s._v(" 显示基本os镜像")]),s._v(" "),a("p",[s._v("virt-builder -l")]),s._v(" "),a("h2",{attrs:{id:"构建基础镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建基础镜像"}},[s._v("#")]),s._v(" 构建基础镜像")]),s._v(" "),a("p",[s._v("virt-builder ubuntu-18.04 --format qcow2 \\")]),s._v(" "),a("p",[s._v("--size 10G -o /var/lib/libvirt/images/ubuntu-18.04.qcow2 \\")]),s._v(" "),a("p",[s._v("--root-password password:enri123")]),s._v(" "),a("h2",{attrs:{id:"安装虚拟机-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装虚拟机-2"}},[s._v("#")]),s._v(" 安装虚拟机")]),s._v(" "),a("p",[s._v("virt-install \\")]),s._v(" "),a("p",[s._v("--name ubuntu-18.04 \\")]),s._v(" "),a("p",[s._v("--ram 2048 \\")]),s._v(" "),a("p",[s._v("--disk path=/var/lib/libvirt/images/ubuntu-18.04.qcow2 \\")]),s._v(" "),a("p",[s._v("--vcpus 2 \\")]),s._v(" "),a("p",[s._v("--os-type linux \\")]),s._v(" "),a("p",[s._v("--os-variant generic \\")]),s._v(" "),a("p",[s._v("--network bridge:br0 \\")]),s._v(" "),a("p",[s._v("--graphics none \\")]),s._v(" "),a("p",[s._v("--console pty,target_type=serial \\")]),s._v(" "),a("p",[s._v("--boot hd \\")]),s._v(" "),a("p",[s._v("--import")]),s._v(" "),a("h2",{attrs:{id:"配置console连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置console连接"}},[s._v("#")]),s._v(" 配置console连接")]),s._v(" "),a("p",[s._v("https://www.server-world.info/en/note?os=Ubuntu_18.04&p=kvm&f=2")]),s._v(" "),a("p",[s._v("guestmount -d ubuntu-18.04 -i /mnt")]),s._v(" "),a("p",[s._v("ln -s /mnt/lib/systemd/system/getty@.service /mnt/etc/systemd/system/getty.target.wants/getty@ttyS0.service")]),s._v(" "),a("p",[s._v("umount /mnt")]),s._v(" "),a("h1",{attrs:{id:"删除虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除虚拟机"}},[s._v("#")]),s._v(" 删除虚拟机")]),s._v(" "),a("p",[s._v("virsh destroy ubuntu-18.04")]),s._v(" "),a("p",[s._v("virsh undefine ubuntu-18.04")])])}),[],!1,null,null,null);t.default=n.exports}}]);