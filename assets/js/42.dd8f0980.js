(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{506:function(s,n,e){"use strict";e.r(n);var a=e(42),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("掘金是一个帮助开发者成长的社区，是给开发者用的 Hacker News，给设计师用的 Designer News，和给产品经理用的 Medium。")]),s._v(" "),e("ol",[e("li",[s._v("分解需求\n技术栈\n考虑到后续招人和现有人员的技术栈，选择 Vue 作为框架。")])]),s._v(" "),e("p",[s._v("公司主要业务是 GIS 和 BIM，通常开发一些中大型的系统，所以 vue-router 和 vuex 都是必不可少的。")]),s._v(" "),e("p",[s._v("放弃了 Element UI 选择了 Ant Design Vue（最近 Element 好像复活了，麻蛋）。")]),s._v(" "),e("p",[s._v("工具库选择 lodash。")]),s._v(" "),e("p",[s._v("建立脚手架\n搭建 NPM 私服。")]),s._v(" "),e("p",[s._v("使用 Node 环境开发 CLI 工具，参考我自己写过的一篇 -【 搭建自己的脚手架—“优雅” 生成前端工程】。")]),s._v(" "),e("p",[s._v("基于 @vue/cli 搭建基础的模板（大家都比较了解，节省开发时间，远胜于从零开始搭建）。")]),s._v(" "),e("p",[s._v("根据业务需求定义各种开发中可能用到的功能（组件库、状态管理、过滤器、指令、CSS 内置变量、CSS Mixins、表单验证、工具函数等）。")]),s._v(" "),e("p",[s._v("性能优化，例如对 Ant Design Vue 组件库的优化。")]),s._v(" "),e("p",[s._v("开发规范\n对代码风格、命名规则、目录结构进行统一规范。")]),s._v(" "),e("p",[s._v("静态资源的使用规范。")]),s._v(" "),e("p",[s._v("单元测试、提交线上测试规范。")]),s._v(" "),e("p",[s._v("Git 提交记录和多人协作规范。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("样式\nCSS 预处理器的选择\nSass/Scss ✅\nLess ✅\nStylus ⭕\n为什么选择了两个？因为公司团队跟倾向于使用 scss 开发，less 是为了覆盖 ant design vue 的样式，stylus 只有我自己喜欢这种风格。")])]),s._v(" "),e("p",[s._v("局部样式与全局样式\n局部样式\n一般都是使用 scoped 方案：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<style lang="scss" scoped>\n  ...\n</style>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("复制代码\n全局样式\n全局样式 目录：@/styles")]),s._v(" "),e("p",[s._v("variable.scss: 全局变量管理 mixins.scss: 全局 Mixins 管理 global.scss: 全局样式")]),s._v(" "),e("p",[s._v("其中 variable.scss 和 mixins.scss 会优先于 global.css 加载，并且可以不通过 import 的方式在项目中任何位置使用这些变量和 mixins。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n  css: {\n    loaderOptions: {\n      sass: {\n        prependData: `\n        @import '@/styles/variable.scss';\n        @import '@/styles/mixins.scss';\n        `,\n      },\n    },\n  },\n}\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("体验优化\n页面载入进度条\n使用 nprogress 对路由跳转时做一个伪进度条，这样做在网络不好的情况下可以让用户知道页面已经在加载了：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import NProgress from 'nprogress';\n\nrouter.beforeEach(() => {\n  NProgress.start();\n});\n\nrouter.afterEach(() => {\n  NProgress.done();\n});\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("复制代码\n美化滚动条\n一直用 Mac 做前端，突然发现同事的 Windows 上出现了十分丑陋的滚动条，为了保持一致：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n}\n\n::-webkit-scrollbar-track {\n  width: 6px;\n  background: rgba(#101F1C, 0.1);\n  -webkit-border-radius: 2em;\n  -moz-border-radius: 2em;\n  border-radius: 2em;\n}\n\n::-webkit-scrollbar-thumb {\n  background-color: rgba(#101F1C, 0.5);\n  background-clip: padding-box;\n  min-height: 28px;\n  -webkit-border-radius: 2em;\n  -moz-border-radius: 2em;\n  border-radius: 2em;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background-color: rgba(#101F1C, 1);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br")])]),e("p",[s._v("复制代码\n静态资源加载页面\n首次加载页面时，会产生大量的白屏时间，这时做一个 loading 效果看起来会很友好，其实很简单，直接在 public/index.html 里写一些静态的样式即可。")]),s._v(" "),e("p",[s._v("移动端 100vh 问题\n在移动端使用 100vh 时，发现在 Chrome、Safari 浏览器中，因为浏览器栏和一些导航栏、链接栏导致不一样的呈现：")]),s._v(" "),e("p",[s._v("你以为的 100vh === 视口高度")]),s._v(" "),e("p",[s._v("实际上 100vh === 视口高度 + 浏览器工具栏（地址栏等等）的高度")]),s._v(" "),e("p",[s._v("解决方案\n安装 vh-check npm install vh-check --save")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import vhCheck from 'vh-check';\nvhCheck('browser-address-bar');\n复制代码\n定义一个 CSS Mixin\n\n@mixin vh($height: 100vh) {\n  height: $height;\n  height: calc(#{$height} - var(--browser-address-bar, 0px));\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("复制代码\n之后就是哪里不会点哪里。")]),s._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[s._v("组件库\n因为 Element UI 长期没更新，并且之前使用过 React 的 Ant Design（重点），所以组件库选择了 Ant Design Vue。")])]),s._v(" "),e("p",[s._v("覆盖 Ant Design Vue 样式\n设计师眼中的 Ant Design === '丑'（心酸）。")]),s._v(" "),e("ol",[e("li",[s._v("使用 .less 文件\nAnt Design Vue 的样式使用了 Less 作为开发语言，并定义了一系列全局 / 组件的样式变量，所以需要安装了 less、less-loader，在 @/styles/antd-theme.less 可以覆盖默认样式。")])]),s._v(" "),e("p",[s._v("优点是：")]),s._v(" "),e("p",[s._v("方便快捷，可以修改 class，覆盖默认变量。")]),s._v(" "),e("p",[s._v("缺点是：")]),s._v(" "),e("p",[s._v("必须引入 @import '~ant-design-vue/dist/antd.less'; ，引入后会将所有的组件样式全部引入，导致打包后的 css 体积达到 500kb 左右。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("使用 JavaScript 对象\n通过 JavaScript 对象的方式可以修改内置变量，需要对 Less 进行配置：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const modifyVars = require('./src/styles/antdTheme.js');\n\nmodule.exports = {\n  css: {\n    loaderOptions: {\n      less: {\n        lessOptions: {\n          javascriptEnabled: true,\n          modifyVars,\n        },\n      },\n    },\n  },\n}\n复制代码\n这一步还可以继续优化，通过 babel-plugin-import 使 Ant Design Vue 的组件样式可以按需加载：\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n  presets: [\n    '@vue/cli-plugin-babel/preset',\n  ],\n  plugins: [\n    [\n      'import',\n      { libraryName: 'ant-design-vue', libraryDirectory: 'es', style: true },\n    ],\n  ],\n};\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("优点是：")]),s._v(" "),e("p",[s._v("可以按需引入，打包后的 CSS 体积取决于你引用了多少个组件。")]),s._v(" "),e("p",[s._v("缺点是：")]),s._v(" "),e("p",[s._v("不能使用 class 进行样式覆盖。")]),s._v(" "),e("p",[s._v("干掉无用的图标\nAnt Design Vue 把所有的 Icon 一次性引入（不管你因用了多少个组件），这使得体积打包后图标所占的体积竟然有几百 kb 之多。这些图标大多数不会被设计师所采纳，所以部分图标都应该被干掉：")]),s._v(" "),e("p",[s._v("创建一个 icons.js 来管理 Ant Design Vue 图标，这里以一个 Loading 图标为例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("export { default as LoadingOutline } from '@ant-design/icons/lib/outline/LoadingOutline';\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("如何知道你要加载的图标在什么路径下？")]),s._v(" "),e("p",[s._v("在 @ant-design/icons/lib 目录下有三种风格的图标，分别是 fill、outline、twotone，这里面内部的文件并不是 svg 格式，而是 js 和 ts 格式，这就是为什么我们可以这么引入图标的关键所在了。")]),s._v(" "),e("p",[s._v("下一步是通过配置 vue.config.js 将这个文件引入进来：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n  configureWebpack: {\n    resolve: {\n      alias: {\n        '@ant-design/icons/lib/dist$': path.resolve(__dirname, './src/assets/icons.js'),\n      },\n    },\n  },\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("复制代码\n解决 Moment 多国语\n解决到这之后，Ant Design Vue 居然还很大，这是因为 moment 是 Ant Design Vue 中有强依赖该插件，所以使用 webpack 插件减小打包体积，这里我们只保留 zh-cn 语言包：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n  chainWebpack: (config) => {\n    config\n      .plugin('ContextReplacementPlugin')\n      .use(webpack.ContextReplacementPlugin, [/moment[/\\\\]locale$/, /zh-cn/]);\n  },\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("复制代码\n部分组件需要在页面内引用\nAnt Design Vue 中部分体积较大的组件，例如 DatePicker，根据业务需求，应考虑在页面中进行加载，尽量保证首屏加载的速度：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<script>\nimport { DatePicker } from 'ant-design-vue';\nexport default {\n  components: {\n    ADatePicker: DatePicker,\n  },\n}\n<\/script>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("复制代码\n4. 静态资源与图标\n静态资源\n所有的静态资源文件都会上传到 阿里云 OSS 上，所以在环境变量上加以区分。")]),s._v(" "),e("p",[s._v(".env.development 与 .env.production 的 VUE_APP_STATIC_URL 属性分别配置了本地的静态资源服务器地址和线上 OSS 的地址。")]),s._v(" "),e("p",[s._v("本地的静态资源服务器是通过 pm2 + http-server 创建的，设计师切完直接扔进来就好了。")]),s._v(" "),e("p",[s._v("自动注册 Svg 图标\n在日常的开发中，总是会有着大量的图标需要使用，这里我们直接选择使用 SVG 图标。但是如果每次使用图标还需要通过路径找到这张图标岂不是很麻烦？")]),s._v(" "),e("p",[s._v("下面这种才是我想要的方案（直接 name 等于 文件名即可）：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<template>\n\t<svg name="logo" />\n</template>\n复制代码\n而且最后打包后需要合并成一张雪碧图。\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("首先需要对 @/assets/icons 文件夹下的 svg 图标进行自动注册，需要对 webpack 和 svg-sprite-loader 进行了相关设置，文件全部打包成 svg-sprite。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n  chainWebpack: (config) => {\n    config.module\n      .rule('svg')\n      .exclude.add(resolve('src/assets/icons'))\n      .end();\n\n    config.module\n      .rule('icons')\n      .test(/\\.svg$/)\n      .include.add(resolve('src/assets/icons'))\n      .end()\n      .use('svg-sprite-loader')\n      .loader('svg-sprite-loader');\n  },\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("p",[s._v("复制代码\n写一个全局用的 Vue 组件 "),e("m-svg"),s._v(":")],1),s._v(" "),e("p",[s._v("// @/components/m-svg/index.js")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const requireAll = (requireContext) => requireContext.keys().map(requireContext);\nconst req = require.context('@/assets/icons', false, /\\.svg$/);\nrequireAll(req);\n复制代码\n@/components/m-svg/index.vue\n\n<template>\n  <svg aria-hidden=\"true\">\n    <use :xlink:href=\"iconName\"></use>\n  </svg>\n</template>\n<script>\nexport default {\n  name: 'm-svg',\n  props: {\n    name: { type: String, default: '' },\n  },\n  computed: {\n    iconName() {\n      return `#${this.name}`;\n    },\n  },\n};\n<\/script>\n<style lang=\"scss\" scoped>\n.mw-svg {\n  width: 1.4em;\n  height: 1.4em;\n  fill: currentColor;\n  overflow: hidden;\n  line-height: 1em;\n  display: inline-block;\n}\n</style>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("p",[s._v("复制代码\n参数 name")]),s._v(" "),e("p",[s._v("类型：String\n默认值：null\n说明：放置在 @/assets/icons 文件夹下的文件名\n样式")]),s._v(" "),e("p",[s._v("图标的大小可以通过 width + height 属性改变。\n通过改变 font-size 属性改变，宽高 = font-zise * 1.4\n5. 异步请求\n封装 Axios\n在 @/libs/request.js 路径下对 Axios 进行封装，封装了请求参数，请求头，以及错误提示信息、 request 拦截器、response 拦截器、统一的错误处理、baseURL 设置等。")]),s._v(" "),e("p",[s._v("废话不说直接贴代码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import axios from 'axios';\nimport get from 'lodash/get';\nimport storage from 'store';\n\nconst request = axios.create({\n \n baseURL: process.env.VUE_APP_BASE_URL,\n timeout: 10000, \n});\n\n\nconst errorHandler = (error) => {\n const status = get(error, 'response.status');\n switch (status) {\n   \n   case 400: error.message = '请求错误'; break;\n   case 401: error.message = '未授权，请登录'; break;\n   case 403: error.message = '拒绝访问'; break;\n   case 404: error.message = `请求地址出错: ${error.response.config.url}`; break;\n   case 408: error.message = '请求超时'; break;\n   case 500: error.message = '服务器内部错误'; break;\n   case 501: error.message = '服务未实现'; break;\n   case 502: error.message = '网关错误'; break;\n   case 503: error.message = '服务不可用'; break;\n   case 504: error.message = '网关超时'; break;\n   case 505: error.message = 'HTTP版本不受支持'; break;\n   default: break;\n   \n }\n return Promise.reject(error);\n};\n\n\nrequest.interceptors.request.use((config) => {\n \n \n \n config.headers.Authorization = `bearer ${storage.get('ACCESS_TOKEN')}`;\n return config;\n}, errorHandler);\n\n\nrequest.interceptors.response.use((response) => {\n const dataAxios = response.data;\n \n const { code } = dataAxios;\n \n if (code === undefined) {\n   \n   return dataAxios;\n \n } else {\n   \n   switch (code) {\n     case 200:\n       \n       return dataAxios.data;\n     case 'xxx':\n       \n       return 'xxx';\n     default:\n       \n       return '不是正确的code';\n   }\n }\n}, errorHandler);\n\nexport default request;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br")])]),e("p",[s._v("复制代码\n通过 VUE_APP_BASE_URL 区分线上与开发环境的 API 地址。\ncode 起到一个比较关键的作用，例如 token 过期时的验证。\n使用了一个叫 sotre 的包作为本地储存的工具用来存储 token。\n跨域问题\n跨域问题一般情况直接找后端解决了，你要是不好意思打扰他们的话，可以用 devServer 提供的 proxy 代理：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("devServer: {\n  proxy: {\n    '/api': {\n      target: 'http://47.100.186.132/your-path/api',\n      ws: true,\n      changeOrigin: true,\n      pathRewrite: {\n        '^/api': ''\n      }\n    }\n  }\n}\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("Mock 数据\n一个很常见的情况，后端接口没出来，前端在这干瞪眼。")]),s._v(" "),e("p",[s._v("Mock 数据功能是基于 mock.js (opens new window) 开发，通过 webpack 进行自动加载 mock 配置文件。")]),s._v(" "),e("p",[s._v("规则\n所有的 mock 配置文件均应放置在 @/mock/services 路径内。\n在 @/mock/services 内部可以建立业务相关的文件夹分类存放配置文件。\n所有的配置文件应按照 ***.mock.js 的命名规范创建。\n配置文件使用 ES6 Module 导出 export default 或 export 一个数组。\n入口文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import Mock from 'mockjs';\n\nMock.setup({\n  timeout: '500-800',\n});\n\nconst context = require.context('./services', true, /\\.mock.js$/);\n\ncontext.keys().forEach((key) => {\n  Object.keys(context(key)).forEach((paramKey) => {\n    Mock.mock(...context(key)[paramKey]);\n  });\n});\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("示例模板")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import Mock from 'mockjs';\n\nconst { Random } = Mock;\n\nexport default [\n  RegExp('/example.*'),\n  'get',\n  {\n    'range|50-100': 50,\n    'data|10': [\n      {\n        \n        id: '@guid()',\n        \n        cname: '@cname()',\n        \n        url: '@url()',\n        \n        county: Mock.mock('@county(true)'),\n        \n        'array|1': ['A', 'B', 'C', 'D', 'E'],\n        \n        time: '@datetime()',\n        \n        image: Random.dataImage('200x100', 'Mock Image'),\n      },\n    ],\n  },\n];\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br")])]),e("p",[s._v("复制代码\n6. 路由\nLayout\n布局暂时分为三大类：")]),s._v(" "),e("p",[s._v("frameIn：基于 BasicLayout，通常需要登录或权限认证的路由。")]),s._v(" "),e("p",[s._v("frameOut：不需要动态判断权限的路由，如登录页或通用页面。")]),s._v(" "),e("p",[s._v("errorPage：例如 404。")]),s._v(" "),e("p",[s._v("权限验证\n通过获取当前用户的权限去比对路由表，生成当前用户具的权限可访问的路由表，通过 router.addRoutes 动态挂载到 router 上。")]),s._v(" "),e("p",[s._v("判断页面是否需要登陆状态，需要则跳转到 /user/login\n本地存储中不存在 token 则跳转到 /user/login\n如果存在 token，用户信息不存在，自动调用 vuex '/system/user/getInfo'\n在路由中，集成了权限验证的功能，需要为页面增加权限时，在 meta 下添加相应的 key：")]),s._v(" "),e("p",[s._v("auth\n类型：Boolean\n说明：当 auth 为 true 时，此页面需要进行登陆权限验证，只针对 frameIn 路由有效。\npermissions\n类型：Object\n说明：permissions 每一个 key 对应权限功能的验证，当 key 的值为 true 时，代表具有权限，若 key 为 false，配合 v-permission 指令，可以隐藏相应的 DOM。\n在这里贴一下路由跳转时权限验证的代码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import router from '@/router';\nimport store from '@/store';\nimport storage from 'store';\nimport util from '@/libs/utils';\n\n\nimport NProgress from 'nprogress';\nimport 'nprogress/nprogress.css';\n\nconst loginRoutePath = '/user/login';\nconst defaultRoutePath = '/home';\n\n\nrouter.beforeEach(async (to, from, next) => {\n  \n  NProgress.start();\n  \n  if (to.matched.some((r) => r.meta.auth)) {\n    \n    const token = storage.get('ACCESS_TOKEN');\n    if (token && token !== 'undefined') {\n      \n      if (to.path === loginRoutePath) {\n        next({ path: defaultRoutePath });\n        \n      } else if (Object.keys(store.state.system.user.info).length === 0) {\n        store.dispatch('system/user/getInfo').then(() => {\n          next();\n        });\n      } else {\n        next();\n      }\n    } else {\n      \n      \n      next({\n        name: 'Login',\n        query: {\n          redirect: to.fullPath,\n        },\n      });\n      NProgress.done();\n    }\n  } else {\n    \n    next();\n  }\n});\n\nrouter.afterEach((to) => {\n  \n  NProgress.done();\n  util.title(to.meta.title);\n});\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br")])]),e("p",[s._v("复制代码\n页面开发\n根据业务需要划分，按照路由层级在 views 中创建相对应的页面组件，以文件夹的形式创建，并在文件夹内创建 index.vue 文件作为页面的入口文件。\n页面内的组件：在页面文件夹下创建 components 文件夹，在其内部对应创建相应的组件文件，如果是复杂组件，应以文件夹的形式创建组件。\n工具模块：能够高度抽象的工具模块，应创建在 @/src/libs 内创建 js 文件。\n7、构建优化\n包分析工具\n构建代码之后，到底是什么占用了这么多空间？靠直觉猜测或者使用 webpack-bundle-analyzer。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const WebpackBundleAnalyzer = require('webpack-bundle-analyzer');\n\nmodule.exports = {\n  chainWebpack: (config) => {\n    if (process.env.use_analyzer) {\n      config\n        .plugin('webpack-bundle-analyzer')\n        .use(WebpackBundleAnalyzer.BundleAnalyzerPlugin);\n    }\n  },\n};\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("复制代码\n开启 Gzip\n对，这这么一句话，后端就得支持你的 .gz 文件了，而你只需要坐着等老板夸：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chainWebpack: (config) => {\n  config\n    .plugin('CompressionPlugin')\n    .use(CompressionPlugin, []);\n},\n复制代码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("路由懒加载\n这块 @vue/cli 已经帮忙处理好了，但也需要了解一下他的原理和如何配置。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("{\n  path: 'home',\n  name: 'Home',\n  component: () => import(\n     '@/views/home/index.vue'\n  ),\n},\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("复制代码\nwebpackChunkName 这条注释还是很有必要加的，至少你打包后知道又是哪个页面变得又臭又大。")]),s._v(" "),e("p",[s._v("Preload & Prefetch\n不清楚这两个功能的去 @vue/cli 补课，这两个功能非常有助于你处理加载的性能。")]),s._v(" "),e("ol",{attrs:{start:"8"}},[e("li",[s._v("测试框架\n直接使用了官方提供的 Vue Test Utils，这东西可以对组件进行测试，很不错。")])]),s._v(" "),e("p",[s._v("写单元测试在团队里其实很难推进，不知道大家怎么看。")]),s._v(" "),e("ol",{attrs:{start:"9"}},[e("li",[s._v("组件库\n对于很多第三方的工具，我坚持认为二次封装成 vue 插件并没有多少开发成本，反而让你在后续的开发中变得很灵活。")])]),s._v(" "),e("p",[s._v("我对以下库进行了 vue 插件的封装，并提交到 npm 私服：")]),s._v(" "),e("p",[s._v("数字动画\n代码高亮\n大文件上传（切片、断点续传、秒传）需要与后端配合\n图片预览\nExcel 导入导出\n富文本编辑器\nMarkdown 编辑器\n代码编辑器\n大文件上传有兴趣的可以留言，我后续单独拎出来详细的写一下这块。")]),s._v(" "),e("p",[s._v("10.Vuex\n内置一些功能，主要是对以下这些功能做了一些封装：")]),s._v(" "),e("p",[s._v("用户信息管理（储存信息、对 token 进行操作等）")]),s._v(" "),e("p",[s._v("登陆（调接口）")]),s._v(" "),e("p",[s._v("菜单管理（储存路由信息，生成菜单，模糊查询等功能）")]),s._v(" "),e("p",[s._v("UA 信息")]),s._v(" "),e("p",[s._v("全屏操作")]),s._v(" "),e("p",[s._v("Loading")]),s._v(" "),e("p",[s._v("日志管理（消息提醒、日志留存、日志上报）")]),s._v(" "),e("ol",{attrs:{start:"11"}},[e("li",[s._v("过滤器\n过滤器是 Vue 提供的一个很好用的功能，听说 vue3 没了？")])]),s._v(" "),e("p",[s._v(s._s(s._f("capitalize")(s.message))+"\n复制代码\n我写了几个常用的过滤器：")]),s._v(" "),e("p",[s._v("日期时间\n剩余时间\n区分环境的链接（主要针对本地静态资源服务器和 OSS ）\n文件大小\n数字金额\n浮点型精度\n12. 指令\n自定义指令可以提供很好的帮助：")]),s._v(" "),e("p",[s._v("组件权限验证\n文本复制\n快捷键绑定\n滚动至指定位置\n图片懒加载\n焦点\n13. 开发规范\nESLint\n不管是多人合作还是个人项目，代码规范都是很重要的。这样做不仅可以很大程度地避免基本语法错误，也保证了代码的可读性。")]),s._v(" "),e("p",[s._v("这里我们采用了 Airbnb JavaScript Style Guide。")]),s._v(" "),e("p",[s._v("这套规范给我的感觉就是 很严谨！")]),s._v(" "),e("p",[s._v("CSS 规范\n降低选择器复杂性\n浏览器读取选择器，遵循的原则是从选择器的右边到左边读取。")]),s._v(" "),e("p",[s._v("#block .text p {\ncolor: red;\n}\n复制代码\n查找所有 P 元素。\n查找结果 1 中的元素是否有类名为 text 的父元素\n查找结果 2 中的元素是否有 id 为 block 的父元素\n选择器优先级\n内联 > ID 选择器 > 类选择器 > 标签选择器")]),s._v(" "),e("p",[s._v("选择器越短越好。\n尽量使用高优先级的选择器，例如 ID 和类选择器。\n避免使用通配符 *。\n使用 flexbox\n在早期的 CSS 布局方式中我们能对元素实行绝对定位、相对定位或浮动定位。而现在，我们有了新的布局方式 flexbox，它比起早期的布局方式来说有个优势，那就是性能比较好。不过 flexbox 兼容性还是有点问题，不是所有浏览器都支持它，所以要谨慎使用。 各浏览器兼容性：")]),s._v(" "),e("p",[s._v("Chrome 29+\nFirefox 28+\nInternet Explorer 11\nOpera 17+\nSafari 6.1+ (prefixed with -webkit-)\nAndroid 4.4+\niOS 7.1+ (prefixed with -webkit-)\n动画性能优化\n在 CSS 中，transforms 和 opacity 这两个属性更改不会触发重排与重绘，它们是可以由合成器（composite）单独处理的属性。")]),s._v(" "),e("p",[s._v("属性值\n当数值为 0 - 1 之间的小数时，建议省略整数部分的 0。\n当长度为 0 时建议省略单位。\n建议不使用命名色值。\n建议当元素需要撑起高度以包含内部的浮动元素时，通过对伪类设置 clear 或触发 BFC 的方式进行 clearfix。尽量不使用增加空标签的方式。\n除公共样式之外，在业务代码中尽量不能使用 !important。\n建议将 z-index 进行分层，对文档流外绝对定位元素的视觉层级关系进行管理。\n字体排版\n字号应不小于 12px（PC 端）。\nfont-weight 属性建议使用数值方式描述。\nline-height 在定义文本段落时，应使用数值。\nVue 代码规范\n常规\n当在组件中使用 data 属性的时候 (除了 new Vue 外的任何地方)，它的值必须是返回一个对象的函数 data() { return {...} }。")]),s._v(" "),e("p",[s._v("prop 的定义应该尽量详细，至少需要指定其类型。")]),s._v(" "),e("p",[s._v("布尔类型的 attribute， 为 true 时直接写属性值。")]),s._v(" "),e("p",[s._v("不要在 computed 中对 vue 变量进行操作。")]),s._v(" "),e("p",[s._v("应该优先通过 prop 和事件进行父子组件之间的通信，而不是 this.$parent 或改变 prop。")]),s._v(" "),e("p",[s._v("在组件上总是必须用 key 配合 v-for，以便维护内部组件及其子树的状态。")]),s._v(" "),e("p",[s._v("v-if 和 v-for 不能同时使用")]),s._v(" "),e("p",[s._v("公共方法尽量不要挂到原型上, 可以写在 utils 文件，也可以使用 mixin 文件。不要将业务公共组件注册到全局。")]),s._v(" "),e("p",[s._v("不要将任何第三方插件挂载到 vue 原型上。")]),s._v(" "),e("p",[s._v("具有高度通用性的方法，要封装到 libs、全局组件或指令集里。")]),s._v(" "),e("p",[s._v("为组件样式设置作用域。")]),s._v(" "),e("p",[s._v("尽量使用指令缩写。")]),s._v(" "),e("p",[s._v("vuex\nState (opens new window) 为单一状态树，在 state 中需要定义我们所需要管理的数组、对象、字符串等等，只有在这里定义了，在 vue 的组件中才能获取你定义的这个对象的状态。")]),s._v(" "),e("p",[s._v("修改 state 中数据必须通过 mutations。\n每一个可能发生改变的 state 必须同步创建一条或多条用来改变它的 mutations。\n服务端获取的数据存放在 state 中，作为原始数据保留，不可变动。\nGetters (opens new window) 有点类似 vue.js 的计算属性，当我们需要从 store 的 state 中派生出一些状态，那么我们就需要使用 getters，getters 会接收 state 作为第一个参数，而且 getters 的返回值会根据它的依赖被缓存起来，只有 getters 中的依赖值（state 中的某个需要派生状态的值）发生改变的时候才会被重新计算。")]),s._v(" "),e("p",[s._v("通过 getters 处理你需要得到的数据格式，而不是通过修改 state 原始数据。")]),s._v(" "),e("p",[s._v("组件内不强制使用 mapGetters，因为你可能需要使用 getter 和 setter。")]),s._v(" "),e("p",[s._v("改变 state 的唯一方法就是提交 mutations (opens new window)。")]),s._v(" "),e("p",[s._v("组件内使用 mapMutations 辅助函数将组件中的 methods 映射为 store.commit 调用。")]),s._v(" "),e("p",[s._v("命名采用 大写字母 + 下划线 的规则。")]),s._v(" "),e("p",[s._v("定义 CLEAR，以确保路由切换时可以初始化数据。")]),s._v(" "),e("p",[s._v("Actions")]),s._v(" "),e("p",[s._v("页面重的数据接口尽量在 actions (opens new window) 中调用。\n服务端返回的数据尽量不作处理，保留原始数据。\n获取到的数据必须通过调用 mutations 改变 state。\nModules")]),s._v(" "),e("p",[s._v("通常情况下按照页面划分 modules (opens new window)。\n默认内置了 system 保证了脚手架的基础功能。\n每个页面模块或页面的子模块添加属性 namespaced: true。\n14. 完成详细的使用文档\n不论是功能还是组件库等等的工具，都需要完善的文档提供查阅，即使是轮子的构建者，也抵不住时间长了会忘记许多细节。")]),s._v(" "),e("p",[s._v("这里我使用 vuepress 构建文档，方便快捷。")]),s._v(" "),e("p",[s._v("参考【拯救懒癌文档君 - VuePress + Travis CI + Github Pages 自动线上生成文档】")]),s._v(" "),e("p",[s._v("15.Git 多人协作流程\n公司使用内部搭建的 GitLab 托管代码")]),s._v(" "),e("p",[s._v("Root 仓库\n项目启动时，由项目管理者搭建起最原始的仓库，称为 Root 仓库（源仓库）。")]),s._v(" "),e("p",[s._v("源仓库的有个作用 :")]),s._v(" "),e("p",[s._v("汇总参与该项目的各个开发者的代码。\n存放趋于稳定和可发布的代码。\n向 Master 分支提交 Merge Requests 可以触发测试环境构建（CI/CD）。\n源仓库是受保护的，开发者不可直接对其进行开发工作。\n开发者仓库\n任何开发者都没有权限对 Root 仓库进行直接的操作，源仓库建立以后，每个开发者需要做的事情就是把源仓库的 Fork 一份，作为自己日常开发的仓库。")]),s._v(" "),e("p",[s._v("每个开发者所 Fork 的仓库是完全独立的，互不干扰。\n每个开发者提交到代码到自己的仓库中，开发工作完成以后，开发者可以向源仓库发送 Pull Request ，本地仓库先合并源仓库，解决冲突。\n发起 Merge Request 请求管理员把自己的代码合并到源仓库中的 master 或 其他分支。\nGit 流程")]),s._v(" "),e("p",[s._v("前端项目会在 Root 仓库下创建 dev 分支，用于代码的拉取和合并，如果有多个不同的测试环境，按照测试环境创建分支。\n在本地的仓库中创建你的 dev 分支和其他功能性的分支。\n开发过程中不允许直接在 master 分支上开发，创建一个新的分支进行开发，git checkout –b {branch_name}。\n规范且详细的书写 commit ，推荐使用 git-cz 工具进行提交。\n完成开发后将相应的分支合并到自己仓库的 master 分支。\n将 master 分支 push 到自己的远程仓库（Fork 仓库）。\n向 Root 仓库 dev 分支提交 Merge Requests。\n提醒前端负责人审查代码、解决冲突或测试环境上线。\n解决冲突后 git pull upstream dev 拉取解决后的最新代码。")])])}),[],!1,null,null,null);n.default=t.exports}}]);