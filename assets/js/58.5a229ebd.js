(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{438:function(n,s,e){"use strict";e.r(s);var t=e(42),r=Object(t.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908152226806-1248602056.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908152226806-1248602056.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/10959199.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之一 Open vSwitch 诞生"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/10331606.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之二 安装指定版本 ovs"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/11527928.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之三 ovs-vsctl 命令使用"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/11720310.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之四 ovs-ofctl 命令使用"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/11946098.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之五 网桥特性功能配置"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/12748378.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之六 vlan 隔离"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13056429.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之七 meter 表限速"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之八 vxlan 隧道"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13866415.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之九 Group 表"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/14486056.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("Open vSwitch 系列之十 调用北向接口下发流表"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/14260941.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenvSwitch 系列之十一 ovs-dpdk"),e("OutboundLink")],1)]),n._v(" "),e("p",[e("code",[n._v("官方介绍")]),n._v("：\nVXLAN（Virtual eXtensible Local Area Network，虚拟扩展局域网），是由 IETF 定义的 NVO3（Network Virtualization over Layer 3）标准技术之一，是对传统 VLAN 协议的一种扩展。VXLAN 的特点是将 L2 的以太帧封装到 UDP 报文（即 L2 over L4）中，并在 L3 网络中传输。VXLAN 本质上是一种隧道技术，在源网络设备与目的网络设备之间的 IP 网络上，建立一条逻辑隧道，将用户侧报文经过特定的封装后通过这条隧道转发。")]),n._v(" "),e("p",[n._v("vxlan 是一种网络协议，将原始数据封装到 UDP 数据包中传输。vxlan 被广泛应用到云计算网络环境中，耳熟能详的云计算框架"),e("code",[n._v("openstack")]),n._v("主要的网络架构就是 vxlan，"),e("code",[n._v("kubernetes")]),n._v("也有 vxlan 的网络插件。vxlan 有许多优点，诸如：")]),n._v(" "),e("ol",[e("li",[n._v("连接两个局域网，可以将局域网内主机之间流量互通。就像是在局域网之间架起桥梁")]),n._v(" "),e("li",[n._v("支持隔离。vlan 最多支持 4096 个隔离，而 vxlan 支持 2 的次方数 32 即 4294967296 据隔离")])]),n._v(" "),e("p",[n._v("vxlan 的封装格式")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908145154467-2141116531.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908145154467-2141116531.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("本篇文章使用 ovs 搭建 vxlan 网桥，连接两个 mininet 构建的局域网。\n实验环境：两台虚拟机 ubuntu1804 桌面版 + ubuntu1604 桌面版 + mininet")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908134145788-345639850.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908134145788-345639850.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("1*")]),n._v("|*"),e("strong",[n._v("0*")]),n._v(" "),e("strong",[n._v("安装 mininet")])]),n._v(" "),e("p",[n._v("分别在两台机器上安装 mininet")]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("1*")]),n._v("|*"),e("strong",[n._v("1*")]),n._v(" "),e("strong",[n._v("安装 git 工具")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@ubuntu:~# apt install git\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nThe following additional packages will be installed:\n  git-man liberror-perl\nSuggested packages:\n  git-daemon-run | git-daemon-sysvinit git-doc git-el git-email git-gui gitk gitweb git-arch git-cvs git-mediawiki git-svn\nThe following NEW packages will be installed:\n  git git-man liberror-perl\n0 upgraded, 3 newly installed, 0 to remove and 406 not upgraded.\nNeed to get 3,932 kB of archives.\nAfter this operation, 25.6 MB of additional disk space will be used.\nDo you want to continue? [Y/n] y\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("1*")]),n._v("|*"),e("strong",[n._v("2*")]),n._v(" "),e("strong",[n._v("从 github 上拉取 mininet 源码")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~# git clone git://github.com/mininet/mininet\nCloning into 'mininet'...\nremote: Enumerating objects: 9752, done.\nremote: Total 9752 (delta 0), reused 0 (delta 0), pack-reused 9752\nReceiving objects: 100% (9752/9752), 3.03 MiB | 1.35 MiB/s, done.\nResolving deltas: 100% (6472/6472), done.\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("1*")]),n._v("|*"),e("strong",[n._v("3*")]),n._v(" "),e("strong",[n._v("安装 mininet")])]),n._v(" "),e("p",[n._v("mininet 的安装是进入"),e("code",[n._v("mininet/util")]),n._v("目录中，然后执行 "),e("code",[n._v("./install -a")]),n._v("。"),e("code",[n._v("-a")]),n._v("表示安装全部的组件。mininet 的安装可以有很多备选项。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~/mininet/util# ./install.sh -a\nDetected Linux distribution: Ubuntu 18.04 bionic amd64\nsys.version_info(major=3, minor=6, micro=7, releaselevel='final', serial=0)\nDetected Python (python3) version 3\nInstalling all packages except for -eix (doxypy, ivs, nox-classic)...\nInstall Mininet-compatible kernel if necessary\n.......\n.......\n.......\nlibtool: install: /usr/bin/install -c cbench /usr/local/bin/cbench\nmake[2]: Nothing to be done for 'install-data-am'.\nmake[2]: Leaving directory '/root/oflops/cbench'\nmake[1]: Leaving directory '/root/oflops/cbench'\nMaking install in doc\nmake[1]: Entering directory '/root/oflops/doc'\nmake[1]: Nothing to be done for 'install'.\nmake[1]: Leaving directory '/root/oflops/doc'\nEnjoy Mininet!\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("1*")]),n._v("|*"),e("strong",[n._v("4*")]),n._v(" "),e("strong",[n._v("验证安装")])]),n._v(" "),e("p",[n._v("安装完成之后，"),e("code",[n._v("ovs")]),n._v("会安装好，使用"),e("code",[n._v("ovs-vsctl show")]),n._v("命令，查看 ovs 版本")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('root@openlab:~/mininet/util# ovs-vsctl show\n58cc7b02-ef48-4de7-a96b-ee1c0259472d\n    ovs_version: "2.9.5"\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br")])]),e("p",[n._v("使用命令 "),e("code",[n._v("mn")]),n._v(" 创建一个最小拓扑的环境。包括一个控制器，一个交换机，两个主机。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908140454722-2008653959.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908140454722-2008653959.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~/mininet/util# mn\n*** Creating network\n*** Adding controller\n*** Adding hosts:\nh1 h2 \n*** Adding switches:\ns1 \n*** Adding links:\n(h1, s1) (h2, s1) \n*** Configuring hosts\nh1 h2 \n*** Starting controller\nc0 \n*** Starting 1 switches\ns1 ...\n*** Starting CLI:\nmininet> \n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("0*")]),n._v(" "),e("strong",[n._v("配置 vxlan")])]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("1*")]),n._v(" "),e("strong",[n._v("第一台机器配置")])]),n._v(" "),e("p",[n._v("记录下第一台机器的 ip 地址和路由信息，后面会使用这些信息。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~/mininet/util# ifconfig\nens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.175.130  netmask 255.255.255.0  broadcast 192.168.175.255\n        inet6 fe80::20c:29ff:fe45:a8b7  prefixlen 64  scopeid 0x20<link>\n        ether 00:0c:29:45:a8:b7  txqueuelen 1000  (Ethernet)\n        RX packets 247144  bytes 344597431 (344.5 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 74937  bytes 6024181 (6.0 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 993  bytes 76788 (76.7 KB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 993  bytes 76788 (76.7 KB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~/mininet/util# route -n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         192.168.175.2   0.0.0.0         UG    100    0        0 ens33\n192.168.175.0   0.0.0.0         255.255.255.0   U     0      0        0 ens33\n192.168.175.2   0.0.0.0         255.255.255.255 UH    100    0        0 ens33\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("2*")]),n._v(" "),e("strong",[n._v("第二台机器配置")])]),n._v(" "),e("p",[n._v("同样，记录第二台机器的 ip 地址和路由信息。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ens33     Link encap:Ethernet  HWaddr 00:0c:29:a6:71:34  \n          inet addr:192.168.175.128  Bcast:192.168.175.255  Mask:255.255.255.0\n          inet6 addr: fe80::b933:b350:fe27:b89a/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:56351 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:14943 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:76128903 (76.1 MB)  TX bytes:1464272 (1.4 MB)\n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:404 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:404 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:33728 (33.7 KB)  TX bytes:33728 (33.7 KB)\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@ubuntu:~/mininet/util# route -n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         192.168.175.2   0.0.0.0         UG    100    0        0 ens33\n169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 ens33\n192.168.175.0   0.0.0.0         255.255.255.0   U     100    0        0 ens33\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("3*")]),n._v(" "),e("strong",[n._v("创建隧道网桥 br-tun")])]),n._v(" "),e("p",[n._v("使用 ovs 创建一个网桥，叫做 br-tun，该网桥后面会作为 vxlan 隧道的端点。两个虚拟机都需要创建。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('root@openlab:~/mininet/util# ovs-vsctl add-br br-tun\nroot@openlab:~/mininet/util# \nroot@openlab:~/mininet/util# ovs-vsctl show\n58cc7b02-ef48-4de7-a96b-ee1c0259472d\n    Bridge br-tun\n        Port br-tun\n            Interface br-tun\n                type: internal\n    ovs_version: "2.9.5"\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br")])]),e("p",[n._v("创建好 br-tun 之后，可以用"),e("code",[n._v("ifconfig -a")]),n._v("查看到这个设备")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@openlab:~/mininet/util# ifconfig -a\nbr-tun: flags=4098<BROADCAST,MULTICAST>  mtu 1500\n        ether 26:c9:1f:49:4e:4e  txqueuelen 1000  (Ethernet)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.175.130  netmask 255.255.255.0  broadcast 192.168.175.255\n        inet6 fe80::20c:29ff:fe45:a8b7  prefixlen 64  scopeid 0x20<link>\n        ether 00:0c:29:45:a8:b7  txqueuelen 1000  (Ethernet)\n        RX packets 247744  bytes 344644771 (344.6 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 75331  bytes 6070686 (6.0 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 993  bytes 76788 (76.7 KB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 993  bytes 76788 (76.7 KB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\novs-system: flags=4098<BROADCAST,MULTICAST>  mtu 1500\n        ether 62:da:79:d8:d4:d3  txqueuelen 1000  (Ethernet)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 0  bytes 0 (0.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908100611860-235848771.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908100611860-235848771.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("第二台机器创建好的设备。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("root@ubuntu:~/mininet/util# ifconfig -a\nbr-tun    Link encap:Ethernet  HWaddr 1e:66:43:f2:04:43  \n          BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n\nens33     Link encap:Ethernet  HWaddr 00:0c:29:a6:71:34  \n          inet addr:192.168.175.128  Bcast:192.168.175.255  Mask:255.255.255.0\n          inet6 addr: fe80::b933:b350:fe27:b89a/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:56569 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:15061 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:76151455 (76.1 MB)  TX bytes:1479464 (1.4 MB)\n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:404 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:404 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:33728 (33.7 KB)  TX bytes:33728 (33.7 KB)\n\novs-system Link encap:Ethernet  HWaddr 8e:fb:8e:a0:0c:e5  \n          BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908100702885-1283542953.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908100702885-1283542953.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("4*")]),n._v(" "),e("strong",[n._v("转移 ens33 网卡的 ip 地址到 br-tun 上")])]),n._v(" "),e("p",[n._v("将网卡上的 ip 地址转交给 br-tun。从上一步可以看出 br-tun 和网卡其实是非常类似的，将其赋值 ip 地址就可以当做网卡使用。现在要做的是把虚拟机网卡的 ip 地址给 br-tun。\n增加路由信息。将 ip 地址转交给 br-tun 之后，路由信息也需要更新。ip 地址和路由信息都要以实际的信息，在复制实验时不可直接使用我的。这也是为什么在前面记录 ip 信息和路由信息的原因。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ifconfig ens33 0 up\nifconfig br-tun 192.168.175.130/24 up\nroute add default gw 192.168.175.2\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908101716956-1953479535.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908101716956-1953479535.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("同样在第二台机器上完成同样的操作。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ifconfig ens33 0 up\nifconfig br-tun 192.168.175.128/24 up\nroute add default gw 192.168.175.2\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908102224548-723253434.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908102224548-723253434.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("5*")]),n._v(" "),e("strong",[n._v("将网卡 ens33 作为端口添加到 br-tun")])]),n._v(" "),e("p",[n._v("因为 ens33 是流量出虚拟机的接口，所以最后流量还是肯定走 ens33 网卡出去。br-tun 只是一个虚拟机的设备，要将 ens33 作为端口加入 br-tun 中")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ovs-vsctl add-port br-tun ens33\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104827381-1960912188.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104827381-1960912188.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("同样在第二台机器上完成同样的操作。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ovs-vsctl add-port br-tun ens33\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104827381-1960912188.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104827381-1960912188.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("6*")]),n._v(" "),e("strong",[n._v("启动 mininet")])]),n._v(" "),e("p",[n._v("使用命令"),e("code",[n._v("mn")]),n._v("启动一个最小拓扑的实验。创建的设备包括两个主机，h1，h2；一个交换机 s1")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104920936-2098492788.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908104920936-2098492788.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("使用"),e("code",[n._v("ovs-vsctl show")]),n._v(" 可以看到环境中新增了一个交换机 s1")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105025358-1450642303.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105025358-1450642303.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("同样在第二台机器上完成同样的操作。")]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("7*")]),n._v(" "),e("strong",[n._v("修改主机 IP 地址")])]),n._v(" "),e("p",[n._v("上一步创建的 mininet 中两个主机的默认地址都是"),e("code",[n._v("10.0.0.1")]),n._v("和"),e("code",[n._v("10.0.0.2")]),n._v(", 需要将第一台虚拟机中的 mininet 的主机的地址修改"),e("code",[n._v("10.0.0.3")]),n._v("和"),e("code",[n._v("10.0.0.4")]),n._v("。构建的环境如下:")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908143126048-1581543749.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908143126048-1581543749.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110132185-477294079.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110132185-477294079.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("8*")]),n._v(" "),e("strong",[n._v("创建 vxlan 隧道")])]),n._v(" "),e("p",[n._v("在交换机 s1 创建 vxlan 隧道。这一步是最关键的一步。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ovs-vsctl add-port s1 vx1 -- set interface vx1 type=vxlan options:remote_ip=192.168.175.128\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("其中"),e("code",[n._v("s1")]),n._v("是创建隧道的网桥，"),e("code",[n._v("remote_ip")]),n._v("就是隧道另外一端机器的 ip 地址。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105855505-2137336127.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105855505-2137336127.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("查看创建好的隧道\n"),e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105932183-289731795.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908105932183-289731795.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("在第二台虚拟机上做同样的操作")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("ovs-vsctl add-port s1 vx1 -- set interface vx1 type=vxlan options:remote_ip=192.168.175.130\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111322181-1680379194.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111322181-1680379194.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("查看创建好的隧道\n"),e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111405864-510232338.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111405864-510232338.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("9*")]),n._v(" "),e("strong",[n._v("验证通信")])]),n._v(" "),e("p",[n._v("在第一台虚拟机上打开 h2。使用命令"),e("code",[n._v("xterm h2")]),n._v("可以打开 mininet 中 h2 的操作终端。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111541127-2000679420.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111541127-2000679420.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("在终端中"),e("code",[n._v("ping 10.0.0.1")])]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110006227-1878787071.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110006227-1878787071.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908144206833-490038416.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908144206833-490038416.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("在终端中"),e("code",[n._v("ping 10.0.0.2")])]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111704036-548029964.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908111704036-548029964.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("2*")]),n._v("|*"),e("strong",[n._v("10*")]),n._v(" "),e("strong",[n._v("抓取 vxlan 数据包")])]),n._v(" "),e("p",[n._v("打开"),e("code",[n._v("wireshark")]),n._v("，监听"),e("code",[n._v("br-tun")]),n._v("隧道端点上的流量。可以看到目前流量就是"),e("code",[n._v("ICMP")]),n._v("。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110301705-581325438.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110301705-581325438.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("打开具体的 icmp 查看，与普通 icmp 有什么不同之处。正常 icmp 流量是"),e("code",[n._v("icmp+网络层+数据链路层")]),n._v("，而使用 vxlan 的 icmp 则是 "),e("code",[n._v("icmp + 网络层 + 数据链路层 + vxlan报文头 + udp + 网络层 + 数据链路层")]),n._v("。内层是 10.0.0.3 ping 10.0.0.1 的流量，这些流量被 vxlan 封装之后有外层包 192.168.175.130 到 192.168.175.128 的 UDP 数据包。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110358148-1680874567.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110358148-1680874567.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("最后看一下 vxlan 报文头的具体信息。里面包含了一个 "),e("code",[n._v("vxlan network identity")]),n._v(" 即 vni，就是类似与 vlan tag 的 ID 号。不同的 ID 号之间不可以通信。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110442750-1368948111.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908110442750-1368948111.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("*"),e("strong",[n._v("3*")]),n._v("|*"),e("strong",[n._v("0*")]),n._v(" "),e("strong",[n._v("总结")])]),n._v(" "),e("p",[n._v("在两个交换机上配置了 vxlan 之后，就像是在 s1 和 s1 之间打通了隧道，跨越局域网的限制传输数据。逻辑上是如上，实际是流量是从 "),e("code",[n._v("h1 --\x3es1--\x3ebr-tun --\x3eens33 --\x3eens33 --\x3ebr-tun --\x3es1 --\x3eh1")]),n._v("。")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908150821852-717308103.png",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1060878/202009/1060878-20200908150821852-717308103.png",alt:"img"}}),e("OutboundLink")],1)]),n._v(" "),e("p",[e("strong",[n._v("EOF")])]),n._v(" "),e("p",[e("img",{attrs:{src:"https://images.cnblogs.com/cnblogs_com/goldsunshine/1160827/o_20171109192330.png.jpg",alt:"img"}})]),n._v(" "),e("p",[n._v("本文作者："),e("strong",[e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("goldsunshine"),e("OutboundLink")],1)]),n._v("\n本文链接：https://www.cnblogs.com/goldsunshine/p/13630767.html\n关于博主：评论和私信会在第一时间回复。或者"),e("a",{attrs:{href:"https://msg.cnblogs.com/msg/send/goldsunshine",target:"_blank",rel:"noopener noreferrer"}},[n._v("直接私信"),e("OutboundLink")],1),n._v("我。\n版权声明：本博客所有文章除特别声明外，均采用 "),e("a",{attrs:{href:"https://creativecommons.org/licenses/by-nc-nd/4.0/",target:"_blank",rel:"noopener noreferrer"}},[n._v("BY-NC-SA"),e("OutboundLink")],1),n._v(" 许可协议。转载请注明出处！\n声援博主：如果您觉得文章对您有帮助，可以点击文章右下角**【[推荐](javascript:void(0)😉】**一下。您的鼓励是博主的最大动力！")]),n._v(" "),e("p",[n._v("全文完")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-0",target:"_blank",rel:"noopener noreferrer"}},[n._v("1|0 安装 mininet"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-1",target:"_blank",rel:"noopener noreferrer"}},[n._v("1|1 安装 git 工具"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-2",target:"_blank",rel:"noopener noreferrer"}},[n._v("1|2 从 github 上拉取 mininet 源码"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-3",target:"_blank",rel:"noopener noreferrer"}},[n._v("1|3 安装 mininet"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-4",target:"_blank",rel:"noopener noreferrer"}},[n._v("1|4 验证安装"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-5",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|0 配置 vxlan"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-6",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|1 第一台机器配置"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-7",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|2 第二台机器配置"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-8",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|3 创建隧道网桥 br-tun"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-9",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|4 转移 ens33 网卡的 ip 地址到 br-tun 上"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-10",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|5 将网卡 ens33 作为端口添加到 br-tun"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-11",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|6 启动 mininet"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-12",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|7 修改主机 IP 地址"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-13",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|8 创建 vxlan 隧道"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-14",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|9 验证通信"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-15",target:"_blank",rel:"noopener noreferrer"}},[n._v("2|10 抓取 vxlan 数据包"),e("OutboundLink")],1),e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html#sr-toc-16",target:"_blank",rel:"noopener noreferrer"}},[n._v("3|0 总结"),e("OutboundLink")],1)]),n._v(" "),e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/goldsunshine/p/13630767.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("ori"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);